常用lua库：
lzmq,luafilesystem,lua-llthreads,cjson等等


安装homebrew
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

安装lua

Last login: Fri Sep  9 16:47:36 on ttys001
172-15-2-13:~ mac$ cd /Users/mac/Leo/howtousetestmanager/TigerSkyExample/IATestManager/Foreign/Lua/lua-5.1.4 
172-15-2-13:lua-5.1.4 mac$ make macosx
cd src && /Applications/Xcode.app/Contents/Developer/usr/bin/make macosx
/Applications/Xcode.app/Contents/Developer/usr/bin/make all MYCFLAGS=-DLUA_USE_LINUX MYLIBS="-lreadline"
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lapi.o lapi.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lcode.o lcode.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o ldebug.o ldebug.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o ldo.o ldo.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o ldump.o ldump.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lfunc.o lfunc.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lgc.o lgc.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o llex.o llex.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lmem.o lmem.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lobject.o lobject.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lopcodes.o lopcodes.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lparser.o lparser.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lstate.o lstate.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lstring.o lstring.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o ltable.o ltable.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o ltm.o ltm.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lundump.o lundump.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lvm.o lvm.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lzio.o lzio.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lauxlib.o lauxlib.c
lauxlib.c:577:61: warning: while loop has empty body [-Wempty-body]
   while ((c = getc(lf.f)) != EOF && c != LUA_SIGNATURE[0]) ;
                                                            ^
lauxlib.c:577:61: note: put the semicolon on a separate line to silence this
      warning
1 warning generated.
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lbaselib.o lbaselib.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o ldblib.o ldblib.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o liolib.o liolib.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lmathlib.o lmathlib.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o loslib.o loslib.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o ltablib.o ltablib.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lstrlib.o lstrlib.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o loadlib.o loadlib.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o linit.o linit.c
ar rcu liblua.a lapi.o lcode.o ldebug.o ldo.o ldump.o lfunc.o lgc.o llex.o lmem.o lobject.o lopcodes.o lparser.o lstate.o lstring.o ltable.o ltm.o lundump.o lvm.o lzio.o lauxlib.o lbaselib.o ldblib.o liolib.o lmathlib.o loslib.o ltablib.o lstrlib.o loadlib.o linit.o
ranlib liblua.a
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o lua.o lua.c
gcc -o lua  lua.o liblua.a -lm -lreadline
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o luac.o luac.c
gcc -O2 -Wall -DLUA_USE_LINUX   -c -o print.o print.c
gcc -o luac  luac.o print.o liblua.a -lm -lreadline

172-15-2-13:lua-5.1.4 mac$ sudo make install
Password:
cd src && mkdir -p /usr/local/bin /usr/local/include /usr/local/lib /usr/local/man/man1 /usr/local/share/lua/5.1 /usr/local/lib/lua/5.1
cd src && install -p -m 0755 lua luac /usr/local/bin
cd src && install -p -m 0644 lua.h luaconf.h lualib.h lauxlib.h ../etc/lua.hpp /usr/local/include
cd src && install -p -m 0644 liblua.a /usr/local/lib
cd doc && install -p -m 0644 lua.1 luac.1 /usr/local/man/man1
172-15-2-13:lua-5.1.4 mac$ brew install luarocks -v
Error: No available formula with the name "luarocks" 
==> Searching for similarly named formulae...
Error: No similarly named formulae found.
==> Searching taps...
Error: No formulae found in taps.
==> You haven't updated Homebrew in a while.
A formula for luarocks might have been added recently.
Run `brew update` to get the latest Homebrew updates!
172-15-2-13:lua-5.1.4 mac$ brew update
Updated Homebrew from bc5b9c1 to b5a6b4e.
Updated 3 taps (homebrew/core, homebrew/python, homebrew/science).
==> New Formulae
alot                                     homebrew/science/rapsearch2            
apache-zeppelin                          homebrew/science/sdsl-lite             
direvent                                 homebrew/science/sequel                
dscanner                                 homebrew/science/spaced                
feedgnuplot                              homebrew/science/superlu_mt            
folly                                    homebrew/science/swarm                 
fsevents-tools                           hopenpgp-tools                         
git-remote-hg                            jxrlib                                 
gitversion                               lean-cli                               
grafana                                  lego                                   
gron                                     libbdplus                              
hg-fast-export                           libdivecomputer                        
homebrew/python/aeneas                   libngspice                             
homebrew/python/h5py                     libuninameslist                        
homebrew/science/afra                    liquigraph                             
homebrew/science/breseq                  m-cli                                  
homebrew/science/cfitsio                 minio-mc                               
homebrew/science/dlib                    nats-streaming-server                  
homebrew/science/fplll                   openssl@1.1                            
homebrew/science/freebayes               pdftoedn                               
homebrew/science/iqtree                  presto                                 
homebrew/science/itensor                 pybind11                               
homebrew/science/jsbsim                  rancher-cli                            
homebrew/science/kmacs                   rclone                                 
homebrew/science/libbuddy                sslsplit                               
homebrew/science/lsd                     timewarrior                            
homebrew/science/macse                   vaulted                                
homebrew/science/ococo                   wego                                   
homebrew/science/orthofinder             xcenv                                  
homebrew/science/parallel-netcdf         zstd                                   
==> Updated Formulae
abi-compliance-checker
acmetool
activemq
afflib
afl-fuzz
allegro
amap
amazon-ecs-cli
ammonite-repl
android-ndk
ansible
ansible-cmdb
antigen
antlr
apache-flink
apktool
app-engine-go-32
app-engine-java
app-engine-python
apr
apr-util
arangodb
argon2
aria2
artifactory
asciidoc
asciinema2gif
assh
autoenv
awf
aws-elasticbeanstalk
aws-sdk-cpp
aws-shell
awscli
azure-cli
b2-tools
basex
bash-preexec
bazel
bdw-gc
bfg
binutils
bitrise
blackbox
bmon
boost
boost-bcp
boost-python
botan
brew-gem
brotli
caddy
caf
cake
calabash
cask
ccache
ccextractor
cconv
cereal
cgal
cgrep
charm
cheat
checkstyle
chisel
chromedriver
citus
clang-format
cli53
clipper
cmake
codequery
cogl
conan
concurrencykit
convox
corectl
coturn
cowsay
cppcheck
crystal-lang
csfml
cucumber-cpp
curl ✔
darcs
darkice
datomic
davix
deheader
deis
deisctl
deja-gnu
dependency-check
depqbf
dieharder
diff-pdf
diff-so-fancy
ditaa
dnscrypt-proxy
dnscrypt-wrapper
docker
docker-cloud
docker-compose
docker-machine
docker-machine-driver-xhyve
doctl
dovecot
doxygen
dpkg
dtach
dub
duplicity
dxpy
ejabberd
elasticsearch
embulk
emp
enca
epic5
etcd
exercism
exploitdb
fabio
fdk-aac-encoder
ffmpeg
ffmpegthumbnailer
fftw
fibjs
flake8
flatbuffers
flatcc
fleetctl
flow
flowgrind
fluent-bit
flvmeta
fontconfig
freeipmi
freeling
fswatch
fwup
fzf
gammaray
gammu
gawk
gcc
gcovr
gdal
gdm
geckodriver
geoserver
git
git-annex
git-cola
git-credential-manager
git-fixup
git-flow-avh
git-fresh
git-lfs
git-octopus
git-secret
git-town
git-when-merged
gitbucket
giter8
gitg
gitlab-ci-multi-runner
gjstest
glib
glide
gnatsd
gnu-apl
gnu-complexity
gnupg
gnupg2
gnuradio
go
godep
gollum
googler
gor
gosu
govendor
gpm
gputils
gradle
graphicsmagick
grib-api
gringo
groonga
gsl
gssh
gst-editing-services
gst-libav
gst-plugins-bad
gst-plugins-base
gst-plugins-good
gst-plugins-ugly
gst-python
gst-validate
gstreamer
gtk+3
gtk-gnutella
gtk-vnc
gtkextra
gtkmm
gx
gx-go
h2o
hadolint
hbase
heroku
highlight
hive
homebrew/python/mpi4py
homebrew/python/pillow
homebrew/python/pymummer
homebrew/python/scapy
homebrew/python/scipy
homebrew/science/abinit
homebrew/science/abyss
homebrew/science/alembic
homebrew/science/alpscore
homebrew/science/amos
homebrew/science/analysis
homebrew/science/andi
homebrew/science/apophenia
homebrew/science/armadillo
homebrew/science/arpack
homebrew/science/art
homebrew/science/astrometry-net
homebrew/science/atomic-pseudopotential-engine
homebrew/science/atompaw
homebrew/science/augustus
homebrew/science/bali-phy
homebrew/science/bedops
homebrew/science/bedtools
homebrew/science/beetl
homebrew/science/bioformats-cpp
homebrew/science/blaze-lib
homebrew/science/bless
homebrew/science/boost-compute
homebrew/science/busco
homebrew/science/calculix-ccx
homebrew/science/ceres-solver
homebrew/science/cgns
homebrew/science/circlator
homebrew/science/ckon
homebrew/science/clark
homebrew/science/clfft
homebrew/science/clinfo
homebrew/science/cmdstan
homebrew/science/cufflinks
homebrew/science/dealii
homebrew/science/delly
homebrew/science/dgtal
homebrew/science/diamond
homebrew/science/dida
homebrew/science/dssp
homebrew/science/ea-utils
homebrew/science/edirect
homebrew/science/enblend-enfuse
homebrew/science/etsf_io
homebrew/science/exabayes
homebrew/science/express
homebrew/science/fastqc
homebrew/science/fgsl
homebrew/science/field3d
homebrew/science/flann
homebrew/science/fwdpp
homebrew/science/galsim
homebrew/science/gap
homebrew/science/garli
homebrew/science/gdcm
homebrew/science/getdp
homebrew/science/gmsh
homebrew/science/gmt
homebrew/science/gnudatalanguage
homebrew/science/graph-tool
homebrew/science/gromacs
homebrew/science/gtsam
homebrew/science/gubbins
homebrew/science/hopdm
homebrew/science/hwloc
homebrew/science/hypre
homebrew/science/igv
homebrew/science/igvtools
homebrew/science/kallisto
homebrew/science/kat
homebrew/science/lammps
homebrew/science/last
homebrew/science/libsequence
homebrew/science/lighter
homebrew/science/lis
homebrew/science/lobstr
homebrew/science/madlib
homebrew/science/mash
homebrew/science/mathgl
homebrew/science/maude
homebrew/science/meme
homebrew/science/methpipe
homebrew/science/minia
homebrew/science/mlpack
homebrew/science/mtl
homebrew/science/mumps
homebrew/science/nco
homebrew/science/nest
homebrew/science/nextflow
homebrew/science/nexusformat
homebrew/science/nip2
homebrew/science/nixio
homebrew/science/nlopt
homebrew/science/nxtrim
homebrew/science/oce
homebrew/science/octave
homebrew/science/opencascade
homebrew/science/openimageio
homebrew/science/p4est
homebrew/science/paraview
homebrew/science/parmetis
homebrew/science/pastix
homebrew/science/pcl
homebrew/science/petsc
homebrew/science/picard-tools
homebrew/science/plasma
homebrew/science/poretools
homebrew/science/primer3
homebrew/science/proteinortho
homebrew/science/pspp
homebrew/science/pulseview
homebrew/science/pykep
homebrew/science/r8s
homebrew/science/raxml
homebrew/science/ray
homebrew/science/root
homebrew/science/root6
homebrew/science/rstudio-server
homebrew/science/sailfish
homebrew/science/salmon
homebrew/science/scalapack
homebrew/science/scotch
homebrew/science/scotch5
homebrew/science/shark
homebrew/science/slepc
homebrew/science/snid
homebrew/science/sratoolkit
homebrew/science/statismo
homebrew/science/stringtie
homebrew/science/sundials
homebrew/science/superlu
homebrew/science/superlu_dist
homebrew/science/tbl2asn
homebrew/science/tisean
homebrew/science/tophat
homebrew/science/trilinos
homebrew/science/trimmomatic
homebrew/science/vips
homebrew/science/vislcg3
homebrew/science/visp
homebrew/science/vsearch
homebrew/science/vtk
homebrew/science/wcslib
homebrew/science/xmi-msim
homebrew/science/xrmc
homebrew/science/xylib
homebrew/science/zoltan
httpie
hub
hydra
hyper
hyperscan
idris
imagemagick
infer
influxdb
innotop
inspircd
iso-codes
ispc
jboss-forge
jenkins
jfrog-cli-go
jlog
joe
jpegoptim
jq
jruby
jsdoc3
jsoncpp
jsonschema2pojo
kafka
keybase
khal
khard
kitchen-sync
knot
kobalt
konoha
kore
kubernetes-cli
kyua
latexml
launch4j
le
ledger
leiningen
lensfun
leveldb
lftp
libatomic_ops
libbson
libflowmanager
libfreenect
libftdi
libgcrypt
libgetdata
libgit2-glib
libgraphqlparser
libgsf
libiscsi
libjson-rpc-cpp
libksba
libmicrohttpd
libmill
libmtp
libphonenumber
libpng ✔
libpointing
libprotoident
libressl
libscrypt
libsodium
libswiften
libtess2
libvirt
libvpx
lmdb
lnav
logstash
logtalk
luajit
macvim
mailhog
mariadb
mawk
mbelib
mdp
media-info
mediaconch
mercurial
meson
mesos
metabase
metaproxy
mg
mg3a
micropython
miller
minio
minisign
mkvtoolnix
mobile-shell
mongo-c
mongodb
monkeysphere
mono
moreutils
mosquitto
mozjpeg
mpc
mpd
mpich
mpv
mtools
mtr
multimarkdown
multirust
mutt
mycli
mypy
mysql
mysql-sandbox
mysqltuner
mytop
nanopb-generator
nasm
natalie
ncdu
ncmpc
ncmpcpp
neo4j
nfdump
nghttp2
nifi
node
node-build
nomad
noti
nsd
nspr
nss
nvm
nzbget
offlineimap
oniguruma
open-mpi
opencc
openjpeg
openshift-cli
openslide
openvdb
openvpn
ophcrack
orc
oscats
osh
osm2pgsql
osquery
owfs
paket
pandoc-crossref
pango
pangomm
parallel
pass
passpie
pcap_dnsproxy
pdf2htmlex
pdns
pdnsrec
peco
peg
percona-server
percona-toolkit
percona-xtrabackup
pgbadger
pgcli
pgroonga
pgrouting
pgtap
pidcat
pillar
pius
planck
platformio
plowshare
pmd
pngcrush
poco
ponyc
poppler
postgis
postgresql
pre-commit
primesieve
prometheus
psgrep
psqlodbc
purescript
pushpin
pwntools
pyenv
pygobject
pypy
qbs
qemu
qscintilla2
rabbitmq
radare2
rainbarf
rancher-compose
rapidjson
rbenv-binstubs
re2
reattach-to-user-namespace
rebar
redis
remarshal
repo
reposurgeon
rethinkdb
rfcmarkup
rgxg
rhino
riemann
rocksdb
roswell
rtv
rust
s-search
saltstack
sane-backends
sbcl
scriptcs
ser2net
sfcgal
sfml
shadowsocks-libev
shairport-sync
shared-mime-info
shc
siege
sile
sjk
smali
smartmontools
smlnj
sngrep
sonar
sonar-runner
source-highlight
spring-loaded
sqlite
sqlite-analyzer
sqlmap
ssh-copy-id
sshguard
sshuttle
subliminal
supervisor
svtplay-dl
swiftgen
swiftlint
syncthing
tailor
tbb
tcpkali
telegraf
terraform
tgui
the_platinum_searcher
thefuck
tig
tile38
tippecanoe
tmux-mem-cpu-load
todolist
tomcat
tor
trafficserver
transcrypt
translate-toolkit
uchardet
uhd
unrar
upscaledb
urweb
vapoursynth
vault
vdirsyncer
vegeta
vim
vmtouch
vnstat
voldemort
vowpal-wabbit
vultr
wakatime-cli
wartremover
weboob
whatmp3
wolfssl
wrangler
x265
xmake
xonsh
yadm
yara
yle-dl
you-get
youtube-dl
zero-install
zimg
zpaq
zplug
zsh-completions
zurl
==> Renamed Formulae
geode -> apache-geode                    racket -> minimal-racket               
==> Deleted Formulae
apt-cacher-ng                            idcomments                             
avidemux                                 kdiff3                                 
box2d                                    kjell                                  
cfitsio                                  lastfmlib                              
class-dump                               libdbusmenu-qt                         
curaengine                               openlitespeed                          
dircproxy                                orpie                                  
disco                                    quassel                                
fugu                                     rfcdiff                                
geany                                    samba                                  
gimp                                     slony                                  
git-stree                                sqlitebrowser                          
homebrew/science/suite-sparse421         txt2man                                
icmake                                   ucspi-tools                            
172-15-2-13:lua-5.1.4 mac$ brew install zmq
Warning: zeromq-4.1.5 already installed, it's just not linked
172-15-2-13:lua-5.1.4 mac$ brew link zmq
Linking /usr/local/Cellar/zeromq/4.1.5... 
Error: Could not symlink lib/libzmq.a
Target /usr/local/lib/libzmq.a
already exists. You may want to remove it:
  rm '/usr/local/lib/libzmq.a'

To force the link and overwrite all conflicting files:
  brew link --overwrite zeromq

To list all files that would be deleted:
  brew link --overwrite --dry-run zeromq
172-15-2-13:lua-5.1.4 mac$ brew link --overwrite zeromq
Linking /usr/local/Cellar/zeromq/4.1.5... 7 symlinks created


安装luarocks！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！
172-15-2-13:~ mac$ cd Downloads/
172-15-2-13:Downloads mac$ tar -xf luarocks-2.3.0.tar 
172-15-2-13:Downloads mac$ cd luarocks-2.3
-bash: cd: luarocks-2.3: No such file or directory
172-15-2-13:Downloads mac$ cd luarocks-2.3.0
172-15-2-13:luarocks-2.3.0 mac$ ls
COPYING         Makefile.setup.inc  rockspec
Makefile        README.md       src
Makefile.install.inc    config.ld       test
Makefile.luarocks   configure
172-15-2-13:luarocks-2.3.0 mac$ ./configure 
Lua interpreter found: /usr/local/bin/lua...
Lua version detected: 5.1
lua found in $PATH: /usr/local/bin
Checking Lua includes... 
lua.h found in /usr/local/include/lua.h
curl found at /usr/bin
openssl found at /usr/bin
Configuring for system... 
Darwin
Configuring for architecture... 
x86_64
Existing installation detected.
Using previously configured rocks dir: /usr/local/lib/luarocks/rocks
Writing configuration...

Installation prefix: /usr/local
LuaRocks configuration directory: /usr/local/etc/luarocks
Using Lua from: /usr/local

Done configuring.
- Type 'make build' and 'make install':
  to install to /usr/local as usual.
- Type 'make bootstrap':
  to install LuaRocks in /usr/local as a rock.

172-15-2-13:luarocks-2.3.0 mac$ make build
rm -f src/luarocks/site_config.lua
echo 'local site_config = {}' >> src/luarocks/site_config.lua
if [ -n "/usr/local" ] ;\
    then \
       echo "site_config.LUAROCKS_PREFIX=[[/usr/local]]" >> src/luarocks/site_config.lua ;\
    fi
if [ -n "/usr/local/include" ] ;\
    then \
       echo "site_config.LUA_INCDIR=[[/usr/local/include]]" >> src/luarocks/site_config.lua ;\
    fi
if [ -n "/usr/local/lib" ] ;\
    then \
       echo "site_config.LUA_LIBDIR=[[/usr/local/lib]]" >> src/luarocks/site_config.lua ;\
    fi
if [ -n "/usr/local/bin" ] ;\
    then \
       echo "site_config.LUA_BINDIR=[[/usr/local/bin]]" >> src/luarocks/site_config.lua ;\
    fi
if [ -n "" ] ;\
    then \
       echo "site_config.LUA_INTERPRETER=[[lua]]" >> src/luarocks/site_config.lua ;\
    fi
if [ -n "/usr/local/etc/luarocks" ] ;\
    then \
       echo "site_config.LUAROCKS_SYSCONFDIR=[[/usr/local/etc/luarocks]]" >> src/luarocks/site_config.lua ;\
    fi
if [ -n "/usr/local" ] ;\
    then \
       echo "site_config.LUAROCKS_ROCKS_TREE=[[/usr/local]]" >> src/luarocks/site_config.lua ;\
    fi
if [ -n "" ] ;\
    then \
       echo "site_config.LUAROCKS_FORCE_CONFIG=true" >> src/luarocks/site_config.lua ;\
    fi
if [ -n "/lib/luarocks/rocks" ] ;\
    then \
       echo "site_config.LUAROCKS_ROCKS_SUBDIR=[[/lib/luarocks/rocks]]" >> src/luarocks/site_config.lua ;\
    fi
if [ "" = "yes" ] ;\
    then \
       echo "site_config.LUA_DIR_SET=true" >> src/luarocks/site_config.lua ;\
    fi
echo "site_config.LUAROCKS_UNAME_S=[[Darwin]]" >> src/luarocks/site_config.lua
echo "site_config.LUAROCKS_UNAME_M=[[x86_64]]" >> src/luarocks/site_config.lua
echo "site_config.LUAROCKS_DOWNLOADER=[[curl]]" >> src/luarocks/site_config.lua
echo "site_config.LUAROCKS_MD5CHECKER=[[openssl]]" >> src/luarocks/site_config.lua
if [ -n "" ] ;\
    then \
       echo 'site_config.LUAROCKS_EXTERNAL_DEPS_SUBDIRS={ bin="bin", lib={ "lib", [[]] }, include="include" }' >> src/luarocks/site_config.lua ;\
       echo 'site_config.LUAROCKS_RUNTIME_EXTERNAL_DEPS_SUBDIRS={ bin="bin", lib={ "lib", [[]] }, include="include" }' >> src/luarocks/site_config.lua ;\
    fi
echo "return site_config" >> src/luarocks/site_config.lua
for f in luarocks luarocks-admin ;\
    do \
       mv src/bin/$f src/bin/$f.bak ;\
       sed "s,^#!.*lua.*,#!/usr/bin/env lua,;/^package.path/d" < src/bin/$f.bak > src/bin/$f ;\
       chmod +x src/bin/$f ;\
       rm -f src/bin/$f.bak ;\
    done
for f in luarocks luarocks-admin ;\
    do \
       sed "1d" src/bin/$f > src/bin/$f.bak ;\
       echo "#!/usr/local/bin/lua" > src/bin/$f ;\
       echo "package.path = [[/usr/local/share/lua/5.1//?.lua;]]..package.path" | sed "s,//,/,g" >> src/bin/$f ;\
       cat src/bin/$f.bak >> src/bin/$f ;\
       chmod +x src/bin/$f ;\
       rm -f src/bin/$f.bak ;\
    done

Done. Type 'make install' to install into /usr/local.

172-15-2-13:luarocks-2.3.0 mac$ make install
mkdir -p "/usr/local/bin"
cd src/bin && \
    luaver="5.1" && [ -n "$luaver" ] || luaver=` -e 'print(_VERSION:sub(5))'`; \
    for f in luarocks luarocks-admin; \
    do \
       cp "$f" "/usr/local/bin/$f-$luaver"; \
       ln -nfs "$f-$luaver" "/usr/local/bin/$f"; \
    done
cp: /usr/local/bin/luarocks-5.1: Permission denied
cp: /usr/local/bin/luarocks-admin-5.1: Permission denied
mkdir -p "/usr/local/share/lua/5.1//luarocks"
cd src/luarocks && for f in fs/unix/tools.lua fs/unix.lua fs/win32/tools.lua fs/win32.lua fs/lua.lua persist.lua list.lua require.lua repos.lua dir.lua make_manifest.lua command_line.lua config_cmd.lua install.lua build/command.lua build/cmake.lua build/make.lua build/builtin.lua fetch/cvs.lua fetch/git.lua fetch/sscm.lua tools/patch.lua fetch/svn.lua tools/zip.lua tools/tar.lua pack.lua type_check.lua make.lua remove.lua fs.lua manif.lua add.lua deps.lua build.lua search.lua show.lua manif_core.lua fetch.lua unpack.lua validate.lua cfg.lua download.lua help.lua util.lua index.lua cache.lua refresh_cache.lua loader.lua admin_remove.lua fetch/hg.lua fetch/git_file.lua new_version.lua lint.lua purge.lua path.lua path_cmd.lua write_rockspec.lua doc.lua upload.lua upload/api.lua upload/multipart.lua fetch/git_http.lua fetch/hg_http.lua fetch/hg_https.lua fetch/hg_ssh.lua fetch/git_https.lua; \
    do \
       d="/usr/local/share/lua/5.1//luarocks"/`dirname "$f"` && \
       mkdir -p "$d" && \
       cp "$f" "$d" || exit 1; \
    done
cp: /usr/local/share/lua/5.1//luarocks/fs/unix/tools.lua: Permission denied
make: *** [install_luas] Error 1
172-15-2-13:luarocks-2.3.0 mac$ sudo make install
mkdir -p "/usr/local/bin"
cd src/bin && \
    luaver="5.1" && [ -n "$luaver" ] || luaver=` -e 'print(_VERSION:sub(5))'`; \
    for f in luarocks luarocks-admin; \
    do \
       cp "$f" "/usr/local/bin/$f-$luaver"; \
       ln -nfs "$f-$luaver" "/usr/local/bin/$f"; \
    done
mkdir -p "/usr/local/share/lua/5.1//luarocks"
cd src/luarocks && for f in fs/unix/tools.lua fs/unix.lua fs/win32/tools.lua fs/win32.lua fs/lua.lua persist.lua list.lua require.lua repos.lua dir.lua make_manifest.lua command_line.lua config_cmd.lua install.lua build/command.lua build/cmake.lua build/make.lua build/builtin.lua fetch/cvs.lua fetch/git.lua fetch/sscm.lua tools/patch.lua fetch/svn.lua tools/zip.lua tools/tar.lua pack.lua type_check.lua make.lua remove.lua fs.lua manif.lua add.lua deps.lua build.lua search.lua show.lua manif_core.lua fetch.lua unpack.lua validate.lua cfg.lua download.lua help.lua util.lua index.lua cache.lua refresh_cache.lua loader.lua admin_remove.lua fetch/hg.lua fetch/git_file.lua new_version.lua lint.lua purge.lua path.lua path_cmd.lua write_rockspec.lua doc.lua upload.lua upload/api.lua upload/multipart.lua fetch/git_http.lua fetch/hg_http.lua fetch/hg_https.lua fetch/hg_ssh.lua fetch/git_https.lua; \
    do \
       d="/usr/local/share/lua/5.1//luarocks"/`dirname "$f"` && \
       mkdir -p "$d" && \
       cp "$f" "$d" || exit 1; \
    done
mkdir -p "/usr/local/share/lua/5.1//luarocks"
cp src/luarocks/site_config.lua "/usr/local/share/lua/5.1//luarocks"
mkdir -p "/usr/local"
if [ ! -f "/usr/local/etc/luarocks/config-5.1.lua" ] ;\
    then \
       mkdir -p `dirname "/usr/local/etc/luarocks/config-5.1.lua"` ;\
       echo 'rocks_trees = {' >> "/usr/local/etc/luarocks/config-5.1.lua" ;\
       if  [ ! -n "" ] ;\
       then \
          echo '   { name = [[user]], root = home..[[/.luarocks]] },' >> "/usr/local/etc/luarocks/config-5.1.lua" ;\
       fi ;\
       echo '   { name = [[system]], root = [[/usr/local]] }' >> "/usr/local/etc/luarocks/config-5.1.lua" ;\
       echo '}' >> "/usr/local/etc/luarocks/config-5.1.lua" ;\
    fi

172-15-2-13:luarocks-2.3.0 mac$ sudo make bootstrap
mkdir -p "/usr/local/share/lua/5.1//luarocks"
cp src/luarocks/site_config.lua "/usr/local/share/lua/5.1//luarocks"
mkdir -p "/usr/local"
if [ ! -f "/usr/local/etc/luarocks/config-5.1.lua" ] ;\
    then \
       mkdir -p `dirname "/usr/local/etc/luarocks/config-5.1.lua"` ;\
       echo 'rocks_trees = {' >> "/usr/local/etc/luarocks/config-5.1.lua" ;\
       if  [ ! -n "" ] ;\
       then \
          echo '   { name = [[user]], root = home..[[/.luarocks]] },' >> "/usr/local/etc/luarocks/config-5.1.lua" ;\
       fi ;\
       echo '   { name = [[system]], root = [[/usr/local]] }' >> "/usr/local/etc/luarocks/config-5.1.lua" ;\
       echo '}' >> "/usr/local/etc/luarocks/config-5.1.lua" ;\
    fi
for f in luarocks luarocks-admin ;\
    do \
       mv src/bin/$f src/bin/$f.bak ;\
       sed "s,^#!.*lua.*,#!/usr/bin/env lua,;/^package.path/d" < src/bin/$f.bak > src/bin/$f ;\
       chmod +x src/bin/$f ;\
       rm -f src/bin/$f.bak ;\
    done
'/usr/local/bin/lua' -e "package.path=[[`echo "$PWD" | sed -e 's/\([][]\)\1/]]..'\''\1\1'\''..[[/g'`/src/?.lua;]]..package.path" src/bin/luarocks make rockspec --tree="/usr/local"
Warning: variable CFLAGS was not passed in build_variables
mkdir -p "/usr/local/lib/luarocks/rocks/luarocks/2.3.0-1/bin"
cd src/bin && \
    luaver="5.1" && [ -n "$luaver" ] || luaver=`lua -e 'print(_VERSION:sub(5))'`; \
    for f in luarocks luarocks-admin; \
    do \
       cp "$f" "/usr/local/lib/luarocks/rocks/luarocks/2.3.0-1/bin/$f-$luaver"; \
       ln -nfs "$f-$luaver" "/usr/local/lib/luarocks/rocks/luarocks/2.3.0-1/bin/$f"; \
    done
mkdir -p "/usr/local/lib/luarocks/rocks/luarocks/2.3.0-1/lua/luarocks"
cd src/luarocks && for f in fs/unix/tools.lua fs/unix.lua fs/win32/tools.lua fs/win32.lua fs/lua.lua persist.lua list.lua require.lua repos.lua dir.lua make_manifest.lua command_line.lua config_cmd.lua install.lua build/command.lua build/cmake.lua build/make.lua build/builtin.lua fetch/cvs.lua fetch/git.lua fetch/sscm.lua tools/patch.lua fetch/svn.lua tools/zip.lua tools/tar.lua pack.lua type_check.lua make.lua remove.lua fs.lua manif.lua add.lua deps.lua build.lua search.lua show.lua manif_core.lua fetch.lua unpack.lua validate.lua cfg.lua download.lua help.lua util.lua index.lua cache.lua refresh_cache.lua loader.lua admin_remove.lua fetch/hg.lua fetch/git_file.lua new_version.lua lint.lua purge.lua path.lua path_cmd.lua write_rockspec.lua doc.lua upload.lua upload/api.lua upload/multipart.lua fetch/git_http.lua fetch/hg_http.lua fetch/hg_https.lua fetch/hg_ssh.lua fetch/git_https.lua; \
    do \
       d="/usr/local/lib/luarocks/rocks/luarocks/2.3.0-1/lua/luarocks"/`dirname "$f"` && \
       mkdir -p "$d" && \
       cp "$f" "$d" || exit 1; \
    done
Warning: /usr/local/share/lua/5.1/luarocks/config_cmd.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/luarocks/config_cmd.lua~
Updating manifest for /usr/local/lib/luarocks/rocks
luarocks 2.3.0-1 is now built and installed in /usr/local (license: MIT/X11)

Checking stability of dependencies on the absence of
luarocks 2.2.2-1...

Removing luarocks 2.2.2-1...
Removal successful.
172-15-2-13:luarocks-2.3.0 mac$ brew install zmq
Error: Another active Homebrew process is already in progress.
Please wait for it to finish or terminate it to continue.
==> Downloading https://homebrew.bintray.com/bottles/zeromq-4.1.5.yosemite.bottl
######################################################################## 100.0%
==> Pouring zeromq-4.1.5.yosemite.bottle.tar.gz
Error: The `brew link` step did not complete successfully
The formula built, but is not symlinked into /usr/local
Could not symlink lib/libzmq.a
Target /usr/local/lib/libzmq.a
already exists. You may want to remove it:
  rm '/usr/local/lib/libzmq.a'

To force the link and overwrite all conflicting files:
  brew link --overwrite zeromq

To list all files that would be deleted:
  brew link --overwrite --dry-run zeromq

Possible conflicting files are:
/usr/local/lib/libzmq.a
/usr/local/lib/libzmq.dylib
==> Summary
🍺  /usr/local/Cellar/zeromq/4.1.5: 12 files, 1.5M

172-15-2-13:luarocks-2.3.0 mac$ sudo luarocks install lzmq
Installing https://luarocks.org/lzmq-0.4.3-1.src.rock...
Using https://luarocks.org/lzmq-0.4.3-1.src.rock... switching to 'build' mode

Error: Could not find header file for ZMQ
  No file zmq.h in /usr/local/include
  No file zmq.h in /usr/include
You may have to install ZMQ in your system and/or pass ZMQ_DIR or ZMQ_INCDIR to the luarocks command.
Example: luarocks install lzmq ZMQ_DIR=/usr/local
172-15-2-13:luarocks-2.3.0 mac$ sudo luarocks install lzmq
Installing https://luarocks.org/lzmq-0.4.3-1.src.rock...
Using https://luarocks.org/lzmq-0.4.3-1.src.rock... switching to 'build' mode
Archive:  v0.4.3.zip
72dbca09652bcc8f27a6ae2662f05d8220e25a2f
   creating: lzmq-0.4.3/
  inflating: lzmq-0.4.3/.gitignore   
  inflating: lzmq-0.4.3/.travis.yml  
   creating: lzmq-0.4.3/.travis/
  inflating: lzmq-0.4.3/.travis/platform.sh  
  inflating: lzmq-0.4.3/.travis/setup_lua.sh  
  inflating: lzmq-0.4.3/.travis/setup_sodium.sh  
  inflating: lzmq-0.4.3/.travis/setup_zmq.sh  
  inflating: lzmq-0.4.3/CMakeLists.txt  
  inflating: lzmq-0.4.3/LICENCE.txt  
  inflating: lzmq-0.4.3/README.md    
   creating: lzmq-0.4.3/cmake/
  inflating: lzmq-0.4.3/cmake/FindLua.cmake  
  inflating: lzmq-0.4.3/cmake/FindZMQ.cmake  
  inflating: lzmq-0.4.3/cmake/dist.cmake  
  inflating: lzmq-0.4.3/cmake/lua.cmake  
  inflating: lzmq-0.4.3/dist.info    
   creating: lzmq-0.4.3/doc/
  inflating: lzmq-0.4.3/doc/lzmq.ldoc  
   creating: lzmq-0.4.3/doc/lzmq/
  inflating: lzmq-0.4.3/doc/lzmq/loop.ldoc  
  inflating: lzmq-0.4.3/doc/lzmq/poller.ldoc  
  inflating: lzmq-0.4.3/doc/lzmq/threads.ldoc  
  inflating: lzmq-0.4.3/doc/lzmq/timer.ldoc  
   creating: lzmq-0.4.3/examples/
   creating: lzmq-0.4.3/examples/device/
  inflating: lzmq-0.4.3/examples/device/cli.lua  
  inflating: lzmq-0.4.3/examples/device/device.lua  
  inflating: lzmq-0.4.3/examples/device/srv.lua  
  inflating: lzmq-0.4.3/examples/echo_cli.lua  
  inflating: lzmq-0.4.3/examples/echo_loop.lua  
  inflating: lzmq-0.4.3/examples/echo_loop_raw.lua  
  inflating: lzmq-0.4.3/examples/monitor.lua  
   creating: lzmq-0.4.3/examples/perf/
  inflating: lzmq-0.4.3/examples/perf/local_lat.lua  
  inflating: lzmq-0.4.3/examples/perf/local_multipart.lua  
  inflating: lzmq-0.4.3/examples/perf/local_thr.lua  
  inflating: lzmq-0.4.3/examples/perf/remote_lat.lua  
  inflating: lzmq-0.4.3/examples/perf/remote_multipart.lua  
  inflating: lzmq-0.4.3/examples/perf/remote_thr.lua  
  inflating: lzmq-0.4.3/examples/perf/test_lat.bat  
  inflating: lzmq-0.4.3/examples/perf/test_multipart.bat  
  inflating: lzmq-0.4.3/examples/perf/test_thr.bat  
  inflating: lzmq-0.4.3/examples/perf/thread_lat.lua  
  inflating: lzmq-0.4.3/examples/perf/thread_thr.lua  
   creating: lzmq-0.4.3/examples/perf2/
   creating: lzmq-0.4.3/examples/perf2/lat/
  inflating: lzmq-0.4.3/examples/perf2/lat/inproc_lat.lua  
  inflating: lzmq-0.4.3/examples/perf2/lat/local_lat.lua  
  inflating: lzmq-0.4.3/examples/perf2/lat/remote_lat.lua  
   creating: lzmq-0.4.3/examples/perf2/lat_nomsg/
  inflating: lzmq-0.4.3/examples/perf2/lat_nomsg/inproc_lat.lua  
  inflating: lzmq-0.4.3/examples/perf2/lat_nomsg/local_lat.lua  
  inflating: lzmq-0.4.3/examples/perf2/lat_nomsg/remote_lat.lua  
  inflating: lzmq-0.4.3/examples/perf2/runner.lua  
   creating: lzmq-0.4.3/examples/perf2/thr/
  inflating: lzmq-0.4.3/examples/perf2/thr/inproc_thr.lua  
  inflating: lzmq-0.4.3/examples/perf2/thr/local_thr.lua  
  inflating: lzmq-0.4.3/examples/perf2/thr/remote_thr.lua  
   creating: lzmq-0.4.3/examples/perf2/thr_nomsg/
  inflating: lzmq-0.4.3/examples/perf2/thr_nomsg/inproc_thr.lua  
  inflating: lzmq-0.4.3/examples/perf2/thr_nomsg/local_thr.lua  
  inflating: lzmq-0.4.3/examples/perf2/thr_nomsg/remote_thr.lua  
  inflating: lzmq-0.4.3/examples/queue_device.lua  
  inflating: lzmq-0.4.3/examples/utils.lua  
  inflating: lzmq-0.4.3/examples/uv_actor.lua  
  inflating: lzmq-0.4.3/examples/zap.lua  
  inflating: lzmq-0.4.3/lakeconfig.lua  
  inflating: lzmq-0.4.3/lakefile     
   creating: lzmq-0.4.3/msvc/
  inflating: lzmq-0.4.3/msvc/luazmq.sln  
  inflating: lzmq-0.4.3/msvc/luazmq.vcproj  
  inflating: lzmq-0.4.3/msvc/lztimer.vcproj  
   creating: lzmq-0.4.3/rockspecs/
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.1.0-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.1.1-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.1.2-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.1.3-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.2.0-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.3.0-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.3.1-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.3.2-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.3.3-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.3.4-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.3.5-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.3.6-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.4.0-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.4.1-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.4.2-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-0.4.3-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.1.3-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.2.0-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.3.0-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.3.1-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.3.2-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.3.3-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.3.4-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.3.5-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.3.6-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.4.0-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.4.1-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.4.2-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-0.4.3-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-ffi-scm-0.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-scm-0.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-timer-0.1.2-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-timer-0.3.5-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-timer-0.4.2-1.rockspec  
  inflating: lzmq-0.4.3/rockspecs/lzmq-timer-scm-0.rockspec  
   creating: lzmq-0.4.3/script/
  inflating: lzmq-0.4.3/script/getsockopt.lua  
   creating: lzmq-0.4.3/src/
   creating: lzmq-0.4.3/src/lua/
   creating: lzmq-0.4.3/src/lua/lzmq/
  inflating: lzmq-0.4.3/src/lua/lzmq/ffi.lua  
   creating: lzmq-0.4.3/src/lua/lzmq/ffi/
  inflating: lzmq-0.4.3/src/lua/lzmq/ffi/api.lua  
  inflating: lzmq-0.4.3/src/lua/lzmq/ffi/error.lua  
  inflating: lzmq-0.4.3/src/lua/lzmq/ffi/loop.lua  
  inflating: lzmq-0.4.3/src/lua/lzmq/ffi/lzmq.lua  
  inflating: lzmq-0.4.3/src/lua/lzmq/ffi/poller.lua  
  inflating: lzmq-0.4.3/src/lua/lzmq/ffi/threads.lua  
  inflating: lzmq-0.4.3/src/lua/lzmq/ffi/timer.lua  
   creating: lzmq-0.4.3/src/lua/lzmq/impl/
  inflating: lzmq-0.4.3/src/lua/lzmq/impl/loop.lua  
  inflating: lzmq-0.4.3/src/lua/lzmq/impl/threads.lua  
   creating: lzmq-0.4.3/src/lua/lzmq/llthreads/
  inflating: lzmq-0.4.3/src/lua/lzmq/llthreads/ex.lua  
  inflating: lzmq-0.4.3/src/lua/lzmq/loop.lua  
  inflating: lzmq-0.4.3/src/lua/lzmq/poller.lua  
  inflating: lzmq-0.4.3/src/lua/lzmq/threads.lua  
  inflating: lzmq-0.4.3/src/lzmq.c   
  inflating: lzmq-0.4.3/src/lzmq.def  
  inflating: lzmq-0.4.3/src/lzmq.h   
  inflating: lzmq-0.4.3/src/lzutils.c  
  inflating: lzmq-0.4.3/src/lzutils.h  
  inflating: lzmq-0.4.3/src/poller.c  
  inflating: lzmq-0.4.3/src/poller.h  
  inflating: lzmq-0.4.3/src/timer.def  
  inflating: lzmq-0.4.3/src/zcontext.c  
  inflating: lzmq-0.4.3/src/zcontext.h  
  inflating: lzmq-0.4.3/src/zerror.c  
  inflating: lzmq-0.4.3/src/zerror.h  
  inflating: lzmq-0.4.3/src/zmsg.c   
  inflating: lzmq-0.4.3/src/zmsg.h   
  inflating: lzmq-0.4.3/src/zpoller.c  
  inflating: lzmq-0.4.3/src/zpoller.h  
  inflating: lzmq-0.4.3/src/zsocket.c  
  inflating: lzmq-0.4.3/src/zsocket.h  
  inflating: lzmq-0.4.3/src/zsupport.h  
  inflating: lzmq-0.4.3/src/ztimer.c  
  inflating: lzmq-0.4.3/src/ztimer.h  
   creating: lzmq-0.4.3/test/
  inflating: lzmq-0.4.3/test/.luacov  
  inflating: lzmq-0.4.3/test/.luacov.ffi  
   creating: lzmq-0.4.3/test/lunit/
  inflating: lzmq-0.4.3/test/lunit/console.lua  
  inflating: lzmq-0.4.3/test/test.lua  
  inflating: lzmq-0.4.3/test/test_metadata.lua  
  inflating: lzmq-0.4.3/test/test_proxy.lua  
  inflating: lzmq-0.4.3/test/test_req_relaxed.lua  
  inflating: lzmq-0.4.3/test/test_threads.lua  
  inflating: lzmq-0.4.3/test/test_threads_actor.lua  
  inflating: lzmq-0.4.3/test/test_threads_actor_poll.lua  
  inflating: lzmq-0.4.3/test/test_threads_arg.lua  
  inflating: lzmq-0.4.3/test/test_threads_file.lua  
  inflating: lzmq-0.4.3/test/test_threads_fork.lua  
  inflating: lzmq-0.4.3/test/test_threads_fork_arg.lua  
  inflating: lzmq-0.4.3/test/test_threads_fork_opt.lua  
  inflating: lzmq-0.4.3/test/test_threads_opt.lua  
  inflating: lzmq-0.4.3/test/test_threads_sync.lua  
 extracting: lzmq-0.4.3/test/thread.lua  
  inflating: lzmq-0.4.3/test/utest.lua  
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/lzmq.c -o src/lzmq.o -DLUAZMQ_USE_SEND_AS_BUF -DLUAZMQ_USE_TEMP_BUFFERS -DLUAZMQ_USE_ERR_TYPE_OBJECT -I/usr/local/include
src/lzmq.c:366:10: warning: implicitly declaring library function 'malloc' with
      type 'void *(unsigned long)'
  dest = LUAZMQ_ALLOC_TEMP(buffer_storage, dest_len);
         ^
src/lzutils.h:80:67: note: expanded from macro 'LUAZMQ_ALLOC_TEMP'
# define LUAZMQ_ALLOC_TEMP(BUF, SIZE) (sizeof(BUF) >= SIZE)?(BUF):malloc(SIZE)
                                                                  ^
src/lzmq.c:366:10: note: include the header <stdlib.h> or explicitly provide a
      declaration for 'malloc'
src/lzutils.h:80:67: note: expanded from macro 'LUAZMQ_ALLOC_TEMP'
# define LUAZMQ_ALLOC_TEMP(BUF, SIZE) (sizeof(BUF) >= SIZE)?(BUF):malloc(SIZE)
                                                                  ^
src/lzmq.c:369:3: warning: implicit declaration of function 'free' is invalid in
      C99 [-Wimplicit-function-declaration]
  LUAZMQ_FREE_TEMP(buffer_storage, dest);
  ^
src/lzutils.h:81:58: note: expanded from macro 'LUAZMQ_FREE_TEMP'
# define LUAZMQ_FREE_TEMP(BUF, PTR) do{if((PTR) != (BUF))free((void*)PTR...
                                                         ^
2 warnings generated.
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/lzutils.c -o src/lzutils.o -DLUAZMQ_USE_SEND_AS_BUF -DLUAZMQ_USE_TEMP_BUFFERS -DLUAZMQ_USE_ERR_TYPE_OBJECT -I/usr/local/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/poller.c -o src/poller.o -DLUAZMQ_USE_SEND_AS_BUF -DLUAZMQ_USE_TEMP_BUFFERS -DLUAZMQ_USE_ERR_TYPE_OBJECT -I/usr/local/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/zcontext.c -o src/zcontext.o -DLUAZMQ_USE_SEND_AS_BUF -DLUAZMQ_USE_TEMP_BUFFERS -DLUAZMQ_USE_ERR_TYPE_OBJECT -I/usr/local/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/zerror.c -o src/zerror.o -DLUAZMQ_USE_SEND_AS_BUF -DLUAZMQ_USE_TEMP_BUFFERS -DLUAZMQ_USE_ERR_TYPE_OBJECT -I/usr/local/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/zmsg.c -o src/zmsg.o -DLUAZMQ_USE_SEND_AS_BUF -DLUAZMQ_USE_TEMP_BUFFERS -DLUAZMQ_USE_ERR_TYPE_OBJECT -I/usr/local/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/zpoller.c -o src/zpoller.o -DLUAZMQ_USE_SEND_AS_BUF -DLUAZMQ_USE_TEMP_BUFFERS -DLUAZMQ_USE_ERR_TYPE_OBJECT -I/usr/local/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/zsocket.c -o src/zsocket.o -DLUAZMQ_USE_SEND_AS_BUF -DLUAZMQ_USE_TEMP_BUFFERS -DLUAZMQ_USE_ERR_TYPE_OBJECT -I/usr/local/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o lzmq.so -L/usr/local/lib src/lzmq.o src/lzutils.o src/poller.o src/zcontext.o src/zerror.o src/zmsg.o src/zpoller.o src/zsocket.o -L/usr/local/lib -Wl,-rpath,/usr/local/lib: -lzmq
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/ztimer.c -o src/ztimer.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/lzutils.c -o src/lzutils.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o lzmq/timer.so -L/usr/local/lib src/ztimer.o src/lzutils.o
Warning: /usr/local/share/lua/5.1/lzmq/impl/loop.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/impl/loop.lua~
Warning: /usr/local/share/lua/5.1/lzmq/impl/threads.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/impl/threads.lua~
Warning: /usr/local/share/lua/5.1/lzmq/ffi.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/ffi.lua~
Warning: /usr/local/share/lua/5.1/lzmq/poller.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/poller.lua~
Warning: /usr/local/share/lua/5.1/lzmq/threads.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/threads.lua~
Warning: /usr/local/share/lua/5.1/lzmq/loop.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/loop.lua~
Warning: /usr/local/share/lua/5.1/lzmq/ffi/loop.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/ffi/loop.lua~
Warning: /usr/local/share/lua/5.1/lzmq/ffi/timer.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/ffi/timer.lua~
Warning: /usr/local/share/lua/5.1/lzmq/ffi/poller.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/ffi/poller.lua~
Warning: /usr/local/share/lua/5.1/lzmq/ffi/threads.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/ffi/threads.lua~
Warning: /usr/local/share/lua/5.1/lzmq/ffi/error.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/ffi/error.lua~
Warning: /usr/local/share/lua/5.1/lzmq/ffi/api.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/ffi/api.lua~
Warning: /usr/local/share/lua/5.1/lzmq/llthreads/ex.lua is not tracked by this installation of LuaRocks. Moving it to /usr/local/share/lua/5.1/lzmq/llthreads/ex.lua~
Updating manifest for /usr/local/lib/luarocks/rocks
lzmq 0.4.3-1 is now built and installed in /usr/local (license: MIT/X11)








172-15-2-13:lua-5.1.4 mac$ luarocks install luasocket

Error: Your user does not have write permissions in /usr/local/lib/luarocks/rocks 
-- you may want to run as a privileged user or use your local tree with --local.
172-15-2-13:lua-5.1.4 mac$ sudo luarocks install luasocket
Installing https://luarocks.org/luasocket-3.0rc1-2.src.rock...
Using https://luarocks.org/luasocket-3.0rc1-2.src.rock... switching to 'build' mode
Archive:  v3.0-rc1.zip
22cd5833fcc0e272f26004a79c8545e959ba406b
   creating: luasocket-3.0-rc1/
  inflating: luasocket-3.0-rc1/.gitignore  
  inflating: luasocket-3.0-rc1/.travis.yml  
  inflating: luasocket-3.0-rc1/FIX   
  inflating: luasocket-3.0-rc1/LICENSE  
  inflating: luasocket-3.0-rc1/Lua51.props  
  inflating: luasocket-3.0-rc1/Lua52.props  
  inflating: luasocket-3.0-rc1/NEW   
  inflating: luasocket-3.0-rc1/README  
  inflating: luasocket-3.0-rc1/TODO  
  inflating: luasocket-3.0-rc1/WISH  
   creating: luasocket-3.0-rc1/doc/
  inflating: luasocket-3.0-rc1/doc/dns.html  
  inflating: luasocket-3.0-rc1/doc/ftp.html  
  inflating: luasocket-3.0-rc1/doc/http.html  
  inflating: luasocket-3.0-rc1/doc/index.html  
  inflating: luasocket-3.0-rc1/doc/installation.html  
  inflating: luasocket-3.0-rc1/doc/introduction.html  
  inflating: luasocket-3.0-rc1/doc/ltn12.html  
  inflating: luasocket-3.0-rc1/doc/lua05.ppt  
  inflating: luasocket-3.0-rc1/doc/luasocket.png  
  inflating: luasocket-3.0-rc1/doc/mime.html  
  inflating: luasocket-3.0-rc1/doc/reference.css  
  inflating: luasocket-3.0-rc1/doc/reference.html  
  inflating: luasocket-3.0-rc1/doc/smtp.html  
  inflating: luasocket-3.0-rc1/doc/socket.html  
  inflating: luasocket-3.0-rc1/doc/tcp.html  
  inflating: luasocket-3.0-rc1/doc/udp.html  
  inflating: luasocket-3.0-rc1/doc/url.html  
   creating: luasocket-3.0-rc1/etc/
  inflating: luasocket-3.0-rc1/etc/README  
  inflating: luasocket-3.0-rc1/etc/b64.lua  
  inflating: luasocket-3.0-rc1/etc/check-links.lua  
  inflating: luasocket-3.0-rc1/etc/check-memory.lua  
  inflating: luasocket-3.0-rc1/etc/cookie.lua  
  inflating: luasocket-3.0-rc1/etc/dict.lua  
  inflating: luasocket-3.0-rc1/etc/dispatch.lua  
  inflating: luasocket-3.0-rc1/etc/eol.lua  
  inflating: luasocket-3.0-rc1/etc/forward.lua  
  inflating: luasocket-3.0-rc1/etc/get.lua  
  inflating: luasocket-3.0-rc1/etc/links  
  inflating: luasocket-3.0-rc1/etc/lp.lua  
  inflating: luasocket-3.0-rc1/etc/qp.lua  
  inflating: luasocket-3.0-rc1/etc/tftp.lua  
   creating: luasocket-3.0-rc1/gem/
  inflating: luasocket-3.0-rc1/gem/ex1.lua  
  inflating: luasocket-3.0-rc1/gem/ex10.lua  
  inflating: luasocket-3.0-rc1/gem/ex11.lua  
  inflating: luasocket-3.0-rc1/gem/ex12.lua  
  inflating: luasocket-3.0-rc1/gem/ex2.lua  
  inflating: luasocket-3.0-rc1/gem/ex3.lua  
  inflating: luasocket-3.0-rc1/gem/ex4.lua  
  inflating: luasocket-3.0-rc1/gem/ex5.lua  
  inflating: luasocket-3.0-rc1/gem/ex6.lua  
  inflating: luasocket-3.0-rc1/gem/ex7.lua  
  inflating: luasocket-3.0-rc1/gem/ex8.lua  
  inflating: luasocket-3.0-rc1/gem/ex9.lua  
  inflating: luasocket-3.0-rc1/gem/gem.c  
  inflating: luasocket-3.0-rc1/gem/gt.b64  
  inflating: luasocket-3.0-rc1/gem/input.bin  
  inflating: luasocket-3.0-rc1/gem/ltn012.tex  
  inflating: luasocket-3.0-rc1/gem/luasocket.png  
  inflating: luasocket-3.0-rc1/gem/makefile  
  inflating: luasocket-3.0-rc1/gem/myps2pdf  
  inflating: luasocket-3.0-rc1/gem/t1.lua  
  inflating: luasocket-3.0-rc1/gem/t1lf.txt  
  inflating: luasocket-3.0-rc1/gem/t2.lua  
  inflating: luasocket-3.0-rc1/gem/t2.txt  
  inflating: luasocket-3.0-rc1/gem/t2gt.qp  
  inflating: luasocket-3.0-rc1/gem/t3.lua  
  inflating: luasocket-3.0-rc1/gem/t4.lua  
  inflating: luasocket-3.0-rc1/gem/t5.lua  
  inflating: luasocket-3.0-rc1/gem/test.lua  
  inflating: luasocket-3.0-rc1/linux.cmd  
  inflating: luasocket-3.0-rc1/logo.ps  
  inflating: luasocket-3.0-rc1/ltn012.wiki  
  inflating: luasocket-3.0-rc1/ltn013.wiki  
  inflating: luasocket-3.0-rc1/luasocket-scm-0.rockspec  
  inflating: luasocket-3.0-rc1/luasocket.sln  
  inflating: luasocket-3.0-rc1/macosx.cmd  
  inflating: luasocket-3.0-rc1/makefile  
  inflating: luasocket-3.0-rc1/makefile.dist  
  inflating: luasocket-3.0-rc1/mime.vcxproj  
  inflating: luasocket-3.0-rc1/mime.vcxproj.filters  
  inflating: luasocket-3.0-rc1/mingw.cmd  
   creating: luasocket-3.0-rc1/samples/
  inflating: luasocket-3.0-rc1/samples/README  
  inflating: luasocket-3.0-rc1/samples/cddb.lua  
  inflating: luasocket-3.0-rc1/samples/daytimeclnt.lua  
  inflating: luasocket-3.0-rc1/samples/echoclnt.lua  
  inflating: luasocket-3.0-rc1/samples/echosrvr.lua  
  inflating: luasocket-3.0-rc1/samples/listener.lua  
  inflating: luasocket-3.0-rc1/samples/lpr.lua  
  inflating: luasocket-3.0-rc1/samples/mclisten.lua  
  inflating: luasocket-3.0-rc1/samples/mcsend.lua  
  inflating: luasocket-3.0-rc1/samples/talker.lua  
  inflating: luasocket-3.0-rc1/samples/tinyirc.lua  
  inflating: luasocket-3.0-rc1/socket.vcxproj  
  inflating: luasocket-3.0-rc1/socket.vcxproj.filters  
   creating: luasocket-3.0-rc1/src/
  inflating: luasocket-3.0-rc1/src/auxiliar.c  
  inflating: luasocket-3.0-rc1/src/auxiliar.h  
  inflating: luasocket-3.0-rc1/src/buffer.c  
  inflating: luasocket-3.0-rc1/src/buffer.h  
  inflating: luasocket-3.0-rc1/src/except.c  
  inflating: luasocket-3.0-rc1/src/except.h  
  inflating: luasocket-3.0-rc1/src/ftp.lua  
  inflating: luasocket-3.0-rc1/src/headers.lua  
  inflating: luasocket-3.0-rc1/src/http.lua  
  inflating: luasocket-3.0-rc1/src/inet.c  
  inflating: luasocket-3.0-rc1/src/inet.h  
  inflating: luasocket-3.0-rc1/src/io.c  
  inflating: luasocket-3.0-rc1/src/io.h  
  inflating: luasocket-3.0-rc1/src/ltn12.lua  
  inflating: luasocket-3.0-rc1/src/luasocket.c  
  inflating: luasocket-3.0-rc1/src/luasocket.h  
  inflating: luasocket-3.0-rc1/src/makefile  
  inflating: luasocket-3.0-rc1/src/mbox.lua  
  inflating: luasocket-3.0-rc1/src/mime.c  
  inflating: luasocket-3.0-rc1/src/mime.h  
  inflating: luasocket-3.0-rc1/src/mime.lua  
  inflating: luasocket-3.0-rc1/src/options.c  
  inflating: luasocket-3.0-rc1/src/options.h  
  inflating: luasocket-3.0-rc1/src/select.c  
  inflating: luasocket-3.0-rc1/src/select.h  
  inflating: luasocket-3.0-rc1/src/serial.c  
  inflating: luasocket-3.0-rc1/src/smtp.lua  
  inflating: luasocket-3.0-rc1/src/socket.h  
  inflating: luasocket-3.0-rc1/src/socket.lua  
  inflating: luasocket-3.0-rc1/src/tcp.c  
  inflating: luasocket-3.0-rc1/src/tcp.h  
  inflating: luasocket-3.0-rc1/src/timeout.c  
  inflating: luasocket-3.0-rc1/src/timeout.h  
  inflating: luasocket-3.0-rc1/src/tp.lua  
  inflating: luasocket-3.0-rc1/src/udp.c  
  inflating: luasocket-3.0-rc1/src/udp.h  
  inflating: luasocket-3.0-rc1/src/unix.c  
  inflating: luasocket-3.0-rc1/src/unix.h  
  inflating: luasocket-3.0-rc1/src/url.lua  
  inflating: luasocket-3.0-rc1/src/usocket.c  
  inflating: luasocket-3.0-rc1/src/usocket.h  
  inflating: luasocket-3.0-rc1/src/wsocket.c  
  inflating: luasocket-3.0-rc1/src/wsocket.h  
   creating: luasocket-3.0-rc1/test/
  inflating: luasocket-3.0-rc1/test/README  
   creating: luasocket-3.0-rc1/test/auth/
 extracting: luasocket-3.0-rc1/test/auth/.htpasswd  
  inflating: luasocket-3.0-rc1/test/auth/index.html  
   creating: luasocket-3.0-rc1/test/cgi/
  inflating: luasocket-3.0-rc1/test/cgi/cat  
  inflating: luasocket-3.0-rc1/test/cgi/cat-index-html  
  inflating: luasocket-3.0-rc1/test/cgi/env  
  inflating: luasocket-3.0-rc1/test/cgi/query-string  
  inflating: luasocket-3.0-rc1/test/cgi/redirect-loop  
  inflating: luasocket-3.0-rc1/test/cgi/request-uri  
  inflating: luasocket-3.0-rc1/test/dicttest.lua  
  inflating: luasocket-3.0-rc1/test/excepttest.lua  
  inflating: luasocket-3.0-rc1/test/find-connect-limit  
  inflating: luasocket-3.0-rc1/test/ftptest.lua  
  inflating: luasocket-3.0-rc1/test/hello.lua  
  inflating: luasocket-3.0-rc1/test/httptest.lua  
  inflating: luasocket-3.0-rc1/test/index.html  
  inflating: luasocket-3.0-rc1/test/ltn12test.lua  
  inflating: luasocket-3.0-rc1/test/luasocket.png  
  inflating: luasocket-3.0-rc1/test/mimetest.lua  
  inflating: luasocket-3.0-rc1/test/smtptest.lua  
  inflating: luasocket-3.0-rc1/test/stufftest.lua  
  inflating: luasocket-3.0-rc1/test/tcp-getoptions  
  inflating: luasocket-3.0-rc1/test/test_bind.lua  
  inflating: luasocket-3.0-rc1/test/test_getaddrinfo.lua  
  inflating: luasocket-3.0-rc1/test/test_socket_error.lua  
  inflating: luasocket-3.0-rc1/test/testclnt.lua  
  inflating: luasocket-3.0-rc1/test/testmesg.lua  
  inflating: luasocket-3.0-rc1/test/testsrvr.lua  
  inflating: luasocket-3.0-rc1/test/testsupport.lua  
  inflating: luasocket-3.0-rc1/test/tftptest.lua  
  inflating: luasocket-3.0-rc1/test/udp-zero-length-send  
  inflating: luasocket-3.0-rc1/test/udp-zero-length-send-recv  
  inflating: luasocket-3.0-rc1/test/udpconnectclnt.lua  
  inflating: luasocket-3.0-rc1/test/udpconnectsrvr.lua  
  inflating: luasocket-3.0-rc1/test/unixclnt.lua  
  inflating: luasocket-3.0-rc1/test/unixsrvr.lua  
  inflating: luasocket-3.0-rc1/test/upload.html  
  inflating: luasocket-3.0-rc1/test/urltest.lua  
  inflating: luasocket-3.0-rc1/test/utestclnt.lua  
  inflating: luasocket-3.0-rc1/test/utestsrvr.lua  
  inflating: luasocket-3.0-rc1/win32.cmd  
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/mime.c -o src/mime.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o mime/core.so -L/usr/local/lib src/mime.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/buffer.c -o src/buffer.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/auxiliar.c -o src/auxiliar.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/options.c -o src/options.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/timeout.c -o src/timeout.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/io.c -o src/io.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/usocket.c -o src/usocket.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/serial.c -o src/serial.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o socket/serial.so -L/usr/local/lib src/buffer.o src/auxiliar.o src/options.o src/timeout.o src/io.o src/usocket.o src/serial.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/buffer.c -o src/buffer.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/auxiliar.c -o src/auxiliar.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/options.c -o src/options.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/timeout.c -o src/timeout.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/io.c -o src/io.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/usocket.c -o src/usocket.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/unix.c -o src/unix.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o socket/unix.so -L/usr/local/lib src/buffer.o src/auxiliar.o src/options.o src/timeout.o src/io.o src/usocket.o src/unix.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/luasocket.c -o src/luasocket.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/timeout.c -o src/timeout.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/buffer.c -o src/buffer.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/io.c -o src/io.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/auxiliar.c -o src/auxiliar.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/options.c -o src/options.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/inet.c -o src/inet.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/except.c -o src/except.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/select.c -o src/select.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/tcp.c -o src/tcp.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/udp.c -o src/udp.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/usocket.c -o src/usocket.o -DLUA_COMPAT_APIINTCASTS -DLUASOCKET_DEBUG -DUNIX_HAS_SUN_LEN -DLUASOCKET_API=__attribute__((visibility("default"))) -DUNIX_API=__attribute__((visibility("default"))) -DMIME_API=__attribute__((visibility("default")))
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o socket/core.so -L/usr/local/lib src/luasocket.o src/timeout.o src/buffer.o src/io.o src/auxiliar.o src/options.o src/inet.o src/except.o src/select.o src/tcp.o src/udp.o src/usocket.o
Updating manifest for /usr/local/lib/luarocks/rocks
luasocket 3.0rc1-2 is now built and installed in /usr/local (license: MIT)

172-15-2-13:lua-5.1.4 mac$ sudo luarocks install lua-cjson
Warning: falling back to curl - install luasec to get native HTTPS support
Installing https://luarocks.org/lua-cjson-2.1.0-1.src.rock...
Using https://luarocks.org/lua-cjson-2.1.0-1.src.rock... switching to 'build' mode
Archive:  lua-cjson-2.1.0.zip
   creating: lua-cjson-2.1.0/
  inflating: lua-cjson-2.1.0/runtests.sh  
  inflating: lua-cjson-2.1.0/fpconv.c  
  inflating: lua-cjson-2.1.0/lua-cjson.spec  
  inflating: lua-cjson-2.1.0/rfc4627.txt  
  inflating: lua-cjson-2.1.0/dtoa.c  
  inflating: lua-cjson-2.1.0/lua-cjson-2.1.0-1.rockspec  
  inflating: lua-cjson-2.1.0/manual.txt  
  inflating: lua-cjson-2.1.0/performance.html  
  inflating: lua-cjson-2.1.0/CMakeLists.txt  
  inflating: lua-cjson-2.1.0/fpconv.h  
  inflating: lua-cjson-2.1.0/strbuf.h  
  inflating: lua-cjson-2.1.0/strbuf.c  
  inflating: lua-cjson-2.1.0/NEWS    
  inflating: lua-cjson-2.1.0/manual.html  
  inflating: lua-cjson-2.1.0/lua_cjson.c  
  inflating: lua-cjson-2.1.0/LICENSE  
  inflating: lua-cjson-2.1.0/dtoa_config.h  
   creating: lua-cjson-2.1.0/tests/
  inflating: lua-cjson-2.1.0/tests/bench.lua  
  inflating: lua-cjson-2.1.0/tests/numbers.json  
  inflating: lua-cjson-2.1.0/tests/example3.json  
  inflating: lua-cjson-2.1.0/tests/octets-escaped.dat  
 extracting: lua-cjson-2.1.0/tests/types.json  
  inflating: lua-cjson-2.1.0/tests/genutf8.pl  
  inflating: lua-cjson-2.1.0/tests/rfc-example1.json  
  inflating: lua-cjson-2.1.0/tests/example4.json  
  inflating: lua-cjson-2.1.0/tests/example2.json  
  inflating: lua-cjson-2.1.0/tests/README  
  inflating: lua-cjson-2.1.0/tests/rfc-example2.json  
  inflating: lua-cjson-2.1.0/tests/test.lua  
  inflating: lua-cjson-2.1.0/tests/example5.json  
  inflating: lua-cjson-2.1.0/tests/example1.json  
  inflating: lua-cjson-2.1.0/g_fmt.c  
  inflating: lua-cjson-2.1.0/Makefile  
   creating: lua-cjson-2.1.0/lua/
  inflating: lua-cjson-2.1.0/lua/lua2json.lua  
  inflating: lua-cjson-2.1.0/lua/json2lua.lua  
   creating: lua-cjson-2.1.0/lua/cjson/
  inflating: lua-cjson-2.1.0/lua/cjson/util.lua  
  inflating: lua-cjson-2.1.0/performance.txt  
  inflating: lua-cjson-2.1.0/THANKS  
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c lua_cjson.c -o lua_cjson.o
In file included from lua_cjson.c:47:
./fpconv.h:15:20: warning: inline function 'fpconv_init' is not defined
      [-Wundefined-inline]
extern inline void fpconv_init();
                   ^
lua_cjson.c:1359:5: note: used here
    fpconv_init();
    ^
1 warning generated.
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c strbuf.c -o strbuf.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c fpconv.c -o fpconv.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o cjson.so -L/usr/local/lib lua_cjson.o strbuf.o fpconv.o
Updating manifest for /usr/local/lib/luarocks/rocks
lua-cjson 2.1.0-1 is now built and installed in /usr/local (license: MIT)

172-15-2-13:lua-5.1.4 mac$ sudo luarocks install lua-llthreads
Warning: falling back to curl - install luasec to get native HTTPS support
Installing https://luarocks.org/lua-llthreads-1.2-1.src.rock...
Using https://luarocks.org/lua-llthreads-1.2-1.src.rock... switching to 'build' mode
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/pre_generated-llthreads.nobj.c -o src/pre_generated-llthreads.nobj.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o llthreads.so -L/usr/local/lib src/pre_generated-llthreads.nobj.o -lpthread
Updating manifest for /usr/local/lib/luarocks/rocks
lua-llthreads 1.2-1 is now built and installed in /usr/local (license: MIT/X11)

Checking stability of dependencies on the absence of
lua-llthreads scm-0...

Removing lua-llthreads scm-0...
cp: /usr/local/lib/lua/5.1/lua_llthreads_1_2_1-llthreads.so: No such file or directory
Removal successful.
172-15-2-13:lua-5.1.4 mac$ sudo luarocks install lua-llthreads
Warning: falling back to curl - install luasec to get native HTTPS support
Installing https://luarocks.org/lua-llthreads-1.2-1.src.rock...
Using https://luarocks.org/lua-llthreads-1.2-1.src.rock... switching to 'build' mode
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/pre_generated-llthreads.nobj.c -o src/pre_generated-llthreads.nobj.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o llthreads.so -L/usr/local/lib src/pre_generated-llthreads.nobj.o -lpthread
Updating manifest for /usr/local/lib/luarocks/rocks
lua-llthreads 1.2-1 is now built and installed in /usr/local (license: MIT/X11)

172-15-2-13:lua-5.1.4 mac$ sudo luarocks install luasql-sqlite3
Warning: falling back to curl - install luasec to get native HTTPS support
Installing https://luarocks.org/luasql-sqlite3-2.3.0-1.src.rock...
Using https://luarocks.org/luasql-sqlite3-2.3.0-1.src.rock... switching to 'build' mode
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/luasql.c -o src/luasql.o -I/usr/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/ls_sqlite3.c -o src/ls_sqlite3.o -I/usr/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o luasql/sqlite3.so -L/usr/local/lib src/luasql.o src/ls_sqlite3.o -L/usr/lib -Wl,-rpath,/usr/lib: -lsqlite3
Updating manifest for /usr/local/lib/luarocks/rocks
luasql-sqlite3 2.3.0-1 is now built and installed in /usr/local (license: MIT/X11)

172-15-2-13:lua-5.1.4 mac$ sudo luarocks install luafilesystem
Warning: falling back to curl - install luasec to get native HTTPS support
Installing https://luarocks.org/luafilesystem-1.6.3-2.src.rock...
Using https://luarocks.org/luafilesystem-1.6.3-2.src.rock... switching to 'build' mode
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/lfs.c -o src/lfs.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o lfs.so -L/usr/local/lib src/lfs.o
Updating manifest for /usr/local/lib/luarocks/rocks
luafilesystem 1.6.3-2 is now built and installed in /usr/local (license: MIT/X11)

Checking stability of dependencies on the absence of
luafilesystem 1.6.3-1...

Removing luafilesystem 1.6.3-1...
cp: /usr/local/lib/lua/5.1/luafilesystem_1_6_3_1-lfs.so: No such file or directory
Removal successful.
172-15-2-13:lua-5.1.4 mac$ sudo luarocks install luafilesystem
Warning: falling back to curl - install luasec to get native HTTPS support
Installing https://luarocks.org/luafilesystem-1.6.3-2.src.rock...
Using https://luarocks.org/luafilesystem-1.6.3-2.src.rock... switching to 'build' mode
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/lfs.c -o src/lfs.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o lfs.so -L/usr/local/lib src/lfs.o
Updating manifest for /usr/local/lib/luarocks/rocks
luafilesystem 1.6.3-2 is now built and installed in /usr/local (license: MIT/X11)

172-15-2-13:lua-5.1.4 mac$ sudo luarocks install lzlib
Warning: falling back to curl - install luasec to get native HTTPS support
Installing https://luarocks.org/lzlib-0.4.1.53-1.src.rock...
Using https://luarocks.org/lzlib-0.4.1.53-1.src.rock... switching to 'build' mode
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c lzlib.c -o lzlib.o -I/usr/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o zlib.so -L/usr/local/lib lzlib.o -L/usr/lib -Wl,-rpath,/usr/lib: -lz
Updating manifest for /usr/local/lib/luarocks/rocks
lzlib 0.4.1.53-1 is now built and installed in /usr/local (license: MIT/X11)

172-15-2-13:lua-5.1.4 mac$ sudo luarocks install md5
Warning: falling back to curl - install luasec to get native HTTPS support
Installing https://luarocks.org/md5-1.2-1.src.rock...
Using https://luarocks.org/md5-1.2-1.src.rock... switching to 'build' mode
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/compat-5.2.c -o src/compat-5.2.o -Isrc/
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/md5.c -o src/md5.o -Isrc/
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/md5lib.c -o src/md5lib.o -Isrc/
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o md5/core.so -L/usr/local/lib src/compat-5.2.o src/md5.o src/md5lib.o
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/compat-5.2.c -o src/compat-5.2.o -Isrc/
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/des56.c -o src/des56.o -Isrc/
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/ldes56.c -o src/ldes56.o -Isrc/
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o des56.so -L/usr/local/lib src/compat-5.2.o src/des56.o src/ldes56.o
Updating manifest for /usr/local/lib/luarocks/rocks
md5 1.2-1 is now built and installed in /usr/local (license: MIT/X11)

172-15-2-13:lua-5.1.4 mac$ sudo luarocks install luasec
Warning: falling back to curl - install luasec to get native HTTPS support
Installing https://luarocks.org/luasec-0.6-1.rockspec...
Using https://luarocks.org/luasec-0.6-1.rockspec... switching to 'build' mode
Cloning into 'luasec'...
remote: Counting objects: 116, done.
remote: Compressing objects: 100% (93/93), done.
remote: Total 116 (delta 33), reused 76 (delta 22), pack-reused 0
Receiving objects: 100% (116/116), 68.52 KiB | 25.00 KiB/s, done.
Resolving deltas: 100% (33/33), done.
Checking connectivity... done.
Note: checking out '20443861ebc3f6498ee7d9c70fbdaa059bec15e1'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -b with the checkout command again. Example:

  git checkout -b <new-branch-name>

env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/x509.c -o src/x509.o -I/usr/include -Isrc/ -Isrc/luasocket
src/x509.c:131:13: warning: 'OBJ_obj2txt' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
  int len = OBJ_obj2txt(buffer, sizeof(buffer), object, no_name);
            ^
/usr/include/openssl/objects.h:1011:5: note: 'OBJ_obj2txt' has been explicitly
      marked deprecated here
int     OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no...
        ^
src/x509.c:149:31: warning: 'ASN1_STRING_data' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
    lua_pushlstring(L, (char*)ASN1_STRING_data(string),
                              ^
/usr/include/openssl/asn1.h:801:17: note: 'ASN1_STRING_data' has been explicitly
      marked deprecated here
unsigned char * ASN1_STRING_data(ASN1_STRING *x) DEPRECATED_IN_MAC_OS_X_...
                ^
src/x509.c:150:24: warning: 'ASN1_STRING_length' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
                       ASN1_STRING_length(string));
                       ^
/usr/include/openssl/asn1.h:798:5: note: 'ASN1_STRING_length' has been
      explicitly marked deprecated here
int ASN1_STRING_length(ASN1_STRING *x) DEPRECATED_IN_MAC_OS_X_VERSION_10...
    ^
src/x509.c:153:11: warning: 'ASN1_STRING_to_UTF8' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    len = ASN1_STRING_to_UTF8(&data, string);
          ^
/usr/include/openssl/asn1.h:982:5: note: 'ASN1_STRING_to_UTF8' has been
      explicitly marked deprecated here
int ASN1_STRING_to_UTF8(unsigned char **out, ASN1_STRING *in) DEPRECATED...
    ^
src/x509.c:156:7: warning: 'CRYPTO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
      OPENSSL_free(data);
      ^
/usr/include/openssl/crypto.h:375:28: note: expanded from macro 'OPENSSL_free'
#define OPENSSL_free(addr)      CRYPTO_free(addr)
                                ^
/usr/include/openssl/crypto.h:480:6: note: 'CRYPTO_free' has been explicitly
      marked deprecated here
void CRYPTO_free(void *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/x509.c:170:14: warning: 'BIO_new' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *out = BIO_new(BIO_s_mem());
             ^
/usr/include/openssl/bio.h:591:7: note: 'BIO_new' has been explicitly marked
      deprecated here
BIO *   BIO_new(BIO_METHOD *type) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:170:22: warning: 'BIO_s_mem' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *out = BIO_new(BIO_s_mem());
                     ^
/usr/include/openssl/bio.h:626:13: note: 'BIO_s_mem' has been explicitly marked
      deprecated here
BIO_METHOD *BIO_s_mem(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
            ^
src/x509.c:171:3: warning: 'ASN1_TIME_print' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  ASN1_TIME_print(out, tm);
  ^
/usr/include/openssl/asn1.h:1009:5: note: 'ASN1_TIME_print' has been explicitly
      marked deprecated here
int ASN1_TIME_print(BIO *fp,ASN1_TIME *a) DEPRECATED_IN_MAC_OS_X_VERSION...
    ^
src/x509.c:172:10: warning: 'BIO_ctrl' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  size = BIO_get_mem_data(out, &tmp);
         ^
/usr/include/openssl/bio.h:504:32: note: expanded from macro 'BIO_get_mem_data'
#define BIO_get_mem_data(b,pp)  BIO_ctrl(b,BIO_CTRL_INFO,0,(char *)pp)
                                ^
/usr/include/openssl/bio.h:600:6: note: 'BIO_ctrl' has been explicitly marked
      deprecated here
long    BIO_ctrl(BIO *bp,int cmd,long larg,void *parg) DEPRECATED_IN_MAC...
        ^
src/x509.c:174:3: warning: 'BIO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO_free(out);
  ^
/usr/include/openssl/bio.h:593:5: note: 'BIO_free' has been explicitly marked
      deprecated here
int     BIO_free(BIO *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:185:23: warning: 'ASN1_STRING_data' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  unsigned char *ip = ASN1_STRING_data(string);
                      ^
/usr/include/openssl/asn1.h:801:17: note: 'ASN1_STRING_data' has been explicitly
      marked deprecated here
unsigned char * ASN1_STRING_data(ASN1_STRING *x) DEPRECATED_IN_MAC_OS_X_...
                ^
src/x509.c:186:10: warning: 'ASN1_STRING_length' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  switch(ASN1_STRING_length(string)) {
         ^
/usr/include/openssl/asn1.h:798:5: note: 'ASN1_STRING_length' has been
      explicitly marked deprecated here
int ASN1_STRING_length(ASN1_STRING *x) DEPRECATED_IN_MAC_OS_X_VERSION_10...
    ^
src/x509.c:233:15: warning: 'X509_NAME_entry_count' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  n_entries = X509_NAME_entry_count(name);
              ^
/usr/include/openssl/x509.h:1098:7: note: 'X509_NAME_entry_count' has been
      explicitly marked deprecated here
int             X509_NAME_entry_count(X509_NAME *name) DEPRECATED_IN_MAC...
                ^
src/x509.c:235:13: warning: 'X509_NAME_get_entry' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    entry = X509_NAME_get_entry(name, i);
            ^
/usr/include/openssl/x509.h:1109:18: note: 'X509_NAME_get_entry' has been
      explicitly marked deprecated here
X509_NAME_ENTRY *X509_NAME_get_entry(X509_NAME *name, int loc) DEPRECATE...
                 ^
src/x509.c:236:14: warning: 'X509_NAME_ENTRY_get_object' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    object = X509_NAME_ENTRY_get_object(entry);
             ^
/usr/include/openssl/x509.h:1130:15: note: 'X509_NAME_ENTRY_get_object' has been
      explicitly marked deprecated here
ASN1_OBJECT *   X509_NAME_ENTRY_get_object(X509_NAME_ENTRY *ne) DEPRECAT...
                ^
src/x509.c:242:25: warning: 'X509_NAME_ENTRY_get_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    push_asn1_string(L, X509_NAME_ENTRY_get_data(entry), encode);
                        ^
/usr/include/openssl/x509.h:1131:15: note: 'X509_NAME_ENTRY_get_data' has been
      explicitly marked deprecated here
ASN1_STRING *   X509_NAME_ENTRY_get_data(X509_NAME_ENTRY *ne) DEPRECATED...
                ^
src/x509.c:257:28: warning: 'X509_get_subject_name' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  return push_x509_name(L, X509_get_subject_name(px->cert), px->encode);
                           ^
/usr/include/openssl/x509.h:1014:13: note: 'X509_get_subject_name' has been
      explicitly marked deprecated here
X509_NAME *     X509_get_subject_name(X509 *a) DEPRECATED_IN_MAC_OS_X_VE...
                ^
src/x509.c:266:28: warning: 'X509_get_issuer_name' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  return push_x509_name(L, X509_get_issuer_name(px->cert), px->encode);
                           ^
/usr/include/openssl/x509.h:1012:13: note: 'X509_get_issuer_name' has been
      explicitly marked deprecated here
X509_NAME *     X509_get_issuer_name(X509 *a) DEPRECATED_IN_MAC_OS_X_VER...
                ^
src/x509.c:287:15: warning: 'X509_get_ext_by_NID' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  while ((i = X509_get_ext_by_NID(peer, NID_subject_alt_name, i)) != -1) {
              ^
/usr/include/openssl/x509.h:1146:6: note: 'X509_get_ext_by_NID' has been
      explicitly marked deprecated here
int             X509_get_ext_by_NID(X509 *x, int nid, int lastpos) DEPRE...
                ^
src/x509.c:288:17: warning: 'X509_get_ext' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
    extension = X509_get_ext(peer, i);
                ^
/usr/include/openssl/x509.h:1149:17: note: 'X509_get_ext' has been explicitly
      marked deprecated here
X509_EXTENSION *X509_get_ext(X509 *x, int loc) DEPRECATED_IN_MAC_OS_X_VE...
                ^
src/x509.c:291:14: warning: 'X509V3_EXT_d2i' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    values = X509V3_EXT_d2i(extension);
             ^
/usr/include/openssl/x509v3.h:585:7: note: 'X509V3_EXT_d2i' has been explicitly
      marked deprecated here
void *X509V3_EXT_d2i(X509_EXTENSION *ext) DEPRECATED_IN_MAC_OS_X_VERSION...
      ^
src/x509.c:303:23: warning: 'sk_num' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    n_general_names = sk_GENERAL_NAME_num(values);
                      ^
/usr/include/openssl/safestack.h:684:33: note: expanded from macro
      'sk_GENERAL_NAME_num'
#define sk_GENERAL_NAME_num(st) SKM_sk_num(GENERAL_NAME, (st))
                                ^
/usr/include/openssl/safestack.h:168:2: note: expanded from macro 'SKM_sk_num'
        sk_num(st)
        ^
/usr/include/openssl/stack.h:81:5: note: 'sk_num' has been explicitly marked
      deprecated here
int sk_num(const STACK *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/x509.c:305:22: warning: 'sk_value' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
      general_name = sk_GENERAL_NAME_value(values, j);
                     ^
/usr/include/openssl/safestack.h:685:38: note: expanded from macro
      'sk_GENERAL_NAME_value'
#define sk_GENERAL_NAME_value(st, i) SKM_sk_value(GENERAL_NAME, (st), (i))
                                     ^
/usr/include/openssl/safestack.h:170:11: note: expanded from macro
      'SKM_sk_value'
        ((type *)sk_value(st, i))
                 ^
/usr/include/openssl/stack.h:82:7: note: 'sk_value' has been explicitly marked
      deprecated here
char *sk_value(const STACK *, int) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
      ^
src/x509.c:378:14: warning: 'BIO_new' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
             ^
/usr/include/openssl/bio.h:591:7: note: 'BIO_new' has been explicitly marked
      deprecated here
BIO *   BIO_new(BIO_METHOD *type) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:378:22: warning: 'BIO_s_mem' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
                     ^
/usr/include/openssl/bio.h:626:13: note: 'BIO_s_mem' has been explicitly marked
      deprecated here
BIO_METHOD *BIO_s_mem(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
            ^
src/x509.c:383:11: warning: 'BIO_ctrl' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  bytes = BIO_get_mem_data(bio, &data);
          ^
/usr/include/openssl/bio.h:504:32: note: expanded from macro 'BIO_get_mem_data'
#define BIO_get_mem_data(b,pp)  BIO_ctrl(b,BIO_CTRL_INFO,0,(char *)pp)
                                ^
/usr/include/openssl/bio.h:600:6: note: 'BIO_ctrl' has been explicitly marked
      deprecated here
long    BIO_ctrl(BIO *bp,int cmd,long larg,void *parg) DEPRECATED_IN_MAC...
        ^
src/x509.c:388:3: warning: 'BIO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO_free(bio);
  ^
/usr/include/openssl/bio.h:593:5: note: 'BIO_free' has been explicitly marked
      deprecated here
int     BIO_free(BIO *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:401:14: warning: 'BIO_new' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
             ^
/usr/include/openssl/bio.h:591:7: note: 'BIO_new' has been explicitly marked
      deprecated here
BIO *   BIO_new(BIO_METHOD *type) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:401:22: warning: 'BIO_s_mem' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
                     ^
/usr/include/openssl/bio.h:626:13: note: 'BIO_s_mem' has been explicitly marked
      deprecated here
BIO_METHOD *BIO_s_mem(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
            ^
src/x509.c:402:20: warning: 'X509_get_pubkey' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  EVP_PKEY *pkey = X509_get_pubkey(cert);
                   ^
/usr/include/openssl/x509.h:1018:12: note: 'X509_get_pubkey' has been explicitly
      marked deprecated here
EVP_PKEY *      X509_get_pubkey(X509 *x) DEPRECATED_IN_MAC_OS_X_VERSION_...
                ^
src/x509.c:404:13: warning: 'BIO_ctrl' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    bytes = BIO_get_mem_data(bio, &data);
            ^
/usr/include/openssl/bio.h:504:32: note: expanded from macro 'BIO_get_mem_data'
#define BIO_get_mem_data(b,pp)  BIO_ctrl(b,BIO_CTRL_INFO,0,(char *)pp)
                                ^
/usr/include/openssl/bio.h:600:6: note: 'BIO_ctrl' has been explicitly marked
      deprecated here
long    BIO_ctrl(BIO *bp,int cmd,long larg,void *parg) DEPRECATED_IN_MAC...
        ^
src/x509.c:407:14: warning: 'EVP_PKEY_type' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      switch(EVP_PKEY_type(pkey->type)) {
             ^
/usr/include/openssl/evp.h:851:6: note: 'EVP_PKEY_type' has been explicitly
      marked deprecated here
int             EVP_PKEY_type(int type) DEPRECATED_IN_MAC_OS_X_VERSION_1...
                ^
src/x509.c:424:26: warning: 'EVP_PKEY_bits' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      lua_pushinteger(L, EVP_PKEY_bits(pkey));
                         ^
/usr/include/openssl/evp.h:852:6: note: 'EVP_PKEY_bits' has been explicitly
      marked deprecated here
int             EVP_PKEY_bits(EVP_PKEY *pkey) DEPRECATED_IN_MAC_OS_X_VER...
                ^
src/x509.c:433:3: warning: 'BIO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO_free(bio);
  ^
/usr/include/openssl/bio.h:593:5: note: 'BIO_free' has been explicitly marked
      deprecated here
int     BIO_free(BIO *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:434:3: warning: 'EVP_PKEY_free' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
  EVP_PKEY_free(pkey);
  ^
/usr/include/openssl/evp.h:878:7: note: 'EVP_PKEY_free' has been explicitly
      marked deprecated here
void            EVP_PKEY_free(EVP_PKEY *pkey) DEPRECATED_IN_MAC_OS_X_VER...
                ^
src/x509.c:450:14: warning: 'EVP_sha1' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    digest = EVP_sha1();
             ^
/usr/include/openssl/evp.h:666:15: note: 'EVP_sha1' has been explicitly marked
      deprecated here
const EVP_MD *EVP_sha1(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/x509.c:453:16: warning: 'EVP_sha1' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
      digest = EVP_sha1();
               ^
/usr/include/openssl/evp.h:666:15: note: 'EVP_sha1' has been explicitly marked
      deprecated here
const EVP_MD *EVP_sha1(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/x509.c:455:16: warning: 'EVP_sha256' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
      digest = EVP_sha256();
               ^
/usr/include/openssl/evp.h:673:15: note: 'EVP_sha256' has been explicitly marked
      deprecated here
const EVP_MD *EVP_sha256(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/x509.c:457:16: warning: 'EVP_sha512' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
      digest = EVP_sha512();
               ^
/usr/include/openssl/evp.h:677:15: note: 'EVP_sha512' has been explicitly marked
      deprecated here
const EVP_MD *EVP_sha512(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/x509.c:464:8: warning: 'X509_digest' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  if (!X509_digest(cert, digest, buffer, &bytes)) {
       ^
/usr/include/openssl/x509.h:778:5: note: 'X509_digest' has been explicitly
      marked deprecated here
int X509_digest(const X509 *data,const EVP_MD *type,
    ^
src/x509.c:467:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/x509.c:467:31: warning: 'ERR_get_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/x509.c:482:23: warning: 'X509_cmp_time' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  lua_pushboolean(L, (X509_cmp_time(X509_get_notAfter(cert), &time)     >= 0
                      ^
/usr/include/openssl/x509.h:882:6: note: 'X509_cmp_time' has been explicitly
      marked deprecated here
int             X509_cmp_time(ASN1_TIME *s, time_t *t) DEPRECATED_IN_MAC...
                ^
src/x509.c:483:26: warning: 'X509_cmp_time' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
                      && X509_cmp_time(X509_get_notBefore(cert), &time) <= 0));
                         ^
/usr/include/openssl/x509.h:882:6: note: 'X509_cmp_time' has been explicitly
      marked deprecated here
int             X509_cmp_time(ASN1_TIME *s, time_t *t) DEPRECATED_IN_MAC...
                ^
src/x509.c:496:12: warning: 'X509_get_serialNumber' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  serial = X509_get_serialNumber(cert);
           ^
/usr/include/openssl/x509.h:1010:16: note: 'X509_get_serialNumber' has been
      explicitly marked deprecated here
ASN1_INTEGER *  X509_get_serialNumber(X509 *x) DEPRECATED_IN_MAC_OS_X_VE...
                ^
src/x509.c:497:8: warning: 'ASN1_INTEGER_to_BN' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  bn = ASN1_INTEGER_to_BN(serial, NULL);
       ^
/usr/include/openssl/asn1.h:902:9: note: 'ASN1_INTEGER_to_BN' has been
      explicitly marked deprecated here
BIGNUM *ASN1_INTEGER_to_BN(ASN1_INTEGER *ai,BIGNUM *bn) DEPRECATED_IN_MA...
        ^
src/x509.c:498:9: warning: 'BN_bn2hex' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  tmp = BN_bn2hex(bn);
        ^
/usr/include/openssl/bn.h:505:8: note: 'BN_bn2hex' has been explicitly marked
      deprecated here
char *  BN_bn2hex(const BIGNUM *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
        ^
src/x509.c:500:3: warning: 'BN_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BN_free(bn);
  ^
/usr/include/openssl/bn.h:468:6: note: 'BN_free' has been explicitly marked
      deprecated here
void    BN_free(BIGNUM *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:501:3: warning: 'CRYPTO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  OPENSSL_free(tmp);
  ^
/usr/include/openssl/crypto.h:375:28: note: expanded from macro 'OPENSSL_free'
#define OPENSSL_free(addr)      CRYPTO_free(addr)
                                ^
/usr/include/openssl/crypto.h:480:6: note: 'CRYPTO_free' has been explicitly
      marked deprecated here
void CRYPTO_free(void *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/x509.c:548:11: warning: 'sk_new_null' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
  chain = sk_X509_new_null();
          ^
/usr/include/openssl/safestack.h:1386:28: note: expanded from macro
      'sk_X509_new_null'
#define sk_X509_new_null() SKM_sk_new_null(X509)
                           ^
/usr/include/openssl/safestack.h:164:2: note: expanded from macro
      'SKM_sk_new_null'
        sk_new_null()
        ^
/usr/include/openssl/stack.h:87:8: note: 'sk_new_null' has been explicitly
      marked deprecated here
STACK *sk_new_null(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
       ^
src/x509.c:549:9: warning: 'X509_STORE_CTX_new' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  ctx = X509_STORE_CTX_new();
        ^
/usr/include/openssl/x509_vfy.h:397:17: note: 'X509_STORE_CTX_new' has been
      explicitly marked deprecated here
X509_STORE_CTX *X509_STORE_CTX_new(void) DEPRECATED_IN_MAC_OS_X_VERSION_...
                ^
src/x509.c:550:10: warning: 'X509_STORE_new' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  root = X509_STORE_new();
         ^
/usr/include/openssl/x509_vfy.h:389:13: note: 'X509_STORE_new' has been
      explicitly marked deprecated here
X509_STORE *X509_STORE_new(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
            ^
src/x509.c:559:9: warning: 'X509_STORE_add_cert' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  ret = X509_STORE_add_cert(root, issuer);
        ^
/usr/include/openssl/x509_vfy.h:412:5: note: 'X509_STORE_add_cert' has been
      explicitly marked deprecated here
int X509_STORE_add_cert(X509_STORE *ctx, X509 *x) DEPRECATED_IN_MAC_OS_X...
    ^
src/x509.c:570:5: warning: 'sk_push' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    sk_X509_push(chain, cert);
    ^
/usr/include/openssl/safestack.h:1392:31: note: expanded from macro
      'sk_X509_push'
#define sk_X509_push(st, val) SKM_sk_push(X509, (st), (val))
                              ^
/usr/include/openssl/safestack.h:176:2: note: expanded from macro 'SKM_sk_push'
        sk_push(st, (char *)val)
        ^
/usr/include/openssl/stack.h:95:5: note: 'sk_push' has been explicitly marked
      deprecated here
int sk_push(STACK *st,char *data) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/x509.c:573:9: warning: 'X509_STORE_CTX_init' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  ret = X509_STORE_CTX_init(ctx, root, subject, chain);
        ^
/usr/include/openssl/x509_vfy.h:402:5: note: 'X509_STORE_CTX_init' has been
      explicitly marked deprecated here
int X509_STORE_CTX_init(X509_STORE_CTX *ctx, X509_STORE *store,
    ^
src/x509.c:583:7: warning: 'X509_verify_cert' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if (X509_verify_cert(ctx) <= 0) {
      ^
/usr/include/openssl/x509.h:1242:6: note: 'X509_verify_cert' has been explicitly
      marked deprecated here
int             X509_verify_cert(X509_STORE_CTX *ctx) DEPRECATED_IN_MAC_...
                ^
src/x509.c:584:11: warning: 'X509_STORE_CTX_get_error' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    ret = X509_STORE_CTX_get_error(ctx);
          ^
/usr/include/openssl/x509_vfy.h:451:5: note: 'X509_STORE_CTX_get_error' has been
      explicitly marked deprecated here
int     X509_STORE_CTX_get_error(X509_STORE_CTX *ctx) DEPRECATED_IN_MAC_...
        ^
src/x509.c:586:23: warning: 'X509_verify_cert_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    lua_pushstring(L, X509_verify_cert_error_string(ret));
                      ^
/usr/include/openssl/x509.h:752:13: note: 'X509_verify_cert_error_string' has
      been explicitly marked deprecated here
const char *X509_verify_cert_error_string(long n) DEPRECATED_IN_MAC_OS_X...
            ^
src/x509.c:596:5: warning: 'X509_STORE_CTX_free' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
    X509_STORE_CTX_free(ctx);
    ^
/usr/include/openssl/x509_vfy.h:401:6: note: 'X509_STORE_CTX_free' has been
      explicitly marked deprecated here
void X509_STORE_CTX_free(X509_STORE_CTX *ctx) DEPRECATED_IN_MAC_OS_X_VER...
     ^
src/x509.c:600:5: warning: 'X509_STORE_free' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    X509_STORE_free(root);
    ^
/usr/include/openssl/x509_vfy.h:390:6: note: 'X509_STORE_free' has been
      explicitly marked deprecated here
void X509_STORE_free(X509_STORE *v) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_...
     ^
src/x509.c:603:3: warning: 'sk_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  sk_X509_free(chain);
  ^
/usr/include/openssl/safestack.h:1387:26: note: expanded from macro
      'sk_X509_free'
#define sk_X509_free(st) SKM_sk_free(X509, (st))
                         ^
/usr/include/openssl/safestack.h:166:2: note: expanded from macro 'SKM_sk_free'
        sk_free(st)
        ^
/usr/include/openssl/stack.h:88:6: note: 'sk_free' has been explicitly marked
      deprecated here
void sk_free(STACK *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/x509.c:650:14: warning: 'BIO_new' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
             ^
/usr/include/openssl/bio.h:591:7: note: 'BIO_new' has been explicitly marked
      deprecated here
BIO *   BIO_new(BIO_METHOD *type) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:650:22: warning: 'BIO_s_mem' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
                     ^
/usr/include/openssl/bio.h:626:13: note: 'BIO_s_mem' has been explicitly marked
      deprecated here
BIO_METHOD *BIO_s_mem(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
            ^
src/x509.c:652:3: warning: 'BIO_write' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO_write(bio, data, bytes);
  ^
/usr/include/openssl/bio.h:597:5: note: 'BIO_write' has been explicitly marked
      deprecated here
int     BIO_write(BIO *b, const void *data, int len) DEPRECATED_IN_MAC_O...
        ^
src/x509.c:658:3: warning: 'BIO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO_free(bio);
  ^
/usr/include/openssl/bio.h:593:5: note: 'BIO_free' has been explicitly marked
      deprecated here
int     BIO_free(BIO *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
65 warnings generated.
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/context.c -o src/context.o -I/usr/include -Isrc/ -Isrc/luasocket
src/context.c:99:42: warning: 'SSLv23_method' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if (!strcmp(method, "any"))     return SSLv23_method();
                                         ^
/usr/include/openssl/ssl.h:1531:13: note: 'SSLv23_method' has been explicitly
      marked deprecated here
SSL_METHOD *SSLv23_method(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_...
            ^
src/context.c:100:42: warning: 'SSLv23_method' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  if (!strcmp(method, "sslv23"))  return SSLv23_method();  // deprecated
                                         ^
/usr/include/openssl/ssl.h:1531:13: note: 'SSLv23_method' has been explicitly
      marked deprecated here
SSL_METHOD *SSLv23_method(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_...
            ^
src/context.c:102:42: warning: 'SSLv3_method' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if (!strcmp(method, "sslv3"))   return SSLv3_method();
                                         ^
/usr/include/openssl/ssl.h:1527:13: note: 'SSLv3_method' has been explicitly
      marked deprecated here
SSL_METHOD *SSLv3_method(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_L...
            ^
src/context.c:104:42: warning: 'TLSv1_method' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if (!strcmp(method, "tlsv1"))   return TLSv1_method();
                                         ^
/usr/include/openssl/ssl.h:1535:13: note: 'TLSv1_method' has been explicitly
      marked deprecated here
SSL_METHOD *TLSv1_method(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_L...
            ^
src/context.c:184:21: warning: 'X509_verify_cert_error_string' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
  lua_pushstring(L, X509_verify_cert_error_string(err));
                    ^
/usr/include/openssl/x509.h:752:13: note: 'X509_verify_cert_error_string' has
      been explicitly marked deprecated here
const char *X509_verify_cert_error_string(long n) DEPRECATED_IN_MAC_OS_X...
            ^
src/context.c:198:18: warning: 'SSL_get_SSL_CTX' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX *ctx = SSL_get_SSL_CTX(ssl);
                 ^
/usr/include/openssl/ssl.h:1592:10: note: 'SSL_get_SSL_CTX' has been explicitly
      marked deprecated here
SSL_CTX *SSL_get_SSL_CTX(const SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSION_...
         ^
src/context.c:199:31: warning: 'SSL_CTX_get_ex_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  p_context pctx = (p_context)SSL_CTX_get_app_data(ctx);
                              ^
/usr/include/openssl/ssl.h:1092:36: note: expanded from macro
      'SSL_CTX_get_app_data'
#define SSL_CTX_get_app_data(ctx)       (SSL_CTX_get_ex_data(ctx,0))
                                         ^
/usr/include/openssl/ssl.h:1613:7: note: 'SSL_CTX_get_ex_data' has been
      explicitly marked deprecated here
void *SSL_CTX_get_ex_data(const SSL_CTX *ssl,int idx) DEPRECATED_IN_MAC_...
      ^
src/context.c:218:9: warning: 'BIO_new_mem_buf' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  bio = BIO_new_mem_buf((void*)lua_tostring(L, -1), 
        ^
/usr/include/openssl/bio.h:627:6: note: 'BIO_new_mem_buf' has been explicitly
      marked deprecated here
BIO *BIO_new_mem_buf(void *buf, int len) DEPRECATED_IN_MAC_OS_X_VERSION_...
     ^
src/context.c:222:5: warning: 'BIO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    BIO_free(bio);
    ^
/usr/include/openssl/bio.h:593:5: note: 'BIO_free' has been explicitly marked
      deprecated here
int     BIO_free(BIO *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/context.c:231:5: warning: 'DH_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    DH_free(pctx->dh_param);
    ^
/usr/include/openssl/dh.h:185:6: note: 'DH_free' has been explicitly marked
      deprecated here
void    DH_free(DH *dh) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/context.c:246:31: warning: 'SSL_CTX_get_ex_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  p_context pctx = (p_context)SSL_CTX_get_app_data(ctx);
                              ^
/usr/include/openssl/ssl.h:1092:36: note: expanded from macro
      'SSL_CTX_get_app_data'
#define SSL_CTX_get_app_data(ctx)       (SSL_CTX_get_ex_data(ctx,0))
                                         ^
/usr/include/openssl/ssl.h:1613:7: note: 'SSL_CTX_get_ex_data' has been
      explicitly marked deprecated here
void *SSL_CTX_get_ex_data(const SSL_CTX *ssl,int idx) DEPRECATED_IN_MAC_...
      ^
src/context.c:260:32: warning: 'X509_STORE_CTX_get0_param' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    X509_VERIFY_PARAM *param = X509_STORE_CTX_get0_param(x509_ctx);
                               ^
/usr/include/openssl/x509_vfy.h:473:20: note: 'X509_STORE_CTX_get0_param' has
      been explicitly marked deprecated here
X509_VERIFY_PARAM *X509_STORE_CTX_get0_param(X509_STORE_CTX *ctx) DEPREC...
                   ^
src/context.c:262:7: warning: 'X509_VERIFY_PARAM_set_purpose' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
      X509_VERIFY_PARAM_set_purpose(param, X509_PURPOSE_SSL_SERVER);
      ^
/usr/include/openssl/x509_vfy.h:490:5: note: 'X509_VERIFY_PARAM_set_purpose' has
      been explicitly marked deprecated here
int X509_VERIFY_PARAM_set_purpose(X509_VERIFY_PARAM *param, int purpose...
    ^
src/context.c:263:7: warning: 'X509_VERIFY_PARAM_set_trust' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      X509_VERIFY_PARAM_set_trust(param, X509_TRUST_SSL_SERVER);
      ^
/usr/include/openssl/x509_vfy.h:491:5: note: 'X509_VERIFY_PARAM_set_trust' has
      been explicitly marked deprecated here
int X509_VERIFY_PARAM_set_trust(X509_VERIFY_PARAM *param, int trust) DEP...
    ^
src/context.c:267:10: warning: 'X509_verify_cert' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  return X509_verify_cert(x509_ctx);
         ^
/usr/include/openssl/x509.h:1242:6: note: 'X509_verify_cert' has been explicitly
      marked deprecated here
int             X509_verify_cert(X509_STORE_CTX *ctx) DEPRECATED_IN_MAC_...
                ^
src/context.c:286:9: warning: 'X509_STORE_CTX_get_ex_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  ssl = X509_STORE_CTX_get_ex_data(x509_ctx,
        ^
/usr/include/openssl/x509_vfy.h:450:8: note: 'X509_STORE_CTX_get_ex_data' has
      been explicitly marked deprecated here
void *  X509_STORE_CTX_get_ex_data(X509_STORE_CTX *ctx,int idx) DEPRECAT...
        ^
src/context.c:287:5: warning: 'SSL_get_ex_data_X509_STORE_CTX_idx' is
      deprecated: first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_get_ex_data_X509_STORE_CTX_idx());
    ^
/usr/include/openssl/ssl.h:1617:5: note: 'SSL_get_ex_data_X509_STORE_CTX_idx'
      has been explicitly marked deprecated here
int SSL_get_ex_data_X509_STORE_CTX_idx(void ) DEPRECATED_IN_MAC_OS_X_VER...
    ^
src/context.c:288:9: warning: 'SSL_get_SSL_CTX' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  ctx = SSL_get_SSL_CTX(ssl);
        ^
/usr/include/openssl/ssl.h:1592:10: note: 'SSL_get_SSL_CTX' has been explicitly
      marked deprecated here
SSL_CTX *SSL_get_SSL_CTX(const SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSION_...
         ^
src/context.c:289:21: warning: 'SSL_CTX_get_ex_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  pctx = (p_context)SSL_CTX_get_app_data(ctx);
                    ^
/usr/include/openssl/ssl.h:1092:36: note: expanded from macro
      'SSL_CTX_get_app_data'
#define SSL_CTX_get_app_data(ctx)       (SSL_CTX_get_ex_data(ctx,0))
                                         ^
/usr/include/openssl/ssl.h:1613:7: note: 'SSL_CTX_get_ex_data' has been
      explicitly marked deprecated here
void *SSL_CTX_get_ex_data(const SSL_CTX *ssl,int idx) DEPRECATED_IN_MAC_...
      ^
src/context.c:300:9: warning: 'X509_STORE_CTX_get_error' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  err = X509_STORE_CTX_get_error(x509_ctx);
        ^
/usr/include/openssl/x509_vfy.h:451:5: note: 'X509_STORE_CTX_get_error' has been
      explicitly marked deprecated here
int     X509_STORE_CTX_get_error(X509_STORE_CTX *ctx) DEPRECATED_IN_MAC_...
        ^
src/context.c:302:33: warning: 'X509_STORE_CTX_get_error_depth' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    add_cert_error(L, ssl, err, X509_STORE_CTX_get_error_depth(x509_ctx));
                                ^
/usr/include/openssl/x509_vfy.h:453:5: note: 'X509_STORE_CTX_get_error_depth'
      has been explicitly marked deprecated here
int     X509_STORE_CTX_get_error_depth(X509_STORE_CTX *ctx) DEPRECATED_I...
        ^
src/context.c:313:14: warning: 'EC_KEY_new_by_curve_name' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      return EC_KEY_new_by_curve_name(ptr->nid);
             ^
/usr/include/openssl/ec.h:306:9: note: 'EC_KEY_new_by_curve_name' has been
      explicitly marked deprecated here
EC_KEY *EC_KEY_new_by_curve_name(int nid) DEPRECATED_IN_MAC_OS_X_VERSION...
        ^
src/context.c:344:18: warning: 'SSL_CTX_new' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  ctx->context = SSL_CTX_new(method);
                 ^
/usr/include/openssl/ssl.h:1362:10: note: 'SSL_CTX_new' has been explicitly
      marked deprecated here
SSL_CTX *SSL_CTX_new(SSL_METHOD *meth) DEPRECATED_IN_MAC_OS_X_VERSION_10...
         ^
src/context.c:348:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:348:31: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:357:3: warning: 'SSL_CTX_ctrl' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX_set_session_cache_mode(ctx->context, SSL_SESS_CACHE_OFF);
  ^
/usr/include/openssl/ssl.h:1624:2: note: expanded from macro
      'SSL_CTX_set_session_cache_mode'
        SSL_CTX_ctrl(ctx,SSL_CTRL_SET_SESS_CACHE_MODE,m,NULL)
        ^
/usr/include/openssl/ssl.h:1514:6: note: 'SSL_CTX_ctrl' has been explicitly
      marked deprecated here
long    SSL_CTX_ctrl(SSL_CTX *ctx,int cmd, long larg, void *parg) DEPREC...
        ^
src/context.c:359:3: warning: 'SSL_CTX_set_ex_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX_set_app_data(ctx->context, ctx);
  ^
/usr/include/openssl/ssl.h:1093:40: note: expanded from macro
      'SSL_CTX_set_app_data'
#define SSL_CTX_set_app_data(ctx,arg)   (SSL_CTX_set_ex_data(ctx,0,(char *)arg))
                                         ^
/usr/include/openssl/ssl.h:1612:5: note: 'SSL_CTX_set_ex_data' has been
      explicitly marked deprecated here
int SSL_CTX_set_ex_data(SSL_CTX *ssl,int idx,void *data) DEPRECATED_IN_M...
    ^
src/context.c:372:7: warning: 'SSL_CTX_load_verify_locations' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
  if (SSL_CTX_load_verify_locations(ctx, cafile, capath) != 1) {
      ^
/usr/include/openssl/ssl.h:1587:5: note: 'SSL_CTX_load_verify_locations' has
      been explicitly marked deprecated here
int SSL_CTX_load_verify_locations(SSL_CTX *ctx, const char *CAfile,
    ^
src/context.c:375:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:375:31: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:389:7: warning: 'SSL_CTX_use_certificate_chain_file' is
      deprecated: first deprecated in OS X 10.7 [-Wdeprecated-declarations]
  if (SSL_CTX_use_certificate_chain_file(ctx, filename) != 1) {
      ^
/usr/include/openssl/ssl.h:1419:5: note: 'SSL_CTX_use_certificate_chain_file'
      has been explicitly marked deprecated here
int     SSL_CTX_use_certificate_chain_file(SSL_CTX *ctx, const char *fil...
        ^
src/context.c:392:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:392:31: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:410:5: warning: 'SSL_CTX_set_default_passwd_cb' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_default_passwd_cb(ctx, passwd_cb);
    ^
/usr/include/openssl/ssl.h:1488:6: note: 'SSL_CTX_set_default_passwd_cb' has
      been explicitly marked deprecated here
void SSL_CTX_set_default_passwd_cb(SSL_CTX *ctx, pem_password_cb *cb) DE...
     ^
src/context.c:411:5: warning: 'SSL_CTX_set_default_passwd_cb_userdata' is
      deprecated: first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_default_passwd_cb_userdata(ctx, L);
    ^
/usr/include/openssl/ssl.h:1489:6: note: 
      'SSL_CTX_set_default_passwd_cb_userdata' has been explicitly marked
      deprecated here
void SSL_CTX_set_default_passwd_cb_userdata(SSL_CTX *ctx, void *u) DEPRE...
     ^
src/context.c:414:9: warning: 'SSL_CTX_use_PrivateKey_file' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    if (SSL_CTX_use_PrivateKey_file(ctx, filename, SSL_FILETYPE_PEM) == 1)
        ^
/usr/include/openssl/ssl.h:1417:5: note: 'SSL_CTX_use_PrivateKey_file' has been
      explicitly marked deprecated here
int     SSL_CTX_use_PrivateKey_file(SSL_CTX *ctx, const char *file, int ...
        ^
src/context.c:420:9: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
        ERR_reason_error_string(ERR_get_error()));
        ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:420:33: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
        ERR_reason_error_string(ERR_get_error()));
                                ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:422:5: warning: 'SSL_CTX_set_default_passwd_cb' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_default_passwd_cb(ctx, NULL);
    ^
/usr/include/openssl/ssl.h:1488:6: note: 'SSL_CTX_set_default_passwd_cb' has
      been explicitly marked deprecated here
void SSL_CTX_set_default_passwd_cb(SSL_CTX *ctx, pem_password_cb *cb) DE...
     ^
src/context.c:423:5: warning: 'SSL_CTX_set_default_passwd_cb_userdata' is
      deprecated: first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_default_passwd_cb_userdata(ctx, NULL);
    ^
/usr/include/openssl/ssl.h:1489:6: note: 
      'SSL_CTX_set_default_passwd_cb_userdata' has been explicitly marked
      deprecated here
void SSL_CTX_set_default_passwd_cb_userdata(SSL_CTX *ctx, void *u) DEPRE...
     ^
src/context.c:439:22: warning: 'SSL_CTX_check_private_key' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  lua_pushboolean(L, SSL_CTX_check_private_key(ctx));
                     ^
/usr/include/openssl/ssl.h:1491:5: note: 'SSL_CTX_check_private_key' has been
      explicitly marked deprecated here
int SSL_CTX_check_private_key(const SSL_CTX *ctx) DEPRECATED_IN_MAC_OS_X...
    ^
src/context.c:450:7: warning: 'SSL_CTX_set_cipher_list' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  if (SSL_CTX_set_cipher_list(ctx, list) != 1) {
      ^
/usr/include/openssl/ssl.h:1361:5: note: 'SSL_CTX_set_cipher_list' has been
      explicitly marked deprecated here
int     SSL_CTX_set_cipher_list(SSL_CTX *,const char *str) DEPRECATED_IN...
        ^
src/context.c:453:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:453:31: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:466:3: warning: 'SSL_CTX_set_verify_depth' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX_set_verify_depth(ctx, (int)luaL_checkinteger(L, 2));
  ^
/usr/include/openssl/ssl.h:1476:6: note: 'SSL_CTX_set_verify_depth' has been
      explicitly marked deprecated here
void SSL_CTX_set_verify_depth(SSL_CTX *ctx,int depth) DEPRECATED_IN_MAC_...
     ^
src/context.c:489:13: warning: 'SSL_CTX_set_verify' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  if (flag) SSL_CTX_set_verify(ctx, flag, NULL);
            ^
/usr/include/openssl/ssl.h:1474:6: note: 'SSL_CTX_set_verify' has been
      explicitly marked deprecated here
void SSL_CTX_set_verify(SSL_CTX *ctx,int mode,
     ^
src/context.c:520:5: warning: 'SSL_CTX_ctrl' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_options(ctx, flag);
    ^
/usr/include/openssl/ssl.h:582:2: note: expanded from macro
      'SSL_CTX_set_options'
        SSL_CTX_ctrl((ctx),SSL_CTRL_OPTIONS,(op),NULL)
        ^
/usr/include/openssl/ssl.h:1514:6: note: 'SSL_CTX_ctrl' has been explicitly
      marked deprecated here
long    SSL_CTX_ctrl(SSL_CTX *ctx,int cmd, long larg, void *parg) DEPREC...
        ^
src/context.c:554:3: warning: 'SSL_CTX_set_tmp_dh_callback' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX_set_tmp_dh_callback(ctx, dhparam_cb);
  ^
/usr/include/openssl/ssl.h:1654:6: note: 'SSL_CTX_set_tmp_dh_callback' has been
      explicitly marked deprecated here
void SSL_CTX_set_tmp_dh_callback(SSL_CTX *ctx,
     ^
src/context.c:589:9: warning: 'SSL_CTX_ctrl' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  ret = SSL_CTX_set_tmp_ecdh(ctx, key);
        ^
/usr/include/openssl/ssl.h:1337:2: note: expanded from macro
      'SSL_CTX_set_tmp_ecdh'
        SSL_CTX_ctrl(ctx,SSL_CTRL_SET_TMP_ECDH,0,(char *)ecdh)
        ^
/usr/include/openssl/ssl.h:1514:6: note: 'SSL_CTX_ctrl' has been explicitly
      marked deprecated here
long    SSL_CTX_ctrl(SSL_CTX *ctx,int cmd, long larg, void *parg) DEPREC...
        ^
src/context.c:591:3: warning: 'EC_KEY_free' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  EC_KEY_free(key);
  ^
/usr/include/openssl/ec.h:307:6: note: 'EC_KEY_free' has been explicitly marked
      deprecated here
void EC_KEY_free(EC_KEY *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/context.c:596:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:596:31: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:642:5: warning: 'SSL_CTX_free' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_free(ctx->context);
    ^
/usr/include/openssl/ssl.h:1363:6: note: 'SSL_CTX_free' has been explicitly
      marked deprecated here
void    SSL_CTX_free(SSL_CTX *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/context.c:646:5: warning: 'DH_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    DH_free(ctx->dh_param);
    ^
/usr/include/openssl/dh.h:185:6: note: 'DH_free' has been explicitly marked
      deprecated here
void    DH_free(DH *dh) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/context.c:692:5: warning: 'SSL_CTX_set_verify' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_verify(ctx, SSL_CTX_get_verify_mode(ctx), verify_cb);
    ^
/usr/include/openssl/ssl.h:1474:6: note: 'SSL_CTX_set_verify' has been
      explicitly marked deprecated here
void SSL_CTX_set_verify(SSL_CTX *ctx,int mode,
     ^
src/context.c:692:29: warning: 'SSL_CTX_get_verify_mode' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_verify(ctx, SSL_CTX_get_verify_mode(ctx), verify_cb);
                            ^
/usr/include/openssl/ssl.h:1471:5: note: 'SSL_CTX_get_verify_mode' has been
      explicitly marked deprecated here
int SSL_CTX_get_verify_mode(const SSL_CTX *ctx) DEPRECATED_IN_MAC_OS_X_V...
    ^
src/context.c:693:5: warning: 'SSL_CTX_set_cert_verify_callback' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_cert_verify_callback(ctx, cert_verify_cb, (void*)ctx);
    ^
/usr/include/openssl/ssl.h:1477:6: note: 'SSL_CTX_set_cert_verify_callback' has
      been explicitly marked deprecated here
void SSL_CTX_set_cert_verify_callback(SSL_CTX *ctx, int (*cb)(X509_STORE...
     ^
src/context.c:700:5: warning: 'SSL_CTX_set_verify' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_verify(ctx, SSL_CTX_get_verify_mode(ctx), NULL);
    ^
/usr/include/openssl/ssl.h:1474:6: note: 'SSL_CTX_set_verify' has been
      explicitly marked deprecated here
void SSL_CTX_set_verify(SSL_CTX *ctx,int mode,
     ^
src/context.c:700:29: warning: 'SSL_CTX_get_verify_mode' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_verify(ctx, SSL_CTX_get_verify_mode(ctx), NULL);
                            ^
/usr/include/openssl/ssl.h:1471:5: note: 'SSL_CTX_get_verify_mode' has been
      explicitly marked deprecated here
int SSL_CTX_get_verify_mode(const SSL_CTX *ctx) DEPRECATED_IN_MAC_OS_X_V...
    ^
src/context.c:701:5: warning: 'SSL_CTX_set_cert_verify_callback' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_cert_verify_callback(ctx, NULL, NULL);
    ^
/usr/include/openssl/ssl.h:1477:6: note: 'SSL_CTX_set_cert_verify_callback' has
      been explicitly marked deprecated here
void SSL_CTX_set_cert_verify_callback(SSL_CTX *ctx, int (*cb)(X509_STORE...
     ^
src/context.c:710:3: warning: 'X509_STORE_set_flags' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  X509_STORE_set_flags(SSL_CTX_get_cert_store(ctx), crl_flag);
  ^
/usr/include/openssl/x509_vfy.h:392:5: note: 'X509_STORE_set_flags' has been
      explicitly marked deprecated here
int X509_STORE_set_flags(X509_STORE *ctx, unsigned long flags) DEPRECATE...
    ^
src/context.c:710:24: warning: 'SSL_CTX_get_cert_store' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  X509_STORE_set_flags(SSL_CTX_get_cert_store(ctx), crl_flag);
                       ^
/usr/include/openssl/ssl.h:1366:13: note: 'SSL_CTX_get_cert_store' has been
      explicitly marked deprecated here
X509_STORE *SSL_CTX_get_cert_store(const SSL_CTX *) DEPRECATED_IN_MAC_OS...
            ^
62 warnings generated.
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/ssl.c -o src/ssl.o -I/usr/include -Isrc/ -Isrc/luasocket
src/ssl.c:62:32: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    case SSL_ERROR_SSL: return ERR_reason_error_string(ERR_get_error());
                               ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/ssl.c:62:56: warning: 'ERR_get_error' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
    case SSL_ERROR_SSL: return ERR_reason_error_string(ERR_get_error());
                                                       ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/ssl.c:77:5: warning: 'SSL_shutdown' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    SSL_shutdown(ssl->ssl);
    ^
/usr/include/openssl/ssl.h:1548:5: note: 'SSL_shutdown' has been explicitly
      marked deprecated here
int SSL_shutdown(SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:94:5: warning: 'SSL_free' is deprecated: first deprecated in OS X 10.7
      [-Wdeprecated-declarations]
    SSL_free(ssl->ssl);
    ^
/usr/include/openssl/ssl.h:1506:6: note: 'SSL_free' has been explicitly marked
      deprecated here
void    SSL_free(SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/ssl.c:110:5: warning: 'ERR_clear_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    ERR_clear_error();
    ^
/usr/include/openssl/err.h:278:6: note: 'ERR_clear_error' has been explicitly
      marked deprecated here
void ERR_clear_error(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/ssl.c:111:11: warning: 'SSL_do_handshake' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    err = SSL_do_handshake(ssl->ssl);
          ^
/usr/include/openssl/ssl.h:1545:5: note: 'SSL_do_handshake' has been explicitly
      marked deprecated here
int SSL_do_handshake(SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:112:18: warning: 'SSL_get_error' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
    ssl->error = SSL_get_error(ssl->ssl, err);
                 ^
/usr/include/openssl/ssl.h:1517:5: note: 'SSL_get_error' has been explicitly
      marked deprecated here
int     SSL_get_error(const SSL *s,int ret_code) DEPRECATED_IN_MAC_OS_X_...
        ^
src/ssl.c:128:11: warning: 'ERR_peek_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      if (ERR_peek_error())  {
          ^
/usr/include/openssl/err.h:270:15: note: 'ERR_peek_error' has been explicitly
      marked deprecated here
unsigned long ERR_peek_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
              ^
src/ssl.c:154:5: warning: 'ERR_clear_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    ERR_clear_error();
    ^
/usr/include/openssl/err.h:278:6: note: 'ERR_clear_error' has been explicitly
      marked deprecated here
void ERR_clear_error(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/ssl.c:155:11: warning: 'SSL_write' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    err = SSL_write(ssl->ssl, data, (int)count);
          ^
/usr/include/openssl/ssl.h:1511:6: note: 'SSL_write' has been explicitly marked
      deprecated here
int     SSL_write(SSL *ssl,const void *buf,int num) DEPRECATED_IN_MAC_OS...
        ^
src/ssl.c:156:18: warning: 'SSL_get_error' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
    ssl->error = SSL_get_error(ssl->ssl, err);
                 ^
/usr/include/openssl/ssl.h:1517:5: note: 'SSL_get_error' has been explicitly
      marked deprecated here
int     SSL_get_error(const SSL *s,int ret_code) DEPRECATED_IN_MAC_OS_X_...
        ^
src/ssl.c:172:11: warning: 'ERR_peek_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      if (ERR_peek_error())  {
          ^
/usr/include/openssl/err.h:270:15: note: 'ERR_peek_error' has been explicitly
      marked deprecated here
unsigned long ERR_peek_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
              ^
src/ssl.c:198:5: warning: 'ERR_clear_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    ERR_clear_error();
    ^
/usr/include/openssl/err.h:278:6: note: 'ERR_clear_error' has been explicitly
      marked deprecated here
void ERR_clear_error(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/ssl.c:199:11: warning: 'SSL_read' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    err = SSL_read(ssl->ssl, data, (int)count);
          ^
/usr/include/openssl/ssl.h:1509:6: note: 'SSL_read' has been explicitly marked
      deprecated here
int     SSL_read(SSL *ssl,void *buf,int num) DEPRECATED_IN_MAC_OS_X_VERS...
        ^
src/ssl.c:200:18: warning: 'SSL_get_error' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
    ssl->error = SSL_get_error(ssl->ssl, err);
                 ^
/usr/include/openssl/ssl.h:1517:5: note: 'SSL_get_error' has been explicitly
      marked deprecated here
int     SSL_get_error(const SSL *s,int ret_code) DEPRECATED_IN_MAC_OS_X_...
        ^
src/ssl.c:219:11: warning: 'ERR_peek_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      if (ERR_peek_error())  {
          ^
/usr/include/openssl/err.h:270:15: note: 'ERR_peek_error' has been explicitly
      marked deprecated here
unsigned long ERR_peek_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
              ^
src/ssl.c:253:14: warning: 'SSL_new' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  ssl->ssl = SSL_new(ctx);
             ^
/usr/include/openssl/ssl.h:1497:7: note: 'SSL_new' has been explicitly marked
      deprecated here
SSL *   SSL_new(SSL_CTX *ctx) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/ssl.c:257:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/ssl.c:257:31: warning: 'ERR_get_error' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/ssl.c:261:3: warning: 'SSL_set_fd' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  SSL_set_fd(ssl->ssl, (int)SOCKET_INVALID);
  ^
/usr/include/openssl/ssl.h:1386:5: note: 'SSL_set_fd' has been explicitly marked
      deprecated here
int     SSL_set_fd(SSL *s, int fd) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
        ^
src/ssl.c:262:3: warning: 'SSL_ctrl' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  SSL_set_mode(ssl->ssl, SSL_MODE_ENABLE_PARTIAL_WRITE | 
  ^
/usr/include/openssl/ssl.h:603:2: note: expanded from macro 'SSL_set_mode'
        SSL_ctrl((ssl),SSL_CTRL_MODE,(op),NULL)
        ^
/usr/include/openssl/ssl.h:1512:6: note: 'SSL_ctrl' has been explicitly marked
      deprecated here
long    SSL_ctrl(SSL *ssl,int cmd, long larg, void *parg) DEPRECATED_IN_...
        ^
src/ssl.c:268:5: warning: 'SSL_set_accept_state' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
    SSL_set_accept_state(ssl->ssl);
    ^
/usr/include/openssl/ssl.h:1565:6: note: 'SSL_set_accept_state' has been
      explicitly marked deprecated here
void SSL_set_accept_state(SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/ssl.c:270:5: warning: 'SSL_set_connect_state' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_set_connect_state(ssl->ssl);
    ^
/usr/include/openssl/ssl.h:1564:6: note: 'SSL_set_connect_state' has been
      explicitly marked deprecated here
void SSL_set_connect_state(SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
     ^
src/ssl.c:335:3: warning: 'SSL_set_fd' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  SSL_set_fd(ssl->ssl, (int)ssl->sock);
  ^
/usr/include/openssl/ssl.h:1386:5: note: 'SSL_set_fd' has been explicitly marked
      deprecated here
int     SSL_set_fd(SSL *s, int fd) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
        ^
src/ssl.c:381:41: warning: 'SSL_pending' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    res = !buffer_isempty(&ssl->buf) || SSL_pending(ssl->ssl);
                                        ^
/usr/include/openssl/ssl.h:1384:5: note: 'SSL_pending' has been explicitly
      marked deprecated here
int     SSL_pending(const SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/ssl.c:394:16: warning: 'SSL_want' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
             : SSL_want(ssl->ssl);
               ^
/usr/include/openssl/ssl.h:1368:5: note: 'SSL_want' has been explicitly marked
      deprecated here
int SSL_want(const SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:419:10: warning: 'SSL_get_current_compression' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  comp = SSL_get_current_compression(ssl->ssl);
         ^
/usr/include/openssl/ssl.h:1671:20: note: 'SSL_get_current_compression' has been
      explicitly marked deprecated here
const COMP_METHOD *SSL_get_current_compression(SSL *s) DEPRECATED_IN_MAC...
                   ^
src/ssl.c:421:23: warning: 'SSL_COMP_get_name' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
    lua_pushstring(L, SSL_COMP_get_name(comp));
                      ^
/usr/include/openssl/ssl.h:1673:13: note: 'SSL_COMP_get_name' has been
      explicitly marked deprecated here
const char *SSL_COMP_get_name(const COMP_METHOD *comp) DEPRECATED_IN_MAC...
            ^
src/ssl.c:454:12: warning: 'SSL_get_peer_certificate' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    cert = SSL_get_peer_certificate(ssl->ssl);
           ^
/usr/include/openssl/ssl.h:1466:8: note: 'SSL_get_peer_certificate' has been
      explicitly marked deprecated here
X509 *  SSL_get_peer_certificate(const SSL *s) DEPRECATED_IN_MAC_OS_X_VE...
        ^
src/ssl.c:466:11: warning: 'SSL_get_peer_cert_chain' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  certs = SSL_get_peer_cert_chain(ssl->ssl);
          ^
/usr/include/openssl/ssl.h:1469:17: note: 'SSL_get_peer_cert_chain' has been
      explicitly marked deprecated here
STACK_OF(X509) *SSL_get_peer_cert_chain(const SSL *s) DEPRECATED_IN_MAC_...
                ^
src/ssl.c:467:12: warning: 'sk_num' is deprecated: first deprecated in OS X 10.7
      [-Wdeprecated-declarations]
  if (n >= sk_X509_num(certs)) {
           ^
/usr/include/openssl/safestack.h:1388:25: note: expanded from macro
      'sk_X509_num'
#define sk_X509_num(st) SKM_sk_num(X509, (st))
                        ^
/usr/include/openssl/safestack.h:168:2: note: expanded from macro 'SKM_sk_num'
        sk_num(st)
        ^
/usr/include/openssl/stack.h:81:5: note: 'sk_num' has been explicitly marked
      deprecated here
int sk_num(const STACK *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:471:10: warning: 'sk_value' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  cert = sk_X509_value(certs, n);
         ^
/usr/include/openssl/safestack.h:1389:30: note: expanded from macro
      'sk_X509_value'
#define sk_X509_value(st, i) SKM_sk_value(X509, (st), (i))
                             ^
/usr/include/openssl/safestack.h:170:11: note: expanded from macro
      'SKM_sk_value'
        ((type *)sk_value(st, i))
                 ^
/usr/include/openssl/stack.h:82:7: note: 'sk_value' has been explicitly marked
      deprecated here
char *sk_value(const STACK *, int) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
      ^
src/ssl.c:474:3: warning: 'CRYPTO_add_lock' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  CRYPTO_add(&cert->references, 1, CRYPTO_LOCK_X509);
  ^
/usr/include/openssl/crypto.h:248:2: note: expanded from macro 'CRYPTO_add'
        CRYPTO_add_lock(addr,amount,type,__FILE__,__LINE__)
        ^
/usr/include/openssl/crypto.h:429:5: note: 'CRYPTO_add_lock' has been explicitly
      marked deprecated here
int CRYPTO_add_lock(int *pointer,int amount,int type, const char *file,
    ^
src/ssl.c:497:22: warning: 'SSL_get_peer_certificate' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    lsec_pushx509(L, SSL_get_peer_certificate(ssl->ssl));
                     ^
/usr/include/openssl/ssl.h:1466:8: note: 'SSL_get_peer_certificate' has been
      explicitly marked deprecated here
X509 *  SSL_get_peer_certificate(const SSL *s) DEPRECATED_IN_MAC_OS_X_VE...
        ^
src/ssl.c:500:11: warning: 'SSL_get_peer_cert_chain' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  certs = SSL_get_peer_cert_chain(ssl->ssl);
          ^
/usr/include/openssl/ssl.h:1469:17: note: 'SSL_get_peer_cert_chain' has been
      explicitly marked deprecated here
STACK_OF(X509) *SSL_get_peer_cert_chain(const SSL *s) DEPRECATED_IN_MAC_...
                ^
src/ssl.c:501:13: warning: 'sk_num' is deprecated: first deprecated in OS X 10.7
      [-Wdeprecated-declarations]
  n_certs = sk_X509_num(certs);
            ^
/usr/include/openssl/safestack.h:1388:25: note: expanded from macro
      'sk_X509_num'
#define sk_X509_num(st) SKM_sk_num(X509, (st))
                        ^
/usr/include/openssl/safestack.h:168:2: note: expanded from macro 'SKM_sk_num'
        sk_num(st)
        ^
/usr/include/openssl/stack.h:81:5: note: 'sk_num' has been explicitly marked
      deprecated here
int sk_num(const STACK *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:503:12: warning: 'sk_value' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    cert = sk_X509_value(certs, i);
           ^
/usr/include/openssl/safestack.h:1389:30: note: expanded from macro
      'sk_X509_value'
#define sk_X509_value(st, i) SKM_sk_value(X509, (st), (i))
                             ^
/usr/include/openssl/safestack.h:170:11: note: expanded from macro
      'SKM_sk_value'
        ((type *)sk_value(st, i))
                 ^
/usr/include/openssl/stack.h:82:7: note: 'sk_value' has been explicitly marked
      deprecated here
char *sk_value(const STACK *, int) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
      ^
src/ssl.c:506:5: warning: 'CRYPTO_add_lock' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    CRYPTO_add(&cert->references, 1, CRYPTO_LOCK_X509);
    ^
/usr/include/openssl/crypto.h:248:2: note: expanded from macro 'CRYPTO_add'
        CRYPTO_add_lock(addr,amount,type,__FILE__,__LINE__)
        ^
/usr/include/openssl/crypto.h:429:5: note: 'CRYPTO_add_lock' has been explicitly
      marked deprecated here
int CRYPTO_add_lock(int *pointer,int amount,int type, const char *file,
    ^
src/ssl.c:546:9: warning: 'SSL_get_verify_result' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  err = SSL_get_verify_result(ssl->ssl);
        ^
/usr/include/openssl/ssl.h:1600:6: note: 'SSL_get_verify_result' has been
      explicitly marked deprecated here
long SSL_get_verify_result(const SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSIO...
     ^
src/ssl.c:555:23: warning: 'X509_verify_cert_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    lua_pushstring(L, X509_verify_cert_error_string(err));
                      ^
/usr/include/openssl/x509.h:752:13: note: 'X509_verify_cert_error_string' has
      been explicitly marked deprecated here
const char *X509_verify_cert_error_string(long n) DEPRECATED_IN_MAC_OS_X...
            ^
src/ssl.c:579:14: warning: 'SSL_get_finished' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if ((len = SSL_get_finished(ssl->ssl, NULL, 0)) == 0)
             ^
/usr/include/openssl/ssl.h:1142:8: note: 'SSL_get_finished' has been explicitly
      marked deprecated here
size_t SSL_get_finished(const SSL *s, void *buf, size_t count) DEPRECATE...
       ^
src/ssl.c:587:3: warning: 'SSL_get_finished' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  SSL_get_finished(ssl->ssl, buffer, len);
  ^
/usr/include/openssl/ssl.h:1142:8: note: 'SSL_get_finished' has been explicitly
      marked deprecated here
size_t SSL_get_finished(const SSL *s, void *buf, size_t count) DEPRECATE...
       ^
src/ssl.c:606:14: warning: 'SSL_get_peer_finished' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  if ((len = SSL_get_peer_finished(ssl->ssl, NULL, 0)) == 0)
             ^
/usr/include/openssl/ssl.h:1143:8: note: 'SSL_get_peer_finished' has been
      explicitly marked deprecated here
size_t SSL_get_peer_finished(const SSL *s, void *buf, size_t count) DEPR...
       ^
src/ssl.c:614:3: warning: 'SSL_get_peer_finished' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_get_peer_finished(ssl->ssl, buffer, len);
  ^
/usr/include/openssl/ssl.h:1143:8: note: 'SSL_get_peer_finished' has been
      explicitly marked deprecated here
size_t SSL_get_peer_finished(const SSL *s, void *buf, size_t count) DEPR...
       ^
src/ssl.c:655:12: warning: 'SSL_get_current_cipher' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  cipher = SSL_get_current_cipher(ssl->ssl);
           ^
/usr/include/openssl/ssl.h:1373:13: note: 'SSL_get_current_cipher' has been
      explicitly marked deprecated here
SSL_CIPHER *SSL_get_current_cipher(const SSL *s) DEPRECATED_IN_MAC_OS_X_...
            ^
src/ssl.c:658:3: warning: 'SSL_CIPHER_description' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_CIPHER_description(cipher, buf, sizeof(buf));
  ^
/usr/include/openssl/ssl.h:1571:7: note: 'SSL_CIPHER_description' has been
      explicitly marked deprecated here
char *SSL_CIPHER_description(const SSL_CIPHER *,char *buf,int size) DEPR...
      ^
src/ssl.c:659:10: warning: 'SSL_CIPHER_get_bits' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  bits = SSL_CIPHER_get_bits(cipher, &algbits);
         ^
/usr/include/openssl/ssl.h:1374:5: note: 'SSL_CIPHER_get_bits' has been
      explicitly marked deprecated here
int     SSL_CIPHER_get_bits(const SSL_CIPHER *c,int *alg_bits) DEPRECATE...
        ^
src/ssl.c:663:21: warning: 'SSL_get_version' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  lua_pushstring(L, SSL_get_version(ssl->ssl));
                    ^
/usr/include/openssl/ssl.h:1518:13: note: 'SSL_get_version' has been explicitly
      marked deprecated here
const char *SSL_get_version(const SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION...
            ^
src/ssl.c:671:18: warning: 'SSL_get_SSL_CTX' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX *ctx = SSL_get_SSL_CTX(ssl);
                 ^
/usr/include/openssl/ssl.h:1592:10: note: 'SSL_get_SSL_CTX' has been explicitly
      marked deprecated here
SSL_CTX *SSL_get_SSL_CTX(const SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSION_...
         ^
src/ssl.c:672:30: warning: 'SSL_CTX_get_ex_data' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  lua_State *L = ((p_context)SSL_CTX_get_app_data(ctx))->L;
                             ^
/usr/include/openssl/ssl.h:1092:36: note: expanded from macro
      'SSL_CTX_get_app_data'
#define SSL_CTX_get_app_data(ctx)       (SSL_CTX_get_ex_data(ctx,0))
                                         ^
/usr/include/openssl/ssl.h:1613:7: note: 'SSL_CTX_get_ex_data' has been
      explicitly marked deprecated here
void *SSL_CTX_get_ex_data(const SSL_CTX *ssl,int idx) DEPRECATED_IN_MAC_...
      ^
src/ssl.c:673:22: warning: 'SSL_get_servername' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  const char *name = SSL_get_servername(ssl, TLSEXT_NAMETYPE_host_name);
                     ^
/usr/include/openssl/tls1.h:154:13: note: 'SSL_get_servername' has been
      explicitly marked deprecated here
const char *SSL_get_servername(const SSL *s, const int type) DEPRECATED_...
            ^
src/ssl.c:696:5: warning: 'SSL_set_SSL_CTX' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    SSL_set_SSL_CTX(ssl, newctx);
    ^
/usr/include/openssl/ssl.h:1593:10: note: 'SSL_set_SSL_CTX' has been explicitly
      marked deprecated here
SSL_CTX *SSL_set_SSL_CTX(SSL *ssl, SSL_CTX* ctx) DEPRECATED_IN_MAC_OS_X_...
         ^
src/ssl.c:711:18: warning: 'SSL_get_SSL_CTX' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX *ctx = SSL_get_SSL_CTX(ssl->ssl);
                 ^
/usr/include/openssl/ssl.h:1592:10: note: 'SSL_get_SSL_CTX' has been explicitly
      marked deprecated here
SSL_CTX *SSL_get_SSL_CTX(const SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSION_...
         ^
src/ssl.c:712:31: warning: 'SSL_CTX_get_ex_data' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  p_context pctx = (p_context)SSL_CTX_get_app_data(ctx);
                              ^
/usr/include/openssl/ssl.h:1092:36: note: expanded from macro
      'SSL_CTX_get_app_data'
#define SSL_CTX_get_app_data(ctx)       (SSL_CTX_get_ex_data(ctx,0))
                                         ^
/usr/include/openssl/ssl.h:1613:7: note: 'SSL_CTX_get_ex_data' has been
      explicitly marked deprecated here
void *SSL_CTX_get_ex_data(const SSL_CTX *ssl,int idx) DEPRECATED_IN_MAC_...
      ^
src/ssl.c:715:5: warning: 'SSL_ctrl' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    SSL_set_tlsext_host_name(ssl->ssl, name);
    ^
/usr/include/openssl/tls1.h:157:42: note: expanded from macro
      'SSL_set_tlsext_host_name'
#define SSL_set_tlsext_host_name(s,name) \
                                         ^
/usr/include/openssl/ssl.h:1512:6: note: 'SSL_ctrl' has been explicitly marked
      deprecated here
long    SSL_ctrl(SSL *ssl,int cmd, long larg, void *parg) DEPRECATED_IN_...
        ^
src/ssl.c:726:7: warning: 'SSL_CTX_callback_ctrl' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      SSL_CTX_set_tlsext_servername_callback(aux, sni_cb);
      ^
/usr/include/openssl/tls1.h:187:57: note: expanded from macro
      'SSL_CTX_set_tlsext_servername_callback'
#define SSL_CTX_set_tlsext_servername_callback(ctx, cb) \
                                                        ^
/usr/include/openssl/ssl.h:1515:6: note: 'SSL_CTX_callback_ctrl' has been
      explicitly marked deprecated here
long    SSL_CTX_callback_ctrl(SSL_CTX *, int, void (*)(void)) DEPRECATED...
        ^
src/ssl.c:742:5: warning: 'SSL_CTX_callback_ctrl' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_tlsext_servername_callback(ctx, sni_cb);
    ^
/usr/include/openssl/tls1.h:187:57: note: expanded from macro
      'SSL_CTX_set_tlsext_servername_callback'
#define SSL_CTX_set_tlsext_servername_callback(ctx, cb) \
                                                        ^
/usr/include/openssl/ssl.h:1515:6: note: 'SSL_CTX_callback_ctrl' has been
      explicitly marked deprecated here
long    SSL_CTX_callback_ctrl(SSL_CTX *, int, void (*)(void)) DEPRECATED...
        ^
src/ssl.c:750:22: warning: 'SSL_get_servername' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  const char *name = SSL_get_servername(ssl->ssl, TLSEXT_NAMETYPE_host_name);
                     ^
/usr/include/openssl/tls1.h:154:13: note: 'SSL_get_servername' has been
      explicitly marked deprecated here
const char *SSL_get_servername(const SSL *s, const int type) DEPRECATED_...
            ^
src/ssl.c:822:8: warning: 'SSL_library_init' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if (!SSL_library_init()) {
       ^
/usr/include/openssl/ssl.h:1569:5: note: 'SSL_library_init' has been explicitly
      marked deprecated here
int SSL_library_init(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:826:3: warning: 'OPENSSL_add_all_algorithms_noconf' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
  OpenSSL_add_all_algorithms();
  ^
/usr/include/openssl/evp.h:829:3: note: expanded from macro
      'OpenSSL_add_all_algorithms'
                OPENSSL_add_all_algorithms_noconf()
                ^
/usr/include/openssl/evp.h:821:6: note: 'OPENSSL_add_all_algorithms_noconf' has
      been explicitly marked deprecated here
void OPENSSL_add_all_algorithms_noconf(void) DEPRECATED_IN_MAC_OS_X_VERS...
     ^
src/ssl.c:827:3: warning: 'SSL_load_error_strings' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_load_error_strings();
  ^
/usr/include/openssl/ssl.h:1432:6: note: 'SSL_load_error_strings' has been
      explicitly marked deprecated here
void    SSL_load_error_strings(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_...
        ^
61 warnings generated.
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/luasocket/buffer.c -o src/luasocket/buffer.o -I/usr/include -Isrc/ -Isrc/luasocket
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/luasocket/io.c -o src/luasocket/io.o -I/usr/include -Isrc/ -Isrc/luasocket
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/luasocket/timeout.c -o src/luasocket/timeout.o -I/usr/include -Isrc/ -Isrc/luasocket
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/luasocket/usocket.c -o src/luasocket/usocket.o -I/usr/include -Isrc/ -Isrc/luasocket
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o ssl.so -L/usr/local/lib src/x509.o src/context.o src/ssl.o src/luasocket/buffer.o src/luasocket/io.o src/luasocket/timeout.o src/luasocket/usocket.o -L/usr/lib -Wl,-rpath,/usr/lib: -lssl -lcrypto
Updating manifest for /usr/local/lib/luarocks/rocks
luasec 0.6-1 is now built and installed in /usr/local (license: MIT)

Checking stability of dependencies on the absence of
luasec 0.5-2...

Removing luasec 0.5-2...
stat: /usr/local/lib/lua/5.1/luasec_0_5_2-ssl.so: stat: No such file or directory
Removal successful.
172-15-2-13:lua-5.1.4 mac$ sudo luarocks install luasec
Warning: falling back to curl - install luasec to get native HTTPS support
Installing https://luarocks.org/luasec-0.6-1.rockspec...
Using https://luarocks.org/luasec-0.6-1.rockspec... switching to 'build' mode
Cloning into 'luasec'...
remote: Counting objects: 116, done.
remote: Compressing objects: 100% (93/93), done.
remote: Total 116 (delta 33), reused 76 (delta 22), pack-reused 0
Receiving objects: 100% (116/116), 68.52 KiB | 4.00 KiB/s, done.
Resolving deltas: 100% (33/33), done.
Checking connectivity... done.
Note: checking out '20443861ebc3f6498ee7d9c70fbdaa059bec15e1'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by performing another checkout.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -b with the checkout command again. Example:

  git checkout -b <new-branch-name>

env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/x509.c -o src/x509.o -I/usr/include -Isrc/ -Isrc/luasocket
src/x509.c:131:13: warning: 'OBJ_obj2txt' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
  int len = OBJ_obj2txt(buffer, sizeof(buffer), object, no_name);
            ^
/usr/include/openssl/objects.h:1011:5: note: 'OBJ_obj2txt' has been explicitly
      marked deprecated here
int     OBJ_obj2txt(char *buf, int buf_len, const ASN1_OBJECT *a, int no...
        ^
src/x509.c:149:31: warning: 'ASN1_STRING_data' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
    lua_pushlstring(L, (char*)ASN1_STRING_data(string),
                              ^
/usr/include/openssl/asn1.h:801:17: note: 'ASN1_STRING_data' has been explicitly
      marked deprecated here
unsigned char * ASN1_STRING_data(ASN1_STRING *x) DEPRECATED_IN_MAC_OS_X_...
                ^
src/x509.c:150:24: warning: 'ASN1_STRING_length' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
                       ASN1_STRING_length(string));
                       ^
/usr/include/openssl/asn1.h:798:5: note: 'ASN1_STRING_length' has been
      explicitly marked deprecated here
int ASN1_STRING_length(ASN1_STRING *x) DEPRECATED_IN_MAC_OS_X_VERSION_10...
    ^
src/x509.c:153:11: warning: 'ASN1_STRING_to_UTF8' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    len = ASN1_STRING_to_UTF8(&data, string);
          ^
/usr/include/openssl/asn1.h:982:5: note: 'ASN1_STRING_to_UTF8' has been
      explicitly marked deprecated here
int ASN1_STRING_to_UTF8(unsigned char **out, ASN1_STRING *in) DEPRECATED...
    ^
src/x509.c:156:7: warning: 'CRYPTO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
      OPENSSL_free(data);
      ^
/usr/include/openssl/crypto.h:375:28: note: expanded from macro 'OPENSSL_free'
#define OPENSSL_free(addr)      CRYPTO_free(addr)
                                ^
/usr/include/openssl/crypto.h:480:6: note: 'CRYPTO_free' has been explicitly
      marked deprecated here
void CRYPTO_free(void *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/x509.c:170:14: warning: 'BIO_new' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *out = BIO_new(BIO_s_mem());
             ^
/usr/include/openssl/bio.h:591:7: note: 'BIO_new' has been explicitly marked
      deprecated here
BIO *   BIO_new(BIO_METHOD *type) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:170:22: warning: 'BIO_s_mem' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *out = BIO_new(BIO_s_mem());
                     ^
/usr/include/openssl/bio.h:626:13: note: 'BIO_s_mem' has been explicitly marked
      deprecated here
BIO_METHOD *BIO_s_mem(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
            ^
src/x509.c:171:3: warning: 'ASN1_TIME_print' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  ASN1_TIME_print(out, tm);
  ^
/usr/include/openssl/asn1.h:1009:5: note: 'ASN1_TIME_print' has been explicitly
      marked deprecated here
int ASN1_TIME_print(BIO *fp,ASN1_TIME *a) DEPRECATED_IN_MAC_OS_X_VERSION...
    ^
src/x509.c:172:10: warning: 'BIO_ctrl' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  size = BIO_get_mem_data(out, &tmp);
         ^
/usr/include/openssl/bio.h:504:32: note: expanded from macro 'BIO_get_mem_data'
#define BIO_get_mem_data(b,pp)  BIO_ctrl(b,BIO_CTRL_INFO,0,(char *)pp)
                                ^
/usr/include/openssl/bio.h:600:6: note: 'BIO_ctrl' has been explicitly marked
      deprecated here
long    BIO_ctrl(BIO *bp,int cmd,long larg,void *parg) DEPRECATED_IN_MAC...
        ^
src/x509.c:174:3: warning: 'BIO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO_free(out);
  ^
/usr/include/openssl/bio.h:593:5: note: 'BIO_free' has been explicitly marked
      deprecated here
int     BIO_free(BIO *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:185:23: warning: 'ASN1_STRING_data' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  unsigned char *ip = ASN1_STRING_data(string);
                      ^
/usr/include/openssl/asn1.h:801:17: note: 'ASN1_STRING_data' has been explicitly
      marked deprecated here
unsigned char * ASN1_STRING_data(ASN1_STRING *x) DEPRECATED_IN_MAC_OS_X_...
                ^
src/x509.c:186:10: warning: 'ASN1_STRING_length' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  switch(ASN1_STRING_length(string)) {
         ^
/usr/include/openssl/asn1.h:798:5: note: 'ASN1_STRING_length' has been
      explicitly marked deprecated here
int ASN1_STRING_length(ASN1_STRING *x) DEPRECATED_IN_MAC_OS_X_VERSION_10...
    ^
src/x509.c:233:15: warning: 'X509_NAME_entry_count' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  n_entries = X509_NAME_entry_count(name);
              ^
/usr/include/openssl/x509.h:1098:7: note: 'X509_NAME_entry_count' has been
      explicitly marked deprecated here
int             X509_NAME_entry_count(X509_NAME *name) DEPRECATED_IN_MAC...
                ^
src/x509.c:235:13: warning: 'X509_NAME_get_entry' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    entry = X509_NAME_get_entry(name, i);
            ^
/usr/include/openssl/x509.h:1109:18: note: 'X509_NAME_get_entry' has been
      explicitly marked deprecated here
X509_NAME_ENTRY *X509_NAME_get_entry(X509_NAME *name, int loc) DEPRECATE...
                 ^
src/x509.c:236:14: warning: 'X509_NAME_ENTRY_get_object' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    object = X509_NAME_ENTRY_get_object(entry);
             ^
/usr/include/openssl/x509.h:1130:15: note: 'X509_NAME_ENTRY_get_object' has been
      explicitly marked deprecated here
ASN1_OBJECT *   X509_NAME_ENTRY_get_object(X509_NAME_ENTRY *ne) DEPRECAT...
                ^
src/x509.c:242:25: warning: 'X509_NAME_ENTRY_get_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    push_asn1_string(L, X509_NAME_ENTRY_get_data(entry), encode);
                        ^
/usr/include/openssl/x509.h:1131:15: note: 'X509_NAME_ENTRY_get_data' has been
      explicitly marked deprecated here
ASN1_STRING *   X509_NAME_ENTRY_get_data(X509_NAME_ENTRY *ne) DEPRECATED...
                ^
src/x509.c:257:28: warning: 'X509_get_subject_name' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  return push_x509_name(L, X509_get_subject_name(px->cert), px->encode);
                           ^
/usr/include/openssl/x509.h:1014:13: note: 'X509_get_subject_name' has been
      explicitly marked deprecated here
X509_NAME *     X509_get_subject_name(X509 *a) DEPRECATED_IN_MAC_OS_X_VE...
                ^
src/x509.c:266:28: warning: 'X509_get_issuer_name' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  return push_x509_name(L, X509_get_issuer_name(px->cert), px->encode);
                           ^
/usr/include/openssl/x509.h:1012:13: note: 'X509_get_issuer_name' has been
      explicitly marked deprecated here
X509_NAME *     X509_get_issuer_name(X509 *a) DEPRECATED_IN_MAC_OS_X_VER...
                ^
src/x509.c:287:15: warning: 'X509_get_ext_by_NID' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  while ((i = X509_get_ext_by_NID(peer, NID_subject_alt_name, i)) != -1) {
              ^
/usr/include/openssl/x509.h:1146:6: note: 'X509_get_ext_by_NID' has been
      explicitly marked deprecated here
int             X509_get_ext_by_NID(X509 *x, int nid, int lastpos) DEPRE...
                ^
src/x509.c:288:17: warning: 'X509_get_ext' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
    extension = X509_get_ext(peer, i);
                ^
/usr/include/openssl/x509.h:1149:17: note: 'X509_get_ext' has been explicitly
      marked deprecated here
X509_EXTENSION *X509_get_ext(X509 *x, int loc) DEPRECATED_IN_MAC_OS_X_VE...
                ^
src/x509.c:291:14: warning: 'X509V3_EXT_d2i' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    values = X509V3_EXT_d2i(extension);
             ^
/usr/include/openssl/x509v3.h:585:7: note: 'X509V3_EXT_d2i' has been explicitly
      marked deprecated here
void *X509V3_EXT_d2i(X509_EXTENSION *ext) DEPRECATED_IN_MAC_OS_X_VERSION...
      ^
src/x509.c:303:23: warning: 'sk_num' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    n_general_names = sk_GENERAL_NAME_num(values);
                      ^
/usr/include/openssl/safestack.h:684:33: note: expanded from macro
      'sk_GENERAL_NAME_num'
#define sk_GENERAL_NAME_num(st) SKM_sk_num(GENERAL_NAME, (st))
                                ^
/usr/include/openssl/safestack.h:168:2: note: expanded from macro 'SKM_sk_num'
        sk_num(st)
        ^
/usr/include/openssl/stack.h:81:5: note: 'sk_num' has been explicitly marked
      deprecated here
int sk_num(const STACK *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/x509.c:305:22: warning: 'sk_value' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
      general_name = sk_GENERAL_NAME_value(values, j);
                     ^
/usr/include/openssl/safestack.h:685:38: note: expanded from macro
      'sk_GENERAL_NAME_value'
#define sk_GENERAL_NAME_value(st, i) SKM_sk_value(GENERAL_NAME, (st), (i))
                                     ^
/usr/include/openssl/safestack.h:170:11: note: expanded from macro
      'SKM_sk_value'
        ((type *)sk_value(st, i))
                 ^
/usr/include/openssl/stack.h:82:7: note: 'sk_value' has been explicitly marked
      deprecated here
char *sk_value(const STACK *, int) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
      ^
src/x509.c:378:14: warning: 'BIO_new' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
             ^
/usr/include/openssl/bio.h:591:7: note: 'BIO_new' has been explicitly marked
      deprecated here
BIO *   BIO_new(BIO_METHOD *type) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:378:22: warning: 'BIO_s_mem' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
                     ^
/usr/include/openssl/bio.h:626:13: note: 'BIO_s_mem' has been explicitly marked
      deprecated here
BIO_METHOD *BIO_s_mem(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
            ^
src/x509.c:383:11: warning: 'BIO_ctrl' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  bytes = BIO_get_mem_data(bio, &data);
          ^
/usr/include/openssl/bio.h:504:32: note: expanded from macro 'BIO_get_mem_data'
#define BIO_get_mem_data(b,pp)  BIO_ctrl(b,BIO_CTRL_INFO,0,(char *)pp)
                                ^
/usr/include/openssl/bio.h:600:6: note: 'BIO_ctrl' has been explicitly marked
      deprecated here
long    BIO_ctrl(BIO *bp,int cmd,long larg,void *parg) DEPRECATED_IN_MAC...
        ^
src/x509.c:388:3: warning: 'BIO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO_free(bio);
  ^
/usr/include/openssl/bio.h:593:5: note: 'BIO_free' has been explicitly marked
      deprecated here
int     BIO_free(BIO *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:401:14: warning: 'BIO_new' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
             ^
/usr/include/openssl/bio.h:591:7: note: 'BIO_new' has been explicitly marked
      deprecated here
BIO *   BIO_new(BIO_METHOD *type) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:401:22: warning: 'BIO_s_mem' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
                     ^
/usr/include/openssl/bio.h:626:13: note: 'BIO_s_mem' has been explicitly marked
      deprecated here
BIO_METHOD *BIO_s_mem(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
            ^
src/x509.c:402:20: warning: 'X509_get_pubkey' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  EVP_PKEY *pkey = X509_get_pubkey(cert);
                   ^
/usr/include/openssl/x509.h:1018:12: note: 'X509_get_pubkey' has been explicitly
      marked deprecated here
EVP_PKEY *      X509_get_pubkey(X509 *x) DEPRECATED_IN_MAC_OS_X_VERSION_...
                ^
src/x509.c:404:13: warning: 'BIO_ctrl' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    bytes = BIO_get_mem_data(bio, &data);
            ^
/usr/include/openssl/bio.h:504:32: note: expanded from macro 'BIO_get_mem_data'
#define BIO_get_mem_data(b,pp)  BIO_ctrl(b,BIO_CTRL_INFO,0,(char *)pp)
                                ^
/usr/include/openssl/bio.h:600:6: note: 'BIO_ctrl' has been explicitly marked
      deprecated here
long    BIO_ctrl(BIO *bp,int cmd,long larg,void *parg) DEPRECATED_IN_MAC...
        ^
src/x509.c:407:14: warning: 'EVP_PKEY_type' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      switch(EVP_PKEY_type(pkey->type)) {
             ^
/usr/include/openssl/evp.h:851:6: note: 'EVP_PKEY_type' has been explicitly
      marked deprecated here
int             EVP_PKEY_type(int type) DEPRECATED_IN_MAC_OS_X_VERSION_1...
                ^
src/x509.c:424:26: warning: 'EVP_PKEY_bits' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      lua_pushinteger(L, EVP_PKEY_bits(pkey));
                         ^
/usr/include/openssl/evp.h:852:6: note: 'EVP_PKEY_bits' has been explicitly
      marked deprecated here
int             EVP_PKEY_bits(EVP_PKEY *pkey) DEPRECATED_IN_MAC_OS_X_VER...
                ^
src/x509.c:433:3: warning: 'BIO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO_free(bio);
  ^
/usr/include/openssl/bio.h:593:5: note: 'BIO_free' has been explicitly marked
      deprecated here
int     BIO_free(BIO *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:434:3: warning: 'EVP_PKEY_free' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
  EVP_PKEY_free(pkey);
  ^
/usr/include/openssl/evp.h:878:7: note: 'EVP_PKEY_free' has been explicitly
      marked deprecated here
void            EVP_PKEY_free(EVP_PKEY *pkey) DEPRECATED_IN_MAC_OS_X_VER...
                ^
src/x509.c:450:14: warning: 'EVP_sha1' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    digest = EVP_sha1();
             ^
/usr/include/openssl/evp.h:666:15: note: 'EVP_sha1' has been explicitly marked
      deprecated here
const EVP_MD *EVP_sha1(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/x509.c:453:16: warning: 'EVP_sha1' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
      digest = EVP_sha1();
               ^
/usr/include/openssl/evp.h:666:15: note: 'EVP_sha1' has been explicitly marked
      deprecated here
const EVP_MD *EVP_sha1(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/x509.c:455:16: warning: 'EVP_sha256' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
      digest = EVP_sha256();
               ^
/usr/include/openssl/evp.h:673:15: note: 'EVP_sha256' has been explicitly marked
      deprecated here
const EVP_MD *EVP_sha256(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/x509.c:457:16: warning: 'EVP_sha512' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
      digest = EVP_sha512();
               ^
/usr/include/openssl/evp.h:677:15: note: 'EVP_sha512' has been explicitly marked
      deprecated here
const EVP_MD *EVP_sha512(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/x509.c:464:8: warning: 'X509_digest' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  if (!X509_digest(cert, digest, buffer, &bytes)) {
       ^
/usr/include/openssl/x509.h:778:5: note: 'X509_digest' has been explicitly
      marked deprecated here
int X509_digest(const X509 *data,const EVP_MD *type,
    ^
src/x509.c:467:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/x509.c:467:31: warning: 'ERR_get_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/x509.c:482:23: warning: 'X509_cmp_time' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  lua_pushboolean(L, (X509_cmp_time(X509_get_notAfter(cert), &time)     >= 0
                      ^
/usr/include/openssl/x509.h:882:6: note: 'X509_cmp_time' has been explicitly
      marked deprecated here
int             X509_cmp_time(ASN1_TIME *s, time_t *t) DEPRECATED_IN_MAC...
                ^
src/x509.c:483:26: warning: 'X509_cmp_time' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
                      && X509_cmp_time(X509_get_notBefore(cert), &time) <= 0));
                         ^
/usr/include/openssl/x509.h:882:6: note: 'X509_cmp_time' has been explicitly
      marked deprecated here
int             X509_cmp_time(ASN1_TIME *s, time_t *t) DEPRECATED_IN_MAC...
                ^
src/x509.c:496:12: warning: 'X509_get_serialNumber' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  serial = X509_get_serialNumber(cert);
           ^
/usr/include/openssl/x509.h:1010:16: note: 'X509_get_serialNumber' has been
      explicitly marked deprecated here
ASN1_INTEGER *  X509_get_serialNumber(X509 *x) DEPRECATED_IN_MAC_OS_X_VE...
                ^
src/x509.c:497:8: warning: 'ASN1_INTEGER_to_BN' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  bn = ASN1_INTEGER_to_BN(serial, NULL);
       ^
/usr/include/openssl/asn1.h:902:9: note: 'ASN1_INTEGER_to_BN' has been
      explicitly marked deprecated here
BIGNUM *ASN1_INTEGER_to_BN(ASN1_INTEGER *ai,BIGNUM *bn) DEPRECATED_IN_MA...
        ^
src/x509.c:498:9: warning: 'BN_bn2hex' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  tmp = BN_bn2hex(bn);
        ^
/usr/include/openssl/bn.h:505:8: note: 'BN_bn2hex' has been explicitly marked
      deprecated here
char *  BN_bn2hex(const BIGNUM *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
        ^
src/x509.c:500:3: warning: 'BN_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BN_free(bn);
  ^
/usr/include/openssl/bn.h:468:6: note: 'BN_free' has been explicitly marked
      deprecated here
void    BN_free(BIGNUM *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:501:3: warning: 'CRYPTO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  OPENSSL_free(tmp);
  ^
/usr/include/openssl/crypto.h:375:28: note: expanded from macro 'OPENSSL_free'
#define OPENSSL_free(addr)      CRYPTO_free(addr)
                                ^
/usr/include/openssl/crypto.h:480:6: note: 'CRYPTO_free' has been explicitly
      marked deprecated here
void CRYPTO_free(void *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/x509.c:548:11: warning: 'sk_new_null' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
  chain = sk_X509_new_null();
          ^
/usr/include/openssl/safestack.h:1386:28: note: expanded from macro
      'sk_X509_new_null'
#define sk_X509_new_null() SKM_sk_new_null(X509)
                           ^
/usr/include/openssl/safestack.h:164:2: note: expanded from macro
      'SKM_sk_new_null'
        sk_new_null()
        ^
/usr/include/openssl/stack.h:87:8: note: 'sk_new_null' has been explicitly
      marked deprecated here
STACK *sk_new_null(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
       ^
src/x509.c:549:9: warning: 'X509_STORE_CTX_new' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  ctx = X509_STORE_CTX_new();
        ^
/usr/include/openssl/x509_vfy.h:397:17: note: 'X509_STORE_CTX_new' has been
      explicitly marked deprecated here
X509_STORE_CTX *X509_STORE_CTX_new(void) DEPRECATED_IN_MAC_OS_X_VERSION_...
                ^
src/x509.c:550:10: warning: 'X509_STORE_new' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  root = X509_STORE_new();
         ^
/usr/include/openssl/x509_vfy.h:389:13: note: 'X509_STORE_new' has been
      explicitly marked deprecated here
X509_STORE *X509_STORE_new(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
            ^
src/x509.c:559:9: warning: 'X509_STORE_add_cert' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  ret = X509_STORE_add_cert(root, issuer);
        ^
/usr/include/openssl/x509_vfy.h:412:5: note: 'X509_STORE_add_cert' has been
      explicitly marked deprecated here
int X509_STORE_add_cert(X509_STORE *ctx, X509 *x) DEPRECATED_IN_MAC_OS_X...
    ^
src/x509.c:570:5: warning: 'sk_push' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    sk_X509_push(chain, cert);
    ^
/usr/include/openssl/safestack.h:1392:31: note: expanded from macro
      'sk_X509_push'
#define sk_X509_push(st, val) SKM_sk_push(X509, (st), (val))
                              ^
/usr/include/openssl/safestack.h:176:2: note: expanded from macro 'SKM_sk_push'
        sk_push(st, (char *)val)
        ^
/usr/include/openssl/stack.h:95:5: note: 'sk_push' has been explicitly marked
      deprecated here
int sk_push(STACK *st,char *data) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/x509.c:573:9: warning: 'X509_STORE_CTX_init' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  ret = X509_STORE_CTX_init(ctx, root, subject, chain);
        ^
/usr/include/openssl/x509_vfy.h:402:5: note: 'X509_STORE_CTX_init' has been
      explicitly marked deprecated here
int X509_STORE_CTX_init(X509_STORE_CTX *ctx, X509_STORE *store,
    ^
src/x509.c:583:7: warning: 'X509_verify_cert' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if (X509_verify_cert(ctx) <= 0) {
      ^
/usr/include/openssl/x509.h:1242:6: note: 'X509_verify_cert' has been explicitly
      marked deprecated here
int             X509_verify_cert(X509_STORE_CTX *ctx) DEPRECATED_IN_MAC_...
                ^
src/x509.c:584:11: warning: 'X509_STORE_CTX_get_error' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    ret = X509_STORE_CTX_get_error(ctx);
          ^
/usr/include/openssl/x509_vfy.h:451:5: note: 'X509_STORE_CTX_get_error' has been
      explicitly marked deprecated here
int     X509_STORE_CTX_get_error(X509_STORE_CTX *ctx) DEPRECATED_IN_MAC_...
        ^
src/x509.c:586:23: warning: 'X509_verify_cert_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    lua_pushstring(L, X509_verify_cert_error_string(ret));
                      ^
/usr/include/openssl/x509.h:752:13: note: 'X509_verify_cert_error_string' has
      been explicitly marked deprecated here
const char *X509_verify_cert_error_string(long n) DEPRECATED_IN_MAC_OS_X...
            ^
src/x509.c:596:5: warning: 'X509_STORE_CTX_free' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
    X509_STORE_CTX_free(ctx);
    ^
/usr/include/openssl/x509_vfy.h:401:6: note: 'X509_STORE_CTX_free' has been
      explicitly marked deprecated here
void X509_STORE_CTX_free(X509_STORE_CTX *ctx) DEPRECATED_IN_MAC_OS_X_VER...
     ^
src/x509.c:600:5: warning: 'X509_STORE_free' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    X509_STORE_free(root);
    ^
/usr/include/openssl/x509_vfy.h:390:6: note: 'X509_STORE_free' has been
      explicitly marked deprecated here
void X509_STORE_free(X509_STORE *v) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_...
     ^
src/x509.c:603:3: warning: 'sk_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  sk_X509_free(chain);
  ^
/usr/include/openssl/safestack.h:1387:26: note: expanded from macro
      'sk_X509_free'
#define sk_X509_free(st) SKM_sk_free(X509, (st))
                         ^
/usr/include/openssl/safestack.h:166:2: note: expanded from macro 'SKM_sk_free'
        sk_free(st)
        ^
/usr/include/openssl/stack.h:88:6: note: 'sk_free' has been explicitly marked
      deprecated here
void sk_free(STACK *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/x509.c:650:14: warning: 'BIO_new' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
             ^
/usr/include/openssl/bio.h:591:7: note: 'BIO_new' has been explicitly marked
      deprecated here
BIO *   BIO_new(BIO_METHOD *type) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/x509.c:650:22: warning: 'BIO_s_mem' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO *bio = BIO_new(BIO_s_mem());
                     ^
/usr/include/openssl/bio.h:626:13: note: 'BIO_s_mem' has been explicitly marked
      deprecated here
BIO_METHOD *BIO_s_mem(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
            ^
src/x509.c:652:3: warning: 'BIO_write' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO_write(bio, data, bytes);
  ^
/usr/include/openssl/bio.h:597:5: note: 'BIO_write' has been explicitly marked
      deprecated here
int     BIO_write(BIO *b, const void *data, int len) DEPRECATED_IN_MAC_O...
        ^
src/x509.c:658:3: warning: 'BIO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  BIO_free(bio);
  ^
/usr/include/openssl/bio.h:593:5: note: 'BIO_free' has been explicitly marked
      deprecated here
int     BIO_free(BIO *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
65 warnings generated.
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/context.c -o src/context.o -I/usr/include -Isrc/ -Isrc/luasocket
src/context.c:99:42: warning: 'SSLv23_method' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if (!strcmp(method, "any"))     return SSLv23_method();
                                         ^
/usr/include/openssl/ssl.h:1531:13: note: 'SSLv23_method' has been explicitly
      marked deprecated here
SSL_METHOD *SSLv23_method(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_...
            ^
src/context.c:100:42: warning: 'SSLv23_method' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  if (!strcmp(method, "sslv23"))  return SSLv23_method();  // deprecated
                                         ^
/usr/include/openssl/ssl.h:1531:13: note: 'SSLv23_method' has been explicitly
      marked deprecated here
SSL_METHOD *SSLv23_method(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_...
            ^
src/context.c:102:42: warning: 'SSLv3_method' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if (!strcmp(method, "sslv3"))   return SSLv3_method();
                                         ^
/usr/include/openssl/ssl.h:1527:13: note: 'SSLv3_method' has been explicitly
      marked deprecated here
SSL_METHOD *SSLv3_method(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_L...
            ^
src/context.c:104:42: warning: 'TLSv1_method' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if (!strcmp(method, "tlsv1"))   return TLSv1_method();
                                         ^
/usr/include/openssl/ssl.h:1535:13: note: 'TLSv1_method' has been explicitly
      marked deprecated here
SSL_METHOD *TLSv1_method(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_L...
            ^
src/context.c:184:21: warning: 'X509_verify_cert_error_string' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
  lua_pushstring(L, X509_verify_cert_error_string(err));
                    ^
/usr/include/openssl/x509.h:752:13: note: 'X509_verify_cert_error_string' has
      been explicitly marked deprecated here
const char *X509_verify_cert_error_string(long n) DEPRECATED_IN_MAC_OS_X...
            ^
src/context.c:198:18: warning: 'SSL_get_SSL_CTX' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX *ctx = SSL_get_SSL_CTX(ssl);
                 ^
/usr/include/openssl/ssl.h:1592:10: note: 'SSL_get_SSL_CTX' has been explicitly
      marked deprecated here
SSL_CTX *SSL_get_SSL_CTX(const SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSION_...
         ^
src/context.c:199:31: warning: 'SSL_CTX_get_ex_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  p_context pctx = (p_context)SSL_CTX_get_app_data(ctx);
                              ^
/usr/include/openssl/ssl.h:1092:36: note: expanded from macro
      'SSL_CTX_get_app_data'
#define SSL_CTX_get_app_data(ctx)       (SSL_CTX_get_ex_data(ctx,0))
                                         ^
/usr/include/openssl/ssl.h:1613:7: note: 'SSL_CTX_get_ex_data' has been
      explicitly marked deprecated here
void *SSL_CTX_get_ex_data(const SSL_CTX *ssl,int idx) DEPRECATED_IN_MAC_...
      ^
src/context.c:218:9: warning: 'BIO_new_mem_buf' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  bio = BIO_new_mem_buf((void*)lua_tostring(L, -1), 
        ^
/usr/include/openssl/bio.h:627:6: note: 'BIO_new_mem_buf' has been explicitly
      marked deprecated here
BIO *BIO_new_mem_buf(void *buf, int len) DEPRECATED_IN_MAC_OS_X_VERSION_...
     ^
src/context.c:222:5: warning: 'BIO_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    BIO_free(bio);
    ^
/usr/include/openssl/bio.h:593:5: note: 'BIO_free' has been explicitly marked
      deprecated here
int     BIO_free(BIO *a) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/context.c:231:5: warning: 'DH_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    DH_free(pctx->dh_param);
    ^
/usr/include/openssl/dh.h:185:6: note: 'DH_free' has been explicitly marked
      deprecated here
void    DH_free(DH *dh) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/context.c:246:31: warning: 'SSL_CTX_get_ex_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  p_context pctx = (p_context)SSL_CTX_get_app_data(ctx);
                              ^
/usr/include/openssl/ssl.h:1092:36: note: expanded from macro
      'SSL_CTX_get_app_data'
#define SSL_CTX_get_app_data(ctx)       (SSL_CTX_get_ex_data(ctx,0))
                                         ^
/usr/include/openssl/ssl.h:1613:7: note: 'SSL_CTX_get_ex_data' has been
      explicitly marked deprecated here
void *SSL_CTX_get_ex_data(const SSL_CTX *ssl,int idx) DEPRECATED_IN_MAC_...
      ^
src/context.c:260:32: warning: 'X509_STORE_CTX_get0_param' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    X509_VERIFY_PARAM *param = X509_STORE_CTX_get0_param(x509_ctx);
                               ^
/usr/include/openssl/x509_vfy.h:473:20: note: 'X509_STORE_CTX_get0_param' has
      been explicitly marked deprecated here
X509_VERIFY_PARAM *X509_STORE_CTX_get0_param(X509_STORE_CTX *ctx) DEPREC...
                   ^
src/context.c:262:7: warning: 'X509_VERIFY_PARAM_set_purpose' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
      X509_VERIFY_PARAM_set_purpose(param, X509_PURPOSE_SSL_SERVER);
      ^
/usr/include/openssl/x509_vfy.h:490:5: note: 'X509_VERIFY_PARAM_set_purpose' has
      been explicitly marked deprecated here
int X509_VERIFY_PARAM_set_purpose(X509_VERIFY_PARAM *param, int purpose...
    ^
src/context.c:263:7: warning: 'X509_VERIFY_PARAM_set_trust' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      X509_VERIFY_PARAM_set_trust(param, X509_TRUST_SSL_SERVER);
      ^
/usr/include/openssl/x509_vfy.h:491:5: note: 'X509_VERIFY_PARAM_set_trust' has
      been explicitly marked deprecated here
int X509_VERIFY_PARAM_set_trust(X509_VERIFY_PARAM *param, int trust) DEP...
    ^
src/context.c:267:10: warning: 'X509_verify_cert' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  return X509_verify_cert(x509_ctx);
         ^
/usr/include/openssl/x509.h:1242:6: note: 'X509_verify_cert' has been explicitly
      marked deprecated here
int             X509_verify_cert(X509_STORE_CTX *ctx) DEPRECATED_IN_MAC_...
                ^
src/context.c:286:9: warning: 'X509_STORE_CTX_get_ex_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  ssl = X509_STORE_CTX_get_ex_data(x509_ctx,
        ^
/usr/include/openssl/x509_vfy.h:450:8: note: 'X509_STORE_CTX_get_ex_data' has
      been explicitly marked deprecated here
void *  X509_STORE_CTX_get_ex_data(X509_STORE_CTX *ctx,int idx) DEPRECAT...
        ^
src/context.c:287:5: warning: 'SSL_get_ex_data_X509_STORE_CTX_idx' is
      deprecated: first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_get_ex_data_X509_STORE_CTX_idx());
    ^
/usr/include/openssl/ssl.h:1617:5: note: 'SSL_get_ex_data_X509_STORE_CTX_idx'
      has been explicitly marked deprecated here
int SSL_get_ex_data_X509_STORE_CTX_idx(void ) DEPRECATED_IN_MAC_OS_X_VER...
    ^
src/context.c:288:9: warning: 'SSL_get_SSL_CTX' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  ctx = SSL_get_SSL_CTX(ssl);
        ^
/usr/include/openssl/ssl.h:1592:10: note: 'SSL_get_SSL_CTX' has been explicitly
      marked deprecated here
SSL_CTX *SSL_get_SSL_CTX(const SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSION_...
         ^
src/context.c:289:21: warning: 'SSL_CTX_get_ex_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  pctx = (p_context)SSL_CTX_get_app_data(ctx);
                    ^
/usr/include/openssl/ssl.h:1092:36: note: expanded from macro
      'SSL_CTX_get_app_data'
#define SSL_CTX_get_app_data(ctx)       (SSL_CTX_get_ex_data(ctx,0))
                                         ^
/usr/include/openssl/ssl.h:1613:7: note: 'SSL_CTX_get_ex_data' has been
      explicitly marked deprecated here
void *SSL_CTX_get_ex_data(const SSL_CTX *ssl,int idx) DEPRECATED_IN_MAC_...
      ^
src/context.c:300:9: warning: 'X509_STORE_CTX_get_error' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  err = X509_STORE_CTX_get_error(x509_ctx);
        ^
/usr/include/openssl/x509_vfy.h:451:5: note: 'X509_STORE_CTX_get_error' has been
      explicitly marked deprecated here
int     X509_STORE_CTX_get_error(X509_STORE_CTX *ctx) DEPRECATED_IN_MAC_...
        ^
src/context.c:302:33: warning: 'X509_STORE_CTX_get_error_depth' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    add_cert_error(L, ssl, err, X509_STORE_CTX_get_error_depth(x509_ctx));
                                ^
/usr/include/openssl/x509_vfy.h:453:5: note: 'X509_STORE_CTX_get_error_depth'
      has been explicitly marked deprecated here
int     X509_STORE_CTX_get_error_depth(X509_STORE_CTX *ctx) DEPRECATED_I...
        ^
src/context.c:313:14: warning: 'EC_KEY_new_by_curve_name' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      return EC_KEY_new_by_curve_name(ptr->nid);
             ^
/usr/include/openssl/ec.h:306:9: note: 'EC_KEY_new_by_curve_name' has been
      explicitly marked deprecated here
EC_KEY *EC_KEY_new_by_curve_name(int nid) DEPRECATED_IN_MAC_OS_X_VERSION...
        ^
src/context.c:344:18: warning: 'SSL_CTX_new' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  ctx->context = SSL_CTX_new(method);
                 ^
/usr/include/openssl/ssl.h:1362:10: note: 'SSL_CTX_new' has been explicitly
      marked deprecated here
SSL_CTX *SSL_CTX_new(SSL_METHOD *meth) DEPRECATED_IN_MAC_OS_X_VERSION_10...
         ^
src/context.c:348:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:348:31: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:357:3: warning: 'SSL_CTX_ctrl' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX_set_session_cache_mode(ctx->context, SSL_SESS_CACHE_OFF);
  ^
/usr/include/openssl/ssl.h:1624:2: note: expanded from macro
      'SSL_CTX_set_session_cache_mode'
        SSL_CTX_ctrl(ctx,SSL_CTRL_SET_SESS_CACHE_MODE,m,NULL)
        ^
/usr/include/openssl/ssl.h:1514:6: note: 'SSL_CTX_ctrl' has been explicitly
      marked deprecated here
long    SSL_CTX_ctrl(SSL_CTX *ctx,int cmd, long larg, void *parg) DEPREC...
        ^
src/context.c:359:3: warning: 'SSL_CTX_set_ex_data' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX_set_app_data(ctx->context, ctx);
  ^
/usr/include/openssl/ssl.h:1093:40: note: expanded from macro
      'SSL_CTX_set_app_data'
#define SSL_CTX_set_app_data(ctx,arg)   (SSL_CTX_set_ex_data(ctx,0,(char *)arg))
                                         ^
/usr/include/openssl/ssl.h:1612:5: note: 'SSL_CTX_set_ex_data' has been
      explicitly marked deprecated here
int SSL_CTX_set_ex_data(SSL_CTX *ssl,int idx,void *data) DEPRECATED_IN_M...
    ^
src/context.c:372:7: warning: 'SSL_CTX_load_verify_locations' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
  if (SSL_CTX_load_verify_locations(ctx, cafile, capath) != 1) {
      ^
/usr/include/openssl/ssl.h:1587:5: note: 'SSL_CTX_load_verify_locations' has
      been explicitly marked deprecated here
int SSL_CTX_load_verify_locations(SSL_CTX *ctx, const char *CAfile,
    ^
src/context.c:375:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:375:31: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:389:7: warning: 'SSL_CTX_use_certificate_chain_file' is
      deprecated: first deprecated in OS X 10.7 [-Wdeprecated-declarations]
  if (SSL_CTX_use_certificate_chain_file(ctx, filename) != 1) {
      ^
/usr/include/openssl/ssl.h:1419:5: note: 'SSL_CTX_use_certificate_chain_file'
      has been explicitly marked deprecated here
int     SSL_CTX_use_certificate_chain_file(SSL_CTX *ctx, const char *fil...
        ^
src/context.c:392:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:392:31: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:410:5: warning: 'SSL_CTX_set_default_passwd_cb' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_default_passwd_cb(ctx, passwd_cb);
    ^
/usr/include/openssl/ssl.h:1488:6: note: 'SSL_CTX_set_default_passwd_cb' has
      been explicitly marked deprecated here
void SSL_CTX_set_default_passwd_cb(SSL_CTX *ctx, pem_password_cb *cb) DE...
     ^
src/context.c:411:5: warning: 'SSL_CTX_set_default_passwd_cb_userdata' is
      deprecated: first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_default_passwd_cb_userdata(ctx, L);
    ^
/usr/include/openssl/ssl.h:1489:6: note: 
      'SSL_CTX_set_default_passwd_cb_userdata' has been explicitly marked
      deprecated here
void SSL_CTX_set_default_passwd_cb_userdata(SSL_CTX *ctx, void *u) DEPRE...
     ^
src/context.c:414:9: warning: 'SSL_CTX_use_PrivateKey_file' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    if (SSL_CTX_use_PrivateKey_file(ctx, filename, SSL_FILETYPE_PEM) == 1)
        ^
/usr/include/openssl/ssl.h:1417:5: note: 'SSL_CTX_use_PrivateKey_file' has been
      explicitly marked deprecated here
int     SSL_CTX_use_PrivateKey_file(SSL_CTX *ctx, const char *file, int ...
        ^
src/context.c:420:9: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
        ERR_reason_error_string(ERR_get_error()));
        ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:420:33: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
        ERR_reason_error_string(ERR_get_error()));
                                ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:422:5: warning: 'SSL_CTX_set_default_passwd_cb' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_default_passwd_cb(ctx, NULL);
    ^
/usr/include/openssl/ssl.h:1488:6: note: 'SSL_CTX_set_default_passwd_cb' has
      been explicitly marked deprecated here
void SSL_CTX_set_default_passwd_cb(SSL_CTX *ctx, pem_password_cb *cb) DE...
     ^
src/context.c:423:5: warning: 'SSL_CTX_set_default_passwd_cb_userdata' is
      deprecated: first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_default_passwd_cb_userdata(ctx, NULL);
    ^
/usr/include/openssl/ssl.h:1489:6: note: 
      'SSL_CTX_set_default_passwd_cb_userdata' has been explicitly marked
      deprecated here
void SSL_CTX_set_default_passwd_cb_userdata(SSL_CTX *ctx, void *u) DEPRE...
     ^
src/context.c:439:22: warning: 'SSL_CTX_check_private_key' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  lua_pushboolean(L, SSL_CTX_check_private_key(ctx));
                     ^
/usr/include/openssl/ssl.h:1491:5: note: 'SSL_CTX_check_private_key' has been
      explicitly marked deprecated here
int SSL_CTX_check_private_key(const SSL_CTX *ctx) DEPRECATED_IN_MAC_OS_X...
    ^
src/context.c:450:7: warning: 'SSL_CTX_set_cipher_list' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  if (SSL_CTX_set_cipher_list(ctx, list) != 1) {
      ^
/usr/include/openssl/ssl.h:1361:5: note: 'SSL_CTX_set_cipher_list' has been
      explicitly marked deprecated here
int     SSL_CTX_set_cipher_list(SSL_CTX *,const char *str) DEPRECATED_IN...
        ^
src/context.c:453:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:453:31: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:466:3: warning: 'SSL_CTX_set_verify_depth' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX_set_verify_depth(ctx, (int)luaL_checkinteger(L, 2));
  ^
/usr/include/openssl/ssl.h:1476:6: note: 'SSL_CTX_set_verify_depth' has been
      explicitly marked deprecated here
void SSL_CTX_set_verify_depth(SSL_CTX *ctx,int depth) DEPRECATED_IN_MAC_...
     ^
src/context.c:489:13: warning: 'SSL_CTX_set_verify' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  if (flag) SSL_CTX_set_verify(ctx, flag, NULL);
            ^
/usr/include/openssl/ssl.h:1474:6: note: 'SSL_CTX_set_verify' has been
      explicitly marked deprecated here
void SSL_CTX_set_verify(SSL_CTX *ctx,int mode,
     ^
src/context.c:520:5: warning: 'SSL_CTX_ctrl' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_options(ctx, flag);
    ^
/usr/include/openssl/ssl.h:582:2: note: expanded from macro
      'SSL_CTX_set_options'
        SSL_CTX_ctrl((ctx),SSL_CTRL_OPTIONS,(op),NULL)
        ^
/usr/include/openssl/ssl.h:1514:6: note: 'SSL_CTX_ctrl' has been explicitly
      marked deprecated here
long    SSL_CTX_ctrl(SSL_CTX *ctx,int cmd, long larg, void *parg) DEPREC...
        ^
src/context.c:554:3: warning: 'SSL_CTX_set_tmp_dh_callback' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX_set_tmp_dh_callback(ctx, dhparam_cb);
  ^
/usr/include/openssl/ssl.h:1654:6: note: 'SSL_CTX_set_tmp_dh_callback' has been
      explicitly marked deprecated here
void SSL_CTX_set_tmp_dh_callback(SSL_CTX *ctx,
     ^
src/context.c:589:9: warning: 'SSL_CTX_ctrl' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  ret = SSL_CTX_set_tmp_ecdh(ctx, key);
        ^
/usr/include/openssl/ssl.h:1337:2: note: expanded from macro
      'SSL_CTX_set_tmp_ecdh'
        SSL_CTX_ctrl(ctx,SSL_CTRL_SET_TMP_ECDH,0,(char *)ecdh)
        ^
/usr/include/openssl/ssl.h:1514:6: note: 'SSL_CTX_ctrl' has been explicitly
      marked deprecated here
long    SSL_CTX_ctrl(SSL_CTX *ctx,int cmd, long larg, void *parg) DEPREC...
        ^
src/context.c:591:3: warning: 'EC_KEY_free' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  EC_KEY_free(key);
  ^
/usr/include/openssl/ec.h:307:6: note: 'EC_KEY_free' has been explicitly marked
      deprecated here
void EC_KEY_free(EC_KEY *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/context.c:596:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/context.c:596:31: warning: 'ERR_get_error' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/context.c:642:5: warning: 'SSL_CTX_free' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_free(ctx->context);
    ^
/usr/include/openssl/ssl.h:1363:6: note: 'SSL_CTX_free' has been explicitly
      marked deprecated here
void    SSL_CTX_free(SSL_CTX *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/context.c:646:5: warning: 'DH_free' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    DH_free(ctx->dh_param);
    ^
/usr/include/openssl/dh.h:185:6: note: 'DH_free' has been explicitly marked
      deprecated here
void    DH_free(DH *dh) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/context.c:692:5: warning: 'SSL_CTX_set_verify' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_verify(ctx, SSL_CTX_get_verify_mode(ctx), verify_cb);
    ^
/usr/include/openssl/ssl.h:1474:6: note: 'SSL_CTX_set_verify' has been
      explicitly marked deprecated here
void SSL_CTX_set_verify(SSL_CTX *ctx,int mode,
     ^
src/context.c:692:29: warning: 'SSL_CTX_get_verify_mode' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_verify(ctx, SSL_CTX_get_verify_mode(ctx), verify_cb);
                            ^
/usr/include/openssl/ssl.h:1471:5: note: 'SSL_CTX_get_verify_mode' has been
      explicitly marked deprecated here
int SSL_CTX_get_verify_mode(const SSL_CTX *ctx) DEPRECATED_IN_MAC_OS_X_V...
    ^
src/context.c:693:5: warning: 'SSL_CTX_set_cert_verify_callback' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_cert_verify_callback(ctx, cert_verify_cb, (void*)ctx);
    ^
/usr/include/openssl/ssl.h:1477:6: note: 'SSL_CTX_set_cert_verify_callback' has
      been explicitly marked deprecated here
void SSL_CTX_set_cert_verify_callback(SSL_CTX *ctx, int (*cb)(X509_STORE...
     ^
src/context.c:700:5: warning: 'SSL_CTX_set_verify' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_verify(ctx, SSL_CTX_get_verify_mode(ctx), NULL);
    ^
/usr/include/openssl/ssl.h:1474:6: note: 'SSL_CTX_set_verify' has been
      explicitly marked deprecated here
void SSL_CTX_set_verify(SSL_CTX *ctx,int mode,
     ^
src/context.c:700:29: warning: 'SSL_CTX_get_verify_mode' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_verify(ctx, SSL_CTX_get_verify_mode(ctx), NULL);
                            ^
/usr/include/openssl/ssl.h:1471:5: note: 'SSL_CTX_get_verify_mode' has been
      explicitly marked deprecated here
int SSL_CTX_get_verify_mode(const SSL_CTX *ctx) DEPRECATED_IN_MAC_OS_X_V...
    ^
src/context.c:701:5: warning: 'SSL_CTX_set_cert_verify_callback' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_cert_verify_callback(ctx, NULL, NULL);
    ^
/usr/include/openssl/ssl.h:1477:6: note: 'SSL_CTX_set_cert_verify_callback' has
      been explicitly marked deprecated here
void SSL_CTX_set_cert_verify_callback(SSL_CTX *ctx, int (*cb)(X509_STORE...
     ^
src/context.c:710:3: warning: 'X509_STORE_set_flags' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  X509_STORE_set_flags(SSL_CTX_get_cert_store(ctx), crl_flag);
  ^
/usr/include/openssl/x509_vfy.h:392:5: note: 'X509_STORE_set_flags' has been
      explicitly marked deprecated here
int X509_STORE_set_flags(X509_STORE *ctx, unsigned long flags) DEPRECATE...
    ^
src/context.c:710:24: warning: 'SSL_CTX_get_cert_store' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  X509_STORE_set_flags(SSL_CTX_get_cert_store(ctx), crl_flag);
                       ^
/usr/include/openssl/ssl.h:1366:13: note: 'SSL_CTX_get_cert_store' has been
      explicitly marked deprecated here
X509_STORE *SSL_CTX_get_cert_store(const SSL_CTX *) DEPRECATED_IN_MAC_OS...
            ^
62 warnings generated.
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/ssl.c -o src/ssl.o -I/usr/include -Isrc/ -Isrc/luasocket
src/ssl.c:62:32: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    case SSL_ERROR_SSL: return ERR_reason_error_string(ERR_get_error());
                               ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/ssl.c:62:56: warning: 'ERR_get_error' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
    case SSL_ERROR_SSL: return ERR_reason_error_string(ERR_get_error());
                                                       ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/ssl.c:77:5: warning: 'SSL_shutdown' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    SSL_shutdown(ssl->ssl);
    ^
/usr/include/openssl/ssl.h:1548:5: note: 'SSL_shutdown' has been explicitly
      marked deprecated here
int SSL_shutdown(SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:94:5: warning: 'SSL_free' is deprecated: first deprecated in OS X 10.7
      [-Wdeprecated-declarations]
    SSL_free(ssl->ssl);
    ^
/usr/include/openssl/ssl.h:1506:6: note: 'SSL_free' has been explicitly marked
      deprecated here
void    SSL_free(SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/ssl.c:110:5: warning: 'ERR_clear_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    ERR_clear_error();
    ^
/usr/include/openssl/err.h:278:6: note: 'ERR_clear_error' has been explicitly
      marked deprecated here
void ERR_clear_error(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/ssl.c:111:11: warning: 'SSL_do_handshake' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    err = SSL_do_handshake(ssl->ssl);
          ^
/usr/include/openssl/ssl.h:1545:5: note: 'SSL_do_handshake' has been explicitly
      marked deprecated here
int SSL_do_handshake(SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:112:18: warning: 'SSL_get_error' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
    ssl->error = SSL_get_error(ssl->ssl, err);
                 ^
/usr/include/openssl/ssl.h:1517:5: note: 'SSL_get_error' has been explicitly
      marked deprecated here
int     SSL_get_error(const SSL *s,int ret_code) DEPRECATED_IN_MAC_OS_X_...
        ^
src/ssl.c:128:11: warning: 'ERR_peek_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      if (ERR_peek_error())  {
          ^
/usr/include/openssl/err.h:270:15: note: 'ERR_peek_error' has been explicitly
      marked deprecated here
unsigned long ERR_peek_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
              ^
src/ssl.c:154:5: warning: 'ERR_clear_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    ERR_clear_error();
    ^
/usr/include/openssl/err.h:278:6: note: 'ERR_clear_error' has been explicitly
      marked deprecated here
void ERR_clear_error(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/ssl.c:155:11: warning: 'SSL_write' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    err = SSL_write(ssl->ssl, data, (int)count);
          ^
/usr/include/openssl/ssl.h:1511:6: note: 'SSL_write' has been explicitly marked
      deprecated here
int     SSL_write(SSL *ssl,const void *buf,int num) DEPRECATED_IN_MAC_OS...
        ^
src/ssl.c:156:18: warning: 'SSL_get_error' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
    ssl->error = SSL_get_error(ssl->ssl, err);
                 ^
/usr/include/openssl/ssl.h:1517:5: note: 'SSL_get_error' has been explicitly
      marked deprecated here
int     SSL_get_error(const SSL *s,int ret_code) DEPRECATED_IN_MAC_OS_X_...
        ^
src/ssl.c:172:11: warning: 'ERR_peek_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      if (ERR_peek_error())  {
          ^
/usr/include/openssl/err.h:270:15: note: 'ERR_peek_error' has been explicitly
      marked deprecated here
unsigned long ERR_peek_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
              ^
src/ssl.c:198:5: warning: 'ERR_clear_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    ERR_clear_error();
    ^
/usr/include/openssl/err.h:278:6: note: 'ERR_clear_error' has been explicitly
      marked deprecated here
void ERR_clear_error(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/ssl.c:199:11: warning: 'SSL_read' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    err = SSL_read(ssl->ssl, data, (int)count);
          ^
/usr/include/openssl/ssl.h:1509:6: note: 'SSL_read' has been explicitly marked
      deprecated here
int     SSL_read(SSL *ssl,void *buf,int num) DEPRECATED_IN_MAC_OS_X_VERS...
        ^
src/ssl.c:200:18: warning: 'SSL_get_error' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
    ssl->error = SSL_get_error(ssl->ssl, err);
                 ^
/usr/include/openssl/ssl.h:1517:5: note: 'SSL_get_error' has been explicitly
      marked deprecated here
int     SSL_get_error(const SSL *s,int ret_code) DEPRECATED_IN_MAC_OS_X_...
        ^
src/ssl.c:219:11: warning: 'ERR_peek_error' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
      if (ERR_peek_error())  {
          ^
/usr/include/openssl/err.h:270:15: note: 'ERR_peek_error' has been explicitly
      marked deprecated here
unsigned long ERR_peek_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
              ^
src/ssl.c:253:14: warning: 'SSL_new' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  ssl->ssl = SSL_new(ctx);
             ^
/usr/include/openssl/ssl.h:1497:7: note: 'SSL_new' has been explicitly marked
      deprecated here
SSL *   SSL_new(SSL_CTX *ctx) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/ssl.c:257:7: warning: 'ERR_reason_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
      ^
/usr/include/openssl/err.h:283:13: note: 'ERR_reason_error_string' has been
      explicitly marked deprecated here
const char *ERR_reason_error_string(unsigned long e) DEPRECATED_IN_MAC_O...
            ^
src/ssl.c:257:31: warning: 'ERR_get_error' is deprecated: first deprecated in OS
      X 10.7 [-Wdeprecated-declarations]
      ERR_reason_error_string(ERR_get_error()));
                              ^
/usr/include/openssl/err.h:266:15: note: 'ERR_get_error' has been explicitly
      marked deprecated here
unsigned long ERR_get_error(void) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
              ^
src/ssl.c:261:3: warning: 'SSL_set_fd' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  SSL_set_fd(ssl->ssl, (int)SOCKET_INVALID);
  ^
/usr/include/openssl/ssl.h:1386:5: note: 'SSL_set_fd' has been explicitly marked
      deprecated here
int     SSL_set_fd(SSL *s, int fd) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
        ^
src/ssl.c:262:3: warning: 'SSL_ctrl' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  SSL_set_mode(ssl->ssl, SSL_MODE_ENABLE_PARTIAL_WRITE | 
  ^
/usr/include/openssl/ssl.h:603:2: note: expanded from macro 'SSL_set_mode'
        SSL_ctrl((ssl),SSL_CTRL_MODE,(op),NULL)
        ^
/usr/include/openssl/ssl.h:1512:6: note: 'SSL_ctrl' has been explicitly marked
      deprecated here
long    SSL_ctrl(SSL *ssl,int cmd, long larg, void *parg) DEPRECATED_IN_...
        ^
src/ssl.c:268:5: warning: 'SSL_set_accept_state' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
    SSL_set_accept_state(ssl->ssl);
    ^
/usr/include/openssl/ssl.h:1565:6: note: 'SSL_set_accept_state' has been
      explicitly marked deprecated here
void SSL_set_accept_state(SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
     ^
src/ssl.c:270:5: warning: 'SSL_set_connect_state' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_set_connect_state(ssl->ssl);
    ^
/usr/include/openssl/ssl.h:1564:6: note: 'SSL_set_connect_state' has been
      explicitly marked deprecated here
void SSL_set_connect_state(SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
     ^
src/ssl.c:335:3: warning: 'SSL_set_fd' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  SSL_set_fd(ssl->ssl, (int)ssl->sock);
  ^
/usr/include/openssl/ssl.h:1386:5: note: 'SSL_set_fd' has been explicitly marked
      deprecated here
int     SSL_set_fd(SSL *s, int fd) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
        ^
src/ssl.c:381:41: warning: 'SSL_pending' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    res = !buffer_isempty(&ssl->buf) || SSL_pending(ssl->ssl);
                                        ^
/usr/include/openssl/ssl.h:1384:5: note: 'SSL_pending' has been explicitly
      marked deprecated here
int     SSL_pending(const SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
        ^
src/ssl.c:394:16: warning: 'SSL_want' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
             : SSL_want(ssl->ssl);
               ^
/usr/include/openssl/ssl.h:1368:5: note: 'SSL_want' has been explicitly marked
      deprecated here
int SSL_want(const SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:419:10: warning: 'SSL_get_current_compression' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  comp = SSL_get_current_compression(ssl->ssl);
         ^
/usr/include/openssl/ssl.h:1671:20: note: 'SSL_get_current_compression' has been
      explicitly marked deprecated here
const COMP_METHOD *SSL_get_current_compression(SSL *s) DEPRECATED_IN_MAC...
                   ^
src/ssl.c:421:23: warning: 'SSL_COMP_get_name' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
    lua_pushstring(L, SSL_COMP_get_name(comp));
                      ^
/usr/include/openssl/ssl.h:1673:13: note: 'SSL_COMP_get_name' has been
      explicitly marked deprecated here
const char *SSL_COMP_get_name(const COMP_METHOD *comp) DEPRECATED_IN_MAC...
            ^
src/ssl.c:454:12: warning: 'SSL_get_peer_certificate' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    cert = SSL_get_peer_certificate(ssl->ssl);
           ^
/usr/include/openssl/ssl.h:1466:8: note: 'SSL_get_peer_certificate' has been
      explicitly marked deprecated here
X509 *  SSL_get_peer_certificate(const SSL *s) DEPRECATED_IN_MAC_OS_X_VE...
        ^
src/ssl.c:466:11: warning: 'SSL_get_peer_cert_chain' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  certs = SSL_get_peer_cert_chain(ssl->ssl);
          ^
/usr/include/openssl/ssl.h:1469:17: note: 'SSL_get_peer_cert_chain' has been
      explicitly marked deprecated here
STACK_OF(X509) *SSL_get_peer_cert_chain(const SSL *s) DEPRECATED_IN_MAC_...
                ^
src/ssl.c:467:12: warning: 'sk_num' is deprecated: first deprecated in OS X 10.7
      [-Wdeprecated-declarations]
  if (n >= sk_X509_num(certs)) {
           ^
/usr/include/openssl/safestack.h:1388:25: note: expanded from macro
      'sk_X509_num'
#define sk_X509_num(st) SKM_sk_num(X509, (st))
                        ^
/usr/include/openssl/safestack.h:168:2: note: expanded from macro 'SKM_sk_num'
        sk_num(st)
        ^
/usr/include/openssl/stack.h:81:5: note: 'sk_num' has been explicitly marked
      deprecated here
int sk_num(const STACK *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:471:10: warning: 'sk_value' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
  cert = sk_X509_value(certs, n);
         ^
/usr/include/openssl/safestack.h:1389:30: note: expanded from macro
      'sk_X509_value'
#define sk_X509_value(st, i) SKM_sk_value(X509, (st), (i))
                             ^
/usr/include/openssl/safestack.h:170:11: note: expanded from macro
      'SKM_sk_value'
        ((type *)sk_value(st, i))
                 ^
/usr/include/openssl/stack.h:82:7: note: 'sk_value' has been explicitly marked
      deprecated here
char *sk_value(const STACK *, int) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
      ^
src/ssl.c:474:3: warning: 'CRYPTO_add_lock' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  CRYPTO_add(&cert->references, 1, CRYPTO_LOCK_X509);
  ^
/usr/include/openssl/crypto.h:248:2: note: expanded from macro 'CRYPTO_add'
        CRYPTO_add_lock(addr,amount,type,__FILE__,__LINE__)
        ^
/usr/include/openssl/crypto.h:429:5: note: 'CRYPTO_add_lock' has been explicitly
      marked deprecated here
int CRYPTO_add_lock(int *pointer,int amount,int type, const char *file,
    ^
src/ssl.c:497:22: warning: 'SSL_get_peer_certificate' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    lsec_pushx509(L, SSL_get_peer_certificate(ssl->ssl));
                     ^
/usr/include/openssl/ssl.h:1466:8: note: 'SSL_get_peer_certificate' has been
      explicitly marked deprecated here
X509 *  SSL_get_peer_certificate(const SSL *s) DEPRECATED_IN_MAC_OS_X_VE...
        ^
src/ssl.c:500:11: warning: 'SSL_get_peer_cert_chain' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  certs = SSL_get_peer_cert_chain(ssl->ssl);
          ^
/usr/include/openssl/ssl.h:1469:17: note: 'SSL_get_peer_cert_chain' has been
      explicitly marked deprecated here
STACK_OF(X509) *SSL_get_peer_cert_chain(const SSL *s) DEPRECATED_IN_MAC_...
                ^
src/ssl.c:501:13: warning: 'sk_num' is deprecated: first deprecated in OS X 10.7
      [-Wdeprecated-declarations]
  n_certs = sk_X509_num(certs);
            ^
/usr/include/openssl/safestack.h:1388:25: note: expanded from macro
      'sk_X509_num'
#define sk_X509_num(st) SKM_sk_num(X509, (st))
                        ^
/usr/include/openssl/safestack.h:168:2: note: expanded from macro 'SKM_sk_num'
        sk_num(st)
        ^
/usr/include/openssl/stack.h:81:5: note: 'sk_num' has been explicitly marked
      deprecated here
int sk_num(const STACK *) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:503:12: warning: 'sk_value' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    cert = sk_X509_value(certs, i);
           ^
/usr/include/openssl/safestack.h:1389:30: note: expanded from macro
      'sk_X509_value'
#define sk_X509_value(st, i) SKM_sk_value(X509, (st), (i))
                             ^
/usr/include/openssl/safestack.h:170:11: note: expanded from macro
      'SKM_sk_value'
        ((type *)sk_value(st, i))
                 ^
/usr/include/openssl/stack.h:82:7: note: 'sk_value' has been explicitly marked
      deprecated here
char *sk_value(const STACK *, int) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_A...
      ^
src/ssl.c:506:5: warning: 'CRYPTO_add_lock' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    CRYPTO_add(&cert->references, 1, CRYPTO_LOCK_X509);
    ^
/usr/include/openssl/crypto.h:248:2: note: expanded from macro 'CRYPTO_add'
        CRYPTO_add_lock(addr,amount,type,__FILE__,__LINE__)
        ^
/usr/include/openssl/crypto.h:429:5: note: 'CRYPTO_add_lock' has been explicitly
      marked deprecated here
int CRYPTO_add_lock(int *pointer,int amount,int type, const char *file,
    ^
src/ssl.c:546:9: warning: 'SSL_get_verify_result' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  err = SSL_get_verify_result(ssl->ssl);
        ^
/usr/include/openssl/ssl.h:1600:6: note: 'SSL_get_verify_result' has been
      explicitly marked deprecated here
long SSL_get_verify_result(const SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSIO...
     ^
src/ssl.c:555:23: warning: 'X509_verify_cert_error_string' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    lua_pushstring(L, X509_verify_cert_error_string(err));
                      ^
/usr/include/openssl/x509.h:752:13: note: 'X509_verify_cert_error_string' has
      been explicitly marked deprecated here
const char *X509_verify_cert_error_string(long n) DEPRECATED_IN_MAC_OS_X...
            ^
src/ssl.c:579:14: warning: 'SSL_get_finished' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if ((len = SSL_get_finished(ssl->ssl, NULL, 0)) == 0)
             ^
/usr/include/openssl/ssl.h:1142:8: note: 'SSL_get_finished' has been explicitly
      marked deprecated here
size_t SSL_get_finished(const SSL *s, void *buf, size_t count) DEPRECATE...
       ^
src/ssl.c:587:3: warning: 'SSL_get_finished' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  SSL_get_finished(ssl->ssl, buffer, len);
  ^
/usr/include/openssl/ssl.h:1142:8: note: 'SSL_get_finished' has been explicitly
      marked deprecated here
size_t SSL_get_finished(const SSL *s, void *buf, size_t count) DEPRECATE...
       ^
src/ssl.c:606:14: warning: 'SSL_get_peer_finished' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  if ((len = SSL_get_peer_finished(ssl->ssl, NULL, 0)) == 0)
             ^
/usr/include/openssl/ssl.h:1143:8: note: 'SSL_get_peer_finished' has been
      explicitly marked deprecated here
size_t SSL_get_peer_finished(const SSL *s, void *buf, size_t count) DEPR...
       ^
src/ssl.c:614:3: warning: 'SSL_get_peer_finished' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_get_peer_finished(ssl->ssl, buffer, len);
  ^
/usr/include/openssl/ssl.h:1143:8: note: 'SSL_get_peer_finished' has been
      explicitly marked deprecated here
size_t SSL_get_peer_finished(const SSL *s, void *buf, size_t count) DEPR...
       ^
src/ssl.c:655:12: warning: 'SSL_get_current_cipher' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  cipher = SSL_get_current_cipher(ssl->ssl);
           ^
/usr/include/openssl/ssl.h:1373:13: note: 'SSL_get_current_cipher' has been
      explicitly marked deprecated here
SSL_CIPHER *SSL_get_current_cipher(const SSL *s) DEPRECATED_IN_MAC_OS_X_...
            ^
src/ssl.c:658:3: warning: 'SSL_CIPHER_description' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_CIPHER_description(cipher, buf, sizeof(buf));
  ^
/usr/include/openssl/ssl.h:1571:7: note: 'SSL_CIPHER_description' has been
      explicitly marked deprecated here
char *SSL_CIPHER_description(const SSL_CIPHER *,char *buf,int size) DEPR...
      ^
src/ssl.c:659:10: warning: 'SSL_CIPHER_get_bits' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  bits = SSL_CIPHER_get_bits(cipher, &algbits);
         ^
/usr/include/openssl/ssl.h:1374:5: note: 'SSL_CIPHER_get_bits' has been
      explicitly marked deprecated here
int     SSL_CIPHER_get_bits(const SSL_CIPHER *c,int *alg_bits) DEPRECATE...
        ^
src/ssl.c:663:21: warning: 'SSL_get_version' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  lua_pushstring(L, SSL_get_version(ssl->ssl));
                    ^
/usr/include/openssl/ssl.h:1518:13: note: 'SSL_get_version' has been explicitly
      marked deprecated here
const char *SSL_get_version(const SSL *s) DEPRECATED_IN_MAC_OS_X_VERSION...
            ^
src/ssl.c:671:18: warning: 'SSL_get_SSL_CTX' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX *ctx = SSL_get_SSL_CTX(ssl);
                 ^
/usr/include/openssl/ssl.h:1592:10: note: 'SSL_get_SSL_CTX' has been explicitly
      marked deprecated here
SSL_CTX *SSL_get_SSL_CTX(const SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSION_...
         ^
src/ssl.c:672:30: warning: 'SSL_CTX_get_ex_data' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  lua_State *L = ((p_context)SSL_CTX_get_app_data(ctx))->L;
                             ^
/usr/include/openssl/ssl.h:1092:36: note: expanded from macro
      'SSL_CTX_get_app_data'
#define SSL_CTX_get_app_data(ctx)       (SSL_CTX_get_ex_data(ctx,0))
                                         ^
/usr/include/openssl/ssl.h:1613:7: note: 'SSL_CTX_get_ex_data' has been
      explicitly marked deprecated here
void *SSL_CTX_get_ex_data(const SSL_CTX *ssl,int idx) DEPRECATED_IN_MAC_...
      ^
src/ssl.c:673:22: warning: 'SSL_get_servername' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  const char *name = SSL_get_servername(ssl, TLSEXT_NAMETYPE_host_name);
                     ^
/usr/include/openssl/tls1.h:154:13: note: 'SSL_get_servername' has been
      explicitly marked deprecated here
const char *SSL_get_servername(const SSL *s, const int type) DEPRECATED_...
            ^
src/ssl.c:696:5: warning: 'SSL_set_SSL_CTX' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
    SSL_set_SSL_CTX(ssl, newctx);
    ^
/usr/include/openssl/ssl.h:1593:10: note: 'SSL_set_SSL_CTX' has been explicitly
      marked deprecated here
SSL_CTX *SSL_set_SSL_CTX(SSL *ssl, SSL_CTX* ctx) DEPRECATED_IN_MAC_OS_X_...
         ^
src/ssl.c:711:18: warning: 'SSL_get_SSL_CTX' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  SSL_CTX *ctx = SSL_get_SSL_CTX(ssl->ssl);
                 ^
/usr/include/openssl/ssl.h:1592:10: note: 'SSL_get_SSL_CTX' has been explicitly
      marked deprecated here
SSL_CTX *SSL_get_SSL_CTX(const SSL *ssl) DEPRECATED_IN_MAC_OS_X_VERSION_...
         ^
src/ssl.c:712:31: warning: 'SSL_CTX_get_ex_data' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  p_context pctx = (p_context)SSL_CTX_get_app_data(ctx);
                              ^
/usr/include/openssl/ssl.h:1092:36: note: expanded from macro
      'SSL_CTX_get_app_data'
#define SSL_CTX_get_app_data(ctx)       (SSL_CTX_get_ex_data(ctx,0))
                                         ^
/usr/include/openssl/ssl.h:1613:7: note: 'SSL_CTX_get_ex_data' has been
      explicitly marked deprecated here
void *SSL_CTX_get_ex_data(const SSL_CTX *ssl,int idx) DEPRECATED_IN_MAC_...
      ^
src/ssl.c:715:5: warning: 'SSL_ctrl' is deprecated: first deprecated in OS X
      10.7 [-Wdeprecated-declarations]
    SSL_set_tlsext_host_name(ssl->ssl, name);
    ^
/usr/include/openssl/tls1.h:157:42: note: expanded from macro
      'SSL_set_tlsext_host_name'
#define SSL_set_tlsext_host_name(s,name) \
                                         ^
/usr/include/openssl/ssl.h:1512:6: note: 'SSL_ctrl' has been explicitly marked
      deprecated here
long    SSL_ctrl(SSL *ssl,int cmd, long larg, void *parg) DEPRECATED_IN_...
        ^
src/ssl.c:726:7: warning: 'SSL_CTX_callback_ctrl' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
      SSL_CTX_set_tlsext_servername_callback(aux, sni_cb);
      ^
/usr/include/openssl/tls1.h:187:57: note: expanded from macro
      'SSL_CTX_set_tlsext_servername_callback'
#define SSL_CTX_set_tlsext_servername_callback(ctx, cb) \
                                                        ^
/usr/include/openssl/ssl.h:1515:6: note: 'SSL_CTX_callback_ctrl' has been
      explicitly marked deprecated here
long    SSL_CTX_callback_ctrl(SSL_CTX *, int, void (*)(void)) DEPRECATED...
        ^
src/ssl.c:742:5: warning: 'SSL_CTX_callback_ctrl' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
    SSL_CTX_set_tlsext_servername_callback(ctx, sni_cb);
    ^
/usr/include/openssl/tls1.h:187:57: note: expanded from macro
      'SSL_CTX_set_tlsext_servername_callback'
#define SSL_CTX_set_tlsext_servername_callback(ctx, cb) \
                                                        ^
/usr/include/openssl/ssl.h:1515:6: note: 'SSL_CTX_callback_ctrl' has been
      explicitly marked deprecated here
long    SSL_CTX_callback_ctrl(SSL_CTX *, int, void (*)(void)) DEPRECATED...
        ^
src/ssl.c:750:22: warning: 'SSL_get_servername' is deprecated: first deprecated
      in OS X 10.7 [-Wdeprecated-declarations]
  const char *name = SSL_get_servername(ssl->ssl, TLSEXT_NAMETYPE_host_name);
                     ^
/usr/include/openssl/tls1.h:154:13: note: 'SSL_get_servername' has been
      explicitly marked deprecated here
const char *SSL_get_servername(const SSL *s, const int type) DEPRECATED_...
            ^
src/ssl.c:822:8: warning: 'SSL_library_init' is deprecated: first deprecated in
      OS X 10.7 [-Wdeprecated-declarations]
  if (!SSL_library_init()) {
       ^
/usr/include/openssl/ssl.h:1569:5: note: 'SSL_library_init' has been explicitly
      marked deprecated here
int SSL_library_init(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_7_AND_LATER;
    ^
src/ssl.c:826:3: warning: 'OPENSSL_add_all_algorithms_noconf' is deprecated:
      first deprecated in OS X 10.7 [-Wdeprecated-declarations]
  OpenSSL_add_all_algorithms();
  ^
/usr/include/openssl/evp.h:829:3: note: expanded from macro
      'OpenSSL_add_all_algorithms'
                OPENSSL_add_all_algorithms_noconf()
                ^
/usr/include/openssl/evp.h:821:6: note: 'OPENSSL_add_all_algorithms_noconf' has
      been explicitly marked deprecated here
void OPENSSL_add_all_algorithms_noconf(void) DEPRECATED_IN_MAC_OS_X_VERS...
     ^
src/ssl.c:827:3: warning: 'SSL_load_error_strings' is deprecated: first
      deprecated in OS X 10.7 [-Wdeprecated-declarations]
  SSL_load_error_strings();
  ^
/usr/include/openssl/ssl.h:1432:6: note: 'SSL_load_error_strings' has been
      explicitly marked deprecated here
void    SSL_load_error_strings(void ) DEPRECATED_IN_MAC_OS_X_VERSION_10_...
        ^
61 warnings generated.
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/luasocket/buffer.c -o src/luasocket/buffer.o -I/usr/include -Isrc/ -Isrc/luasocket
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/luasocket/io.c -o src/luasocket/io.o -I/usr/include -Isrc/ -Isrc/luasocket
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/luasocket/timeout.c -o src/luasocket/timeout.o -I/usr/include -Isrc/ -Isrc/luasocket
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/luasocket/usocket.c -o src/luasocket/usocket.o -I/usr/include -Isrc/ -Isrc/luasocket
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o ssl.so -L/usr/local/lib src/x509.o src/context.o src/ssl.o src/luasocket/buffer.o src/luasocket/io.o src/luasocket/timeout.o src/luasocket/usocket.o -L/usr/lib -Wl,-rpath,/usr/lib: -lssl -lcrypto
Updating manifest for /usr/local/lib/luarocks/rocks
luasec 0.6-1 is now built and installed in /usr/local (license: MIT)

172-15-2-13:lua-5.1.4 mac$ sudo luarocks install luasql-sqlite3
Installing https://luarocks.org/luasql-sqlite3-2.3.0-1.src.rock...
Using https://luarocks.org/luasql-sqlite3-2.3.0-1.src.rock... switching to 'build' mode
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/luasql.c -o src/luasql.o -I/usr/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -O2 -fPIC -I/usr/local/include -c src/ls_sqlite3.c -o src/ls_sqlite3.o -I/usr/include
env MACOSX_DEPLOYMENT_TARGET=10.8 gcc -bundle -undefined dynamic_lookup -all_load -o luasql/sqlite3.so -L/usr/local/lib src/luasql.o src/ls_sqlite3.o -L/usr/lib -Wl,-rpath,/usr/lib: -lsqlite3
Updating manifest for /usr/local/lib/luarocks/rocks
luasql-sqlite3 2.3.0-1 is now built and installed in /usr/local (license: MIT/X11)

172-15-2-13:lua-5.1.4 mac$ 
